/*!
 * Copyright (c) 2022 Oracle and/or its affiliates.
 * All rights reserved. Oracle Digital Assistant Client Web SDK, Release: 21.12.0
 */
var e,factory;e=self,factory=function(){return function(){var e={6432:function(e,t,n){(t=n(3645)(!1)).push([e.id,".wrapper {\n    box-sizing: border-box;\n    height: 0;\n    position: fixed;\n    text-transform: none;\n    transition: all 0.25s ease-in-out;\n    width: 0;\n    z-index: 10000;\n}\n\n.button {\n    background-position: center center;\n    background-repeat: no-repeat;\n    border: none;\n    bottom: 0;\n    cursor: pointer;\n    overflow: visible;\n    padding: 0;\n    position: absolute;\n    right: 0;\n    text-align: center;\n    touch-action: none;\n    transition: height 0.25s ease-out, width 0.25s ease-out;\n    z-index: 10000;\n}\n\n.button-drag-handle {\n    height: 100%;\n    left: 0;\n    position: absolute;\n    top: 0;\n    width: 100%;\n}\n\n[dir=rtl] .button {\n    left: 0;\n    right: unset;\n}\n\n.button:focus {\n    outline: thin solid #fff;\n}\n\n.expanded:not(.drag) .button {\n    -webkit-animation: scale-out-center 0.25s cubic-bezier(0.550, 0.085, 0.680, 0.530) forwards;\n            animation: scale-out-center 0.25s cubic-bezier(0.550, 0.085, 0.680, 0.530) forwards;\n}\n\n.collapsed:not(.drag) .button {\n    -webkit-animation: scale-in-center 0.25s cubic-bezier(0.250, 0.460, 0.450, 0.940) 0.2s both;\n            animation: scale-in-center 0.25s cubic-bezier(0.250, 0.460, 0.450, 0.940) 0.2s both;\n    display: flex;\n}\n\n.button img {\n    display: block;\n    height: 100%;\n    max-height: 100%;\n    max-width: 100%;\n    width: 100%;\n}\n\n.notification-badge {\n    align-items: center;\n    background: #e6081a;\n    border-radius: 24px;\n    color: #fff;\n    display: flex;\n    font-size: 14px;\n    height: 24px;\n    justify-content: center;\n    position: absolute;\n    text-align: center;\n    width: 32px;\n}\n\n.widget {\n    background: #fff;\n    display: flex;\n    flex-direction: column;\n    margin: 0;\n    overflow: hidden;\n    position: absolute;\n    text-decoration: none;\n    text-transform: none;\n    z-index: 10000;\n}\n\n.expanded .widget {\n    -webkit-animation: scale-in-br 0.25s cubic-bezier(0.250, 0.460, 0.450, 0.940) 0.2s both;\n            animation: scale-in-br 0.25s cubic-bezier(0.250, 0.460, 0.450, 0.940) 0.2s both;\n}\n\n[dir=rtl] .expanded .widget {\n    -webkit-animation: scale-in-bl 0.25s cubic-bezier(0.250, 0.460, 0.450, 0.940) 0.2s both;\n            animation: scale-in-bl 0.25s cubic-bezier(0.250, 0.460, 0.450, 0.940) 0.2s both;\n}\n\n.collapsed .widget {\n    -webkit-animation: scale-out-br 0.25s cubic-bezier(0.550, 0.085, 0.680, 0.530) forwards;\n\t        animation: scale-out-br 0.25s cubic-bezier(0.550, 0.085, 0.680, 0.530) forwards;\n}\n\n[dir=rtl] .collapsed .widget {\n    -webkit-animation: scale-out-bl 0.25s cubic-bezier(0.550, 0.085, 0.680, 0.530) forwards;\n\t        animation: scale-out-bl 0.25s cubic-bezier(0.550, 0.085, 0.680, 0.530) forwards;\n}\n\n.none {\n    display: none;\n}\n\n.conversation-pane {\n    display: flex;\n    flex: 1 1 auto;\n    flex-direction: column;\n}\n\n.conversation-container {\n    padding: 10px 12px 0;\n}\n\n.empty-conversation-div {\n    display: flex;\n    flex: auto;\n}\n\n.message-date {\n    font-size: 12px;\n    margin: 4px 4px 0;\n}\n\n.message-date.has-icon-left,\n[dir=rtl] .message-date.has-icon-right {\n    margin-left: 40px;\n}\n\n.message-date.has-icon-right,\n[dir=rtl] .message-date.has-icon-left {\n    margin-right: 40px;\n}\n\n.embed-sticky-top, .embed-sticky-bottom {\n    padding-top: 5px;\n    padding-bottom: 5px;\n}\n\n.embed-scroll-top {\n    padding-top: 5px;\n    padding-bottom: 10px;\n}\n\n.embed-scroll-bottom {\n    padding-top: 10px;\n    padding-bottom: 5px;\n}\n\n.wrapper {\n    bottom: 20px;\n    right: 10px;\n}\n\n[dir=rtl] .wrapper {\n    left: 10px;\n    right: unset;\n}\n\n.button {\n    height: 48px;\n    width: 48px;\n}\n\n.button-icon {\n    height: 100%;\n    max-height: 48px;\n    max-width: 48px;\n    width: 100%;\n}\n\n.widget {\n    bottom: -20px;\n    height: 85vh;\n    max-height: calc(100vh - 60px);\n    max-width: 100vw;\n    right: -10px;\n    width: 100vw;\n    transition: all 0.25s ease-in-out;\n}\n\n[dir=rtl] .widget {\n    left: -10px;\n    right: unset;\n}\n\n.timestamp-header {\n    align-items: center;\n    display: flex;\n    font-size: 13.75px;\n    font-weight: 600;\n    justify-content: center;\n    padding: 8px;\n    margin: 8px;\n    text-transform: uppercase;\n}\n\n.relative-timestamp {\n    font-size: 12px;\n    margin: -16px auto 24px;\n}\n\n.relative-timestamp.left {\n    align-items: stretch;\n}\n\n.relative-timestamp.right {\n    align-items: flex-end;\n}\n\n.prompt-banner {\n    align-items: center;\n    background-color: #fff8e4;\n    box-shadow: 0 0 4px rgba(0, 0, 0, 0.2), 0 1px 2px rgba(0, 0, 0, 0.2);\n    border-radius: 4px;\n    display: flex;\n    flex-direction: row;\n    margin: 8px;\n    max-width: 100%;\n    min-height: 48px;\n    padding: 8px 16px;\n    position: absolute;\n    width: calc(100% - 16px);\n    z-index: 5;\n    animation: banner-in .2s cubic-bezier(.22,.45,.42,.92) both;\n}\n\n.prompt-banner.dialog {\n    background-color: #fff;\n    flex-direction: column;\n    align-items: flex-start;\n    top: 30%;\n    max-height: 60%;\n    overflow-y: scroll;\n}\n\n.prompt-banner-out {\n    animation: banner-out .2s cubic-bezier(.5,.07,.68,.48) both\n}\n\n[dir=rtl] .prompt-banner {\n    flex-direction: row-reverse;\n}\n\n.prompt-banner-text {\n    color: #161513;\n    flex: 1 1 auto;\n    font-size: 13.75px;\n    margin: 0 8px;\n    overflow-wrap: break-word;\n    word-break: break-word;\n}\n\n.dialog-wrapper {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    width: 100%;\n    height: 100%;\n}\n\n.prompt-banner-background {\n    position: fixed;\n    background: rgb(0 0 0 / 20%);\n    height: 100%;\n    width: 100%;\n    z-index: 1;\n}\n\n.prompt-banner.dialog .prompt-banner-text {\n    margin: 16px 0 0;\n    font-size: 18px;\n    font-weight: bold;\n}\n\n.prompt-banner.dialog .prompt-banner-description {\n    color: #727272;\n    font-size: 13px;\n    margin-top: 8px;\n}\n\n.prompt-banner.dialog .action-wrapper {\n    display: flex;\n    justify-content: space-between;\n    width: 100%;\n    margin: 32px 0 6px;\n}\n\n.prompt-banner.dialog .action-postback {\n    background-color: #fff;\n    border-style: solid;\n    margin-right: 8px;\n}\n\n.prompt-banner.dialog .action-postback.filled {\n    color: #fff;\n}\n\n.prompt-banner.dialog .action-postback:hover {\n    filter: brightness(0.9);\n}\n\n.prompt-banner.dialog .action-postback.filled:hover {\n    filter: brightness(1.2);\n}\n\n.prompt-banner.dialog .action-postback:last-child {\n    margin: 0;\n}\n\n.prompt-banner-icon, .prompt-banner-close-button {\n    filter: opacity(0.75);\n    flex: 0 0 auto;\n}\n\n.prompt-banner-close-button {\n    background: none;\n    border: none;\n    cursor: pointer;\n}\n\n.prompt-banner-close-button:hover {\n    filter: opacity(0.6);\n}\n\n.prompt-banner-close-button:focus, .prompt-banner-close-button:active {\n    filter: opacity(1);\n}\n\n.relative-timestamp.left.has-message-icon,\n[dir=rtl] .relative-timestamp.right.has-message-icon {\n    margin-left: 40px;\n}\n\n.relative-timestamp.right.has-message-icon,\n[dir=rtl] .relative-timestamp.left.has-message-icon {\n    margin-right: 40px;\n}\n\n@media screen and (min-width: 426px) {\n    .widget {\n        bottom: 0;\n        height: 85vh;\n        max-height: calc(100vh - 20px - 60px);\n        max-width: calc(100vw - 10px - 10px);\n        min-width: 300px;\n        right: 0;\n        width: 300px;\n    }\n\n    [dir=rtl] .widget {\n        left: 0;\n        right: unset;\n    }\n}\n\n@media screen and (min-width: 769px) {\n    .wrapper {\n        bottom: 20px;\n        right: 20px;\n    }\n\n    [dir=rtl] .wrapper {\n        left: 20px;\n        right: unset;\n    }\n\n    .button {\n        height: 64px;\n        width: 64px;\n    }\n\n    .button-icon {\n        max-height: 64px;\n        max-width: 64px;\n    }\n\n    .widget {\n        height: 70vh;\n        max-height: calc(100vh - 20px - 60px);\n        max-width: 512px;\n        width: 30vw;\n    }\n}\n\n@keyframes scale-in-center{0%{opacity:1;transform:scale(0)}100%{opacity:1;transform:scale(1)}}\n\n@keyframes scale-out-center{0%{display:flex;opacity:1;transform:scale(1)}100%{display:none;opacity:1;transform:scale(0)}}\n\n@keyframes scale-in-br{0%{opacity:1;transform:scale(0);transform-origin:100% 100%}100%{opacity:1;transform:scale(1);transform-origin:100% 100%}}\n\n@keyframes scale-in-bl {0% {opacity: 1;transform: scale(0);transform-origin: 0% 100%}100% {opacity: 1;transform: scale(1);transform-origin: 0% 100%}}\n\n@keyframes scale-out-br{0%{opacity:1;transform:scale(1);transform-origin:100% 100%}99%{opacity:1;transform:scale(.01);transform-origin:100% 100%}100%{display:none;opacity:1;transform:scale(0);transform-origin:100% 100%}}\n\n@keyframes scale-out-bl{0%{opacity: 1;transform:scale(1);transform-origin:0 100%}99%{opacity:1;transform:scale(.01);transform-origin:0 100%}100%{opacity:1;transform:scale(0);transform-origin:0 100%}}\n\n@keyframes banner-in{0%{transform:translateY(-20px);opacity:0}100%{transform:translateY(0);opacity:1}}\n\n@keyframes banner-out{0%{transform:translateY(0);opacity:1}100%{transform:translateY(-20px);opacity:0}}\n\n@media (prefers-reduced-motion: reduce) {\n    .button, .widget, .autocomplete-items, .status-message-wrapper, .share-popup-expand, .prompt-banner {\n        animation: none;\n    }\n\n    .conversation, .card-message-horizontal .card-message-cards {\n        scroll-behavior: auto;\n    }\n}\n",""]),e.exports=t},909:function(e,t,n){(t=n(3645)(!1)).push([e.id,".footer {\n    align-items: center;\n    background-color: #fff;\n    box-sizing: border-box;\n    display: flex;\n    flex-direction: row;\n    position: relative;\n    text-align: start;\n}\n\n.footer-mode-keyboard {\n    align-items: center;\n    flex: 1;\n    flex-direction: row;\n    justify-content: center;\n    max-height: 78px;\n    max-width: 100%;\n    padding: 8px 6px 8px 4px;\n}\n\n.footer-mode-voice {\n    display: flex;\n    flex: 1;\n    flex-direction: column;\n}\n\n.footer-visualizer-wrapper {\n    align-items: center;\n    display: flex;\n    flex-direction: row;\n    height: 48px;\n    justify-content: center;\n    padding: 8px;\n    width: 100%;\n}\n\n.footer-recognition-wrapper {\n    align-items: center;\n    box-sizing: border-box;\n    display: flex;\n    flex-direction: row;\n    height: 48px;\n    padding: 8px 6px 8px 8px;\n    width: 100%;\n}\n\n.footer-button {\n    -webkit-tap-highlight-color: transparent;\n    align-items: center;\n    background-color: transparent;\n    border: none;\n    cursor: pointer;\n    display: flex;\n    height: 32px;\n    justify-content: center;\n    max-height: 32px;\n    max-width: 32px;\n    overflow: hidden;\n    padding: 4px;\n    text-shadow: none;\n    width: 32px;\n}\n\n.footer-button:disabled {\n    cursor: default;\n    pointer-events: none;\n}\n\n.footer-button-icon {\n    background-position: center;\n    background-size: 100%;\n    height: 100%;\n    margin: auto;\n    padding: 0;\n    width: 100%;\n}\n\n.footer-button-svg-icon {\n    fill: #787570;\n    height: 24px;\n    width: 24px;\n}\n\n.footer-button:disabled .footer-button-svg-icon,\n.footer-button:disabled .footer-button-svg-icon:active,\n.footer-button:disabled .footer-button-svg-icon:hover {\n    fill: #bbb6b2;\n}\n\n.button-upload {\n    margin-left: 2px;\n}\n\n.button-speech-active {\n    animation: mic-toggle 400ms ease 0s infinite normal none running;\n}\n\n.footer.mode-keyboard .footer-mode-keyboard, .footer.mode-voice .footer-mode-voice {\n    display: flex;\n}\n\n.footer.mode-voice .footer-mode-keyboard, .footer.mode-keyboard .footer-mode-voice {\n    display: none;\n}\n\n@keyframes mic-toggle {\n    from {\n        fill: #ff8a80;\n    }\n    to {\n        fill: #d50000;\n    }\n}\n\n.user-input {\n    border: 1px solid #dadada;\n    border-radius: 16px;\n    box-sizing: border-box;\n    color: #333;\n    font-size: 16px;\n    flex: 1;\n    height: 32px;\n    line-height: 18px;\n    margin: 0 6px;\n    max-height: 61px;\n    min-height: 32px;\n    outline: none;\n    overflow: auto;\n    padding: 6px 14px;\n    resize: none;\n    text-align: start;\n}\n\n.user-input::placeholder {\n    color: #787570;\n}\n\n.user-input.disabled {\n    color: #737373;\n}\n\n.user-input.disabled::placeholder {\n    color: #bbb6b2;\n}\n\n.user-input.user-input-inline-send {\n    padding: 6px 40px 6px 14px;\n}\n\n.autocomplete-items {\n    -webkit-animation: popup-suggestion .15s cubic-bezier(0.250, 0.460, 0.450, 0.940) both;\n    animation: popup-suggestion .15s cubic-bezier(0.250, 0.460, 0.450, 0.940) both;\n    border: 1px solid #bababa;\n    border-radius: 6px 6px 0 0;\n    bottom: 100%;\n    left: 0;\n    margin: 0 auto;\n    width: 77%;\n    max-height: 240px;\n    overflow-y: auto;\n    position: absolute;\n    right: 0;\n    z-index: 1;\n}\n\n.autocomplete-items.no-attach {\n    margin-left: 10px;\n    width: 86%;\n}\n\n.autocomplete-items div {\n    background-color: #fff;\n    color: #161513;\n    cursor: pointer;\n    font-size: 16px;\n    min-height: 44px;\n    padding: 10px;\n    text-align: start;\n}\n\n.autocomplete-items strong {\n    font-weight: 700;\n}\n\n.autocomplete-items div:hover {\n    background-color: #e9e9e9;\n}\n\n.button-send-inline {\n    left: unset;\n    position: absolute;\n    right: 52px;\n}\n\n.recognition-text-view {\n    border: none;\n    flex: 1;\n    font-size: 16px;\n    margin: 0 8px;\n    pointer-events: none;\n}\n\n.share-popup {\n    background-color: #fcfbfa;\n    border: 1px solid #dadada;\n    border-radius: 4px;\n    bottom: 90%;\n    display: none;\n    left: 8px;\n    max-width: 200px;\n    max-height: calc(100vh - 128px);\n    position: absolute;\n    right: unset;\n    z-index: 2;\n}\n\n.share-popup::after {\n    border-left: 8px solid transparent;\n    border-right: 8px solid transparent;\n    border-top: 8px solid #fcfbfa;\n    content: '';\n    height: 0;\n    left: 8px;\n    position: absolute;\n    right: unset;\n    top: 100%;\n    width: 0;\n}\n\n.share-popup-expand {\n    -webkit-animation: scale-in-bl .25s cubic-bezier(0.250, 0.460, 0.450, 0.940) .2s both;\n    animation: scale-in-bl .25s cubic-bezier(0.250, 0.460, 0.450, 0.940) .2s both;\n    display: flex;\n}\n\n.share-popup-list {\n    display: flex;\n    flex-direction: column;\n    list-style: none;\n    margin: 0;\n    max-width: 100%;\n    overflow-y: auto;\n    padding: 0;\n    width: 100%;\n}\n\n.share-popup-item {\n    align-items: center;\n    background: transparent;\n    border-bottom: 1px solid #dadada;\n    color: #312d2a;\n    cursor: pointer;\n    display: flex;\n    flex: 1;\n    font-size: 13.75px;\n    font-weight: 700;\n    min-height: 44px;\n    padding: 10px 8px;\n    text-align: start;\n    width: 100%;\n}\n\n.share-popup-item:last-of-type {\n    border-bottom: none;\n}\n\n.share-popup-item:hover, .share-popup-item:focus {\n    color: #201e1c;\n    background-color: #f1efee;\n}\n\n.share-popup-item:active {\n    color: #161513;\n    background-color: #edebea;\n}\n\n.share-popup-item-icon {\n    fill: #312d2a;\n    flex: 1 0 auto;\n    height: 24px;\n    max-height: 24px;\n    max-width: 24px;\n    width: 24px;\n}\n\n.share-popup-item-text {\n    flex: 1 1 auto;\n    margin: 0 8px;\n    max-width: 100%;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n}\n\n.autocomplete-items .autocomplete-active, .autocomplete-items .autocomplete-active:hover {\n    background-color: #85bbe7;\n}\n\n\n[dir=rtl] .footer-mode-keyboard {\n    flex-direction: row-reverse;\n    padding: 8px 4px 8px 6px;\n}\n\n[dir=rtl] .footer-recognition-wrapper {\n    flex-direction: row-reverse;\n    padding: 8px 8px 8px 6px;\n}\n\n[dir=rtl] .button-upload {\n    margin-left: unset;\n    margin-right: 2px;\n}\n\n[dir=rtl] .user-input.user-input-inline-send {\n    padding: 6px 14px 6px 40px;\n}\n\n[dir=rtl] .user-input {\n    direction: rtl;\n}\n\n[dir=rtl] .button-send {\n    transform: scale(-1, 1);\n}\n\n[dir=rtl] .button-send-inline {\n    left: 52px;\n    right: unset;\n}\n\n[dir=rtl] .share-popup-expand {\n    -webkit-animation: scale-in-br .25s cubic-bezier(0.250, 0.460, 0.450, 0.940) .2s both;\n    animation: scale-in-br .25s cubic-bezier(0.250, 0.460, 0.450, 0.940) .2s both;\n}\n\n[dir=rtl] .footer, [dir=rtl] .footer-visualizer-wrapper, [dir=rtl] .share-popup-item {\n    flex-direction: row-reverse;\n}\n\n[dir=rtl] .share-popup, [dir=rtl] .share-popup::after {\n    left: unset;\n    right: 8px;\n}\n\n@keyframes popup-suggestion{0%{box-shadow:0 0 0 0 transparent,0 0 0 0 transparent;transform:scaleY(.4);transform-origin:0 100%}100%{box-shadow:0 -12px 15px -12px rgba(0,0,0,.35);transform:scaleY(1);transform-origin:0 100%}}\n\n@keyframes scale-in-bl{0%{opacity:1;transform:scale(0);transform-origin:0 100%}100%{opacity:1;transform:scale(1);transform-origin:0 100%}}\n\n@keyframes scale-in-br{0%{opacity:1;transform:scale(0);transform-origin:100% 100%}100%{opacity:1;transform:scale(1);transform-origin:100% 100%}}\n",""]),e.exports=t},5464:function(e,t,n){(t=n(3645)(!1)).push([e.id,".header {\n    align-items: center;\n    box-sizing: border-box;\n    color: #fff;\n    display: flex;\n    flex-direction: row;\n    height: 48px;\n    padding: 0 8px 0 10px;\n    text-align: start;\n}\n\n.logo {\n    flex: none;\n    height: 24px;\n    max-height: 32px;\n    max-width: 32px;\n    min-height: 16px;\n    padding: 0;\n    width: 24px;\n}\n\n.header-info-wrapper {\n    align-items: flex-start;\n    display: flex;\n    flex-direction: column;\n    flex-wrap: nowrap;\n    margin: 0 8px;\n    min-width: 0;\n    padding: 0;\n}\n\n.title {\n    color: #fff;\n    font-size: 18px;\n}\n\n.subtitle {\n    color: #fff;\n    font-size: 14px;\n}\n\n.connection-status {\n    font-size: 10px;\n    font-weight: 700;\n    text-transform: uppercase;\n}\n\n.title, .subtitle, .connection-status {\n    justify-content: center;\n    max-width: 100%;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n}\n\n.header-custom-element {\n    flex: auto;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    word-break: break-all;\n}\n\n.header-gap {\n    flex: auto;\n}\n\n.header-actions {\n    display: flex;\n    flex: none;\n}\n\n.header-button {\n    align-items: center;\n    border: none;\n    border-radius: 2px;\n    cursor: pointer;\n    display: flex;\n    height: 32px;\n    justify-content: center;\n    margin: 0 0 0 8px;\n    max-height: 32px;\n    max-width: 32px;\n    padding: 4px;\n    width: 32px;\n}\n\n.header-button:disabled {\n    cursor: default;\n    pointer-events: none;\n}\n\n.header-button svg {\n    fill: #fff;\n}\n\n.header-button:hover {\n    filter: brightness(1.2);\n}\n\n.header-button:active {\n    filter: brightness(0.875);\n}\n\n.header-button-icon {\n    height: 24px;\n    width: 24px;\n}\n\n.header-button-img-icon {\n    height: 100%;\n    max-height: 100%;\n    max-width: 100%;\n    width: 100%;\n}\n\n.header-button:disabled .header-button-icon,\n.header-button:disabled .header-button-icon:active,\n.header-button:disabled .header-button-icon:hover {\n    fill: #bbb6b2;\n}\n\n.language-selection {\n    -moz-box-sizing: border-box;\n    -webkit-box-sizing: border-box;\n    border: none;\n    box-sizing: border-box;\n    display: block;\n    font-size: 18px;\n    margin: 0;\n    max-width: 8rem;\n    min-width: 4rem;\n    padding: 2px;\n}\n\n.language-selection::-ms-expand {\n    display: none;\n}\n\n\n[dir=rtl] .header {\n    flex-direction: row-reverse;\n    padding: 0 10px 0 8px;\n}\n\n[dir=rtl] .header-info-wrapper {\n    align-items: flex-end;\n}\n\n[dir=rtl] .header-actions {\n    flex-direction: row-reverse;\n}\n\n[dir=rtl] .header-button {\n    margin: 0 8px 0 0;\n}\n",""]),e.exports=t},9192:function(e,t,n){(t=n(3645)(!1)).push([e.id,'.conversation {\n    background: #ffffff;\n    box-sizing: border-box;\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-flex: 1;\n    -ms-flex: 1;\n    flex: 1;\n    -webkit-box-orient: vertical;\n    -webkit-box-direction: normal;\n    -ms-flex-direction: column;\n    flex-direction: column;\n    font-family: -apple-system,BlinkMacSystemFont,"Segoe UI","Helvetica Neue",Arial,sans-serif;\n    overflow: auto;\n    scroll-behavior: smooth;\n    width: 100%;\n}\n',""]),e.exports=t},4068:function(e,t,n){(t=n(3645)(!1)).push([e.id,'.message-actions {\n    display: flex;\n    flex-direction: column;\n}\n\n.action-postback {\n    align-items: center;\n    background: #025e7e;\n    border-radius: 4px;\n    border-width: 1px;\n    box-sizing: border-box;\n    color: #fff;\n    cursor: pointer;\n    display: flex;\n    flex: 1 1 auto;\n    font-size: 13.75px;\n    font-style: normal;\n    font-variant: normal;\n    font-weight: 700;\n    justify-content: center;\n    letter-spacing: normal;\n    line-height: 1.31;\n    overflow-wrap: break-word;\n    padding: 12px 24px;\n    text-align: center;\n    text-decoration: none;\n    text-indent: 0;\n    text-shadow: none;\n    text-transform: none;\n    word-break: break-word;\n    word-spacing: normal;\n}\n\n.message-actions .action-postback {\n    margin: 4px;\n}\n\n.message-actions .action-postback:focus, .message-actions a.action-postback:active {\n    background: #004d80;\n}\n\n.message-actions .action-postback.disabled {\n    background: #f8f8f8;\n    border-color: #c5c5c5;\n    color: #737373;\n    cursor: default;\n}\n\n.message-actions .action-postback.disabled:hover {\n    background: #f8f8f8;\n}\n\n.message-actions .action-postback.disabled:focus, .message-actions a.action-postback.disabled:active {\n    background: #f8f8f8;\n}\n\n.message-global-actions {\n    align-items: flex-start;\n    display: flex;\n    flex-direction: column;\n    margin-top: 16px;\n}\n\n[dir="rtl"] .content-wrapper>.message-global-actions {\n    align-items: flex-end;\n}\n\n.message-global-actions.has-message-icon {\n    margin-left: 40px;\n}\n\n[dir=rtl] .message-global-actions.has-message-icon {\n    margin-left: unset;\n    margin-right: 40px;\n}\n\n.message-global-actions .action-postback {\n    border: 1px solid #1b8fd2;\n    color: #1b8fd2;\n    margin-top: 4px;\n    margin-bottom: 4px;\n}\n\n.message-global-actions .action-postback:first-of-type {\n    margin-top: 0;\n}\n\n.message-global-actions .action-postback:last-of-type {\n    margin-bottom: 0;\n}\n\n.message-global-actions .action-postback:hover {\n    background: #1b8fd2;\n    color: #fff;\n}\n\n.message-global-actions .action-postback:focus, .message-global-actions .action-postback:active {\n    background: #004d80;\n    color: #fff;\n}\n\n.message-global-actions .action-postback.disabled {\n    background: #f8f8f8;\n    border-color: #c5c5c5;\n    color: #737373;\n    cursor: default;\n}\n\n.message-global-actions .action-postback.disabled:hover, .message-global-actions .action-postback.disabled:focus, .message-global-actions .action-postback.disabled:active {\n    background: #f8f8f8;\n    border-color: #c5c5c5;\n    color: #737373;\n}\n\n.action-image {\n    margin: 0 4px;\n    max-height: 24px;\n    max-width: 24px;\n}\n',""]),e.exports=t},5311:function(e,t,n){(t=n(3645)(!1)).push([e.id,".attachment-footer {\n    align-items: center;\n    display: flex;\n    font-size: 14px;\n    justify-content: space-between;\n}\n\n.attachment-footer label {\n    flex-grow: 1;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n}\n\n.attachment-controls {\n    display: flex;\n}\n\n.attachment-image, .attachment-video {\n    width: 100%;\n}\n\n.attachment-audio {\n    width: 190px;\n}\n\n.attachment-message {\n    align-items: center;\n    display: -webkit-flex;\n    display: flex;\n}\n\n.attachment-icon {\n    align-items: center;\n    border: none;\n    background-color: transparent;\n    display: flex;\n    flex: 0 0 auto;\n    justify-content: center;\n    margin-right: 4px;\n    max-height: 32px;\n    max-width: 32px;\n    overflow: hidden;\n}\n\n.attachment-control-icon {\n    background: transparent;\n    border: none;\n    border-radius: 6px;\n    box-sizing: content-box;\n    cursor: pointer;\n    height: 24px;\n    margin-left: 10px;\n    padding: 4px;\n    width: 24px;\n}\n\n.attachment-control-icon img {\n    height: 24px;\n}\n\n.attachment-fileName {\n    margin: auto 0;\n}\n\n.attachment-image {\n    cursor: zoom-in;\n}\n\n.image-preview-wrapper {\n    background: rgb(0 0 0 / 80%);\n    height: 100%;\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    z-index: 10000;\n}\n\n.image-preview {\n    bottom: 0;\n    left: 0;\n    margin: auto;\n    max-height: 100vh;\n    max-width: 100vw;\n    position: absolute;\n    right: 0;\n    top: 0;\n}\n\n.image-preview-header {\n    align-items: center;\n    background: linear-gradient(180deg, rgb(0 0 0 / 50%), transparent);\n    color: #fff;\n    display: flex;\n    justify-content: space-between;\n    position: relative;\n    padding: 10px 20px;\n    z-index: 1000001;\n}\n\n.image-preview-close {\n    background: transparent;\n    border: none;\n    cursor: pointer;\n    height: 36px;\n    width: 36px;\n}\n\n.image-preview-close-icon {\n    fill: #fff;\n    height: 100%;\n    width: 100%;\n}\n\n[dir=rtl] .attachment-footer {\n    flex-direction: row-reverse;\n}\n\n[dir=rtl] .attachment-footer label {\n    text-align: right;\n}\n\n[dir=rtl] .attachment-control-icon {\n    margin-left: 0;\n    margin-right: 10px;\n}\n",""]),e.exports=t},773:function(e,t,n){(t=n(3645)(!1)).push([e.id,".card-message-horizontal .message-bubble.message-header, .card-message-horizontal .message-bubble.message-footer {\n    margin-right: 0;\n}\n\n[dir=rtl] .card-message-horizontal .message-bubble.message-header, .card-message-horizontal .message-bubble.message-footer {\n    margin-left: 0;\n    margin-right: unset;\n}\n\n.card-message-horizontal .content-wrapper {\n    flex: 0 0 auto;\n    min-width: 0;\n    overflow-x: visible;\n}\n\n.card-message-content {\n    line-height: 1.5;\n    max-width: 100%;\n    white-space: pre-wrap;\n}\n\n.card-message-horizontal .card-message-content {\n    position: relative;\n}\n\n.card-message-horizontal {\n    margin-left: 20px;\n    margin-right: 20px;\n}\n\n.card-message-horizontal.has-message-icon {\n    margin-left: 0;\n}\n\n[dir=rtl] .card-message-horizontal.has-message-icon {\n    margin-left: unset;\n    margin-right: 0;\n}\n\n.card-message-cards {\n    max-width: 100%;\n    margin-right: 20px;\n}\n\n[dir=rtl] .card-message-cards {\n    margin-right: unset;\n}\n\n.card-message-horizontal .card-message-cards {\n    -ms-overflow-style: none;\n    -webkit-overflow-scrolling: touch;\n    align-items: center;\n    display: flex;\n    flex-direction: row;\n    flex-wrap: nowrap;\n    justify-content: space-between;\n    max-width: 100%;\n    overflow-x: auto;\n    overflow-y: hidden;\n    position: relative;\n    scroll-behavior: smooth;\n    -ms-scroll-snap-type: x mandatory;\n    scroll-snap-type: x mandatory;\n    scrollbar-width: none;\n    white-space: nowrap;\n    width: 100%;\n}\n\n.card-message-horizontal .card-message-cards::-webkit-scrollbar {\n    display: none;\n}\n\n.card-message-horizontal .card-message-cards::-webkit-scrollbar {\n    display: none;\n}\n\n.card-message-vertical .card {\n    border-radius: 20px;\n    margin: 8px 0;\n}\n\n.card-message-vertical .card:first-of-type {\n    margin-top: 0;\n}\n\n.card-message-vertical .card:last-of-type {\n    margin-bottom: 0;\n}\n\n.card-message-vertical .message-wrapper {\n    flex-direction: column;\n}\n\n.card {\n    background: #fff;\n    border: 1px solid rgba(0, 0, 0, 0.12);\n    border-radius: 20px;\n    box-sizing: border-box;\n    display: block;\n    max-width: 100%;\n    min-width: 75%;\n    overflow: hidden;\n    padding: 20px;\n    white-space: pre-wrap;\n}\n\n.card-message-horizontal .card {\n    align-self: stretch;\n    display: flex;\n    flex: 0 0 auto;\n    flex-direction: column;\n    justify-content: space-around;\n    margin: 0 8px;\n    scroll-snap-align: start;\n}\n\n.card-message-horizontal .card:first-of-type {\n    margin-left: 0;\n}\n\n.card-message-horizontal .card:last-of-type {\n    margin-right: 0;\n}\n\n.card-image {\n    align-self: center;\n    height: 275px;\n    max-width: 100%;\n    width: 375px;\n}\n\n.card-content {\n    display: flex;\n    flex-direction: column;\n    line-height: 1.5;\n}\n\n.card-title, .card-description {\n    font-weight: 400;\n    margin: 4px;\n    max-width: 100%;\n    overflow-wrap: break-word;\n    white-space: pre-wrap;\n    word-break: break-word;\n}\n\n.card-title {\n    text-align: center;\n}\n\n.card-description {\n    text-align: start;\n}\n\n.card-actions {\n    display: flex;\n    flex-direction: column;\n}\n\n.card-actions .action-postback {\n    background: #09f;\n    margin: 4px;\n}\n\n.card-actions .action-postback:hover {\n    background: #eaeaea;\n}\n\n.card-actions button.disabled {\n    background: #fff;\n    border-color: #c5c5c5;\n    color: #737373;\n    cursor: default;\n}\n\n.card-actions button.disabled:hover {\n    background: #fff;\n    color: #737373;\n}\n\n.round {\n    -webkit-box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 1px 5px 0 rgba(0, 0, 0, 0.12);\n    align-items: center;\n    background: #eaeaea;\n    border: none;\n    border-radius: 4px;\n    box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 1px 5px 0 rgba(0, 0, 0, 0.12);\n    color: #333;\n    cursor: pointer;\n    display: flex;\n    height: 36px;\n    justify-content: center;\n    padding: 0;\n    position: absolute;\n    text-align: center;\n    top: calc(50% - 18px);\n    width: 36px;\n    z-index: 1;\n}\n\n.round svg {\n    fill: #333;\n}\n\n.round:hover {\n    background: #4a90e2;\n    color: #fff;\n}\n\n.round:hover svg {\n    fill: #fff;\n}\n\n.previous {\n    left: -18px;\n}\n\n.next {\n    right: -18px;\n}\n",""]),e.exports=t},8371:function(e,t,n){(t=n(3645)(!1)).push([e.id,".loading-icon {\n    display: -webkit-flex;\n    display: flex;\n}\n",""]),e.exports=t},8566:function(e,t,n){(t=n(3645)(!1)).push([e.id,".spinner {\n    position: relative;\n    display: inline-block;\n    width: 28px;\n    height: 28px;\n    margin-right: 4px;\n}\n\n.spinner svg {\n    animation-duration: 750ms;\n    -webkit-animation: spinner-rotate 1s linear infinite;\n    animation: spinner-rotate 1s linear infinite;\n    overflow: hidden;\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    -webkit-transform: translateZ(0);\n    transform: translateZ(0);\n}\n\n.spinner circle {\n    stroke: #387ef5;\n    fill: transparent;\n    stroke-width: 4px;\n    stroke-dasharray: 128px;\n    stroke-dashoffset: 82px;\n}\n\n@keyframes spinner-rotate {\n    0% {\n        -webkit-transform: rotate(0deg);\n        transform: rotate(0deg);\n    }\n    100% {\n        -webkit-transform: rotate(360deg);\n        transform: rotate(360deg);\n    }\n}\n",""]),e.exports=t},8274:function(e,t,n){(t=n(3645)(!1)).push([e.id,".message-with-icon {\n    align-items: center;\n    display: -webkit-flex;\n    display: flex;\n}\n\n.error-icon {\n    fill: #b3311f;\n    margin-right: 5px;\n    max-width: 24px;\n    max-height: 24px;\n}\n\n.message-text {\n    margin: auto 0;\n    text-align: start;\n    white-space: pre-wrap;\n}\n",""]),e.exports=t},9244:function(e,t,n){(t=n(3645)(!1)).push([e.id,'.message {\n    line-height: 1.5;\n    margin-bottom: 24px;\n}\n\n.left {\n    display: flex;\n    flex-direction: column;\n    justify-content: flex-start;\n    text-align: start;\n}\n\n.right {\n    display: flex;\n    flex-direction: column;\n    justify-content: flex-start;\n}\n\n.left, [dir=rtl] .right {\n    align-items: flex-start;\n}\n\n.right, [dir=rtl] .left {\n    align-items: flex-end;\n}\n\n.message-wrapper {\n    display: flex;\n    max-width: 100%;\n    width: 100%;\n}\n\n.left .message-wrapper, [dir=rtl] .right .message-wrapper {\n    flex-direction: row;\n}\n\n.right .message-wrapper, [dir=rtl] .left .message-wrapper {\n    flex-direction: row-reverse;\n}\n\n.icon-wrapper {\n    align-items: flex-end;\n    align-self: flex-end;\n    border-radius: 4px;\n    display: flex;\n    height: 32px;\n    justify-content: center;\n    min-width: 32px;\n    overflow: hidden;\n    width: 32px;\n}\n\n.left .icon-wrapper, [dir=rtl] .right .icon-wrapper {\n    margin-left: unset;\n    margin-right: 8px;\n}\n\n.right .icon-wrapper, [dir=rtl] .left .icon-wrapper {\n    margin-left: 8px;\n    margin-right: unset;\n}\n\n.message-icon {\n    height: 32px;\n    max-height: 32px;\n    max-width: 32px;\n    width: 32px;\n}\n\n.content-wrapper {\n    max-width: 100%;\n    overflow-x: auto;\n}\n\n.content-wrapper.with-icon {\n    max-width: 88%;\n}\n\n.message-bubble {\n    display: flex;\n    flex-direction: column;\n    font-size: 13.75px;\n    justify-content: center;\n    line-height: 16px;\n    margin: 0;\n    max-width: 350px;\n    padding: 20px;\n    position: relative;\n}\n\n.message-bubble a {\n    text-decoration: none;\n}\n\n.screen-reader-only {\n    height: 1px;\n    left: -20000px;\n    overflow: hidden;\n    position: absolute;\n    top: auto;\n    width: 1px;\n}\n\n.message-content, .message-header, .message-footer {\n    line-height: 1.5;\n    overflow: hidden;\n    overflow-wrap: break-word;\n    text-align: start;\n    white-space: pre-wrap;\n    word-break: break-word;\n}\n\n.message-bubble.message-header, .message-bubble.message-footer {\n    text-align: start;\n}\n\n[dir="rtl"] .message-bubble.message-header, [dir="rtl"] .message-bubble.message-footer {\n    text-align: end;\n}\n\n.left .message-header.message-header-yellow {\n    background-color: #f0cc71;\n    color: #161513;\n}\n\n.message-content {\n    margin: 4px;\n}\n\n.rating-root {\n    display: flex;\n    margin: 4px;\n}\n\n[dir="rtl"] .rating-root {\n    flex-direction: row-reverse;\n}\n\n.rating-wrapper {\n    display: flex;\n    margin-top: 8px;\n}\n\n[dir=rtl] .rating-wrapper {\n    flex-direction: row-reverse;\n}\n\n.rating-hidden {\n    border: 0;\n    clip: rect(0 0 0 0);\n    height: 1px;\n    margin: -1px;\n    overflow: hidden;\n    padding: 0;\n    position: absolute;\n    width: 1px;\n}\n\n.star-label {\n    background-color: transparent;\n    border: 0;\n    cursor: pointer;\n    padding: 0;\n}\n\n.star-label>svg>path {\n    fill: #ececec;\n}\n\n.star-input:disabled+.star-label {\n    cursor: not-allowed;\n    filter: brightness(0.8);\n}\n\n.rating-star-icon {\n    height: 32px;\n    width: 32px;\n}\n\n\n.right .message-bubble, [dir=rtl] .left .message-bubble {\n    border-radius: 24px 24px 0 24px;\n    margin-left: 20px;\n    margin-right: unset;\n}\n\n.left .message-bubble, [dir=rtl] .right .message-bubble {\n    border-radius: 24px 24px 24px 0;\n    margin-left: unset;\n    margin-right: 20px;\n}\n\n.left .message-header, [dir="rtl"] .left .message-header {\n    border-radius: 24px 24px 0 0;\n    margin-bottom: 10px;\n}\n\n.left .message-footer, [dir="rtl"] .left .message-footer {\n    border-radius: 0 0 24px 24px;\n    margin-top: 10px;\n}\n\n.left .has-header {\n    border-top-left-radius: 0;\n    border-top-right-radius: 0;\n}\n\n.left .has-footer {\n    border-bottom-right-radius: 0;\n}\n\n[dir=rtl] .left .has-footer {\n    border-bottom-left-radius: 0;\n    border-bottom-right-radius: unset;\n}\n\n.attachment-image, .attachment-video {\n    width: 100%;\n}\n\n.attachment-audio {\n    width: 190px;\n}\n\n.bubble-wrapper {\n    display: flex;\n    flex-direction: row;\n}\n\n.message-bubble.message-bubble-tabular-message {\n    border-radius: 0 8px 8px 8px;\n    padding: 0;\n    overflow: hidden;\n}\n\n.form-message, .table-message {\n    background-color: #fff;\n}\n\n.form-message-header {\n    align-items: center;\n    background-color: #f5f4f2;\n    color: #161513;\n    display: flex;\n    font-size: 16px;\n    font-weight: 700;\n    line-height: 20px;\n    padding: 12px;\n    text-align: start;\n}\n\n.form-message-item {\n    border-bottom: 1px solid #e8e8e7;\n    display: flex;\n    flex-flow: row wrap;\n    justify-content: space-between;\n    margin: 6px;\n}\n\n.form-message-field {\n    margin: 6px;\n}\n\n.form-message-field-col-1 {\n    flex-basis: 100%;\n    max-width: 100%;\n}\n\n.form-message-field-col-2 {\n    flex-basis: calc(50% - 12px);\n    max-width: calc(50% - 12px);\n}\n\n.form-message-key {\n    align-items: center;\n    color: rgba(22, 21, 19, 0.65);\n    display: flex;\n    font-size: 12px;\n    line-height: 16px;\n}\n\n.form-message-value {\n    align-items: center;\n    color: #161513;\n    display: flex;\n    font-size: 16px;\n    line-height: 20px;\n    min-height: 20px;\n}\n\n[dir="rtl"] .form-message-header, [dir="rtl"] .form-message-item, [dir="rtl"] .form-message-key, [dir="rtl"] .form-message-value,\n[dir="rtl"] .table-message-headings, [dir="rtl"] .table-message-row {\n    flex-direction: row-reverse;\n}\n\n.message .message-bubble .form-message a, .message .message-bubble .table-message a {\n    color: #00688C;\n}\n\n.results-page-status {\n    align-items: center;\n    background-color: #fff;\n    color: #161513;\n    display: flex;\n    flex-direction: row;\n    font-size: 13.75px;\n    justify-content: flex-end;\n    line-height: 16px;\n    padding: 12px 15px;\n}\n\n[dir="rtl"] .results-page-status {\n    justify-content: flex-start;\n}\n\n.table-message-wrapper {\n    overflow: auto;\n    background-color: #fff;\n}\n\n.table-message {\n    min-width: 100%;\n    max-width: 200%;\n}\n\n.table-message-headings {\n    align-items: center;\n    background-color: #f5f4f2;\n    display: flex;\n}\n\n.table-message-heading {\n    color: rgba(22, 21, 19, 0.65);\n    font-size: 12px;\n    line-height: 16px;\n    padding: 16px 12px;\n}\n\n.table-message-row {\n    border-bottom: 1px solid rgba(22, 21, 19, 0.1);\n    display: flex;\n}\n\n.table-message-item {\n    color: #161513;\n    font-size: 16px;\n    line-height: 20px;\n    padding: 16px 12px;\n    text-align: start;\n    transition: all 0.25s ease-in-out;\n}\n\n.form-message-field, .table-message-heading, .table-message-item {\n    overflow: hidden;\n    overflow-wrap: break-word;\n    word-break: break-word;\n}\n\n.table-message-item-form-toggle {\n    background-color: transparent;\n    border: none;\n    padding: 4px;\n}\n\n.rotate-180 {\n    transform: rotate3d(0, 0, 1, 180deg);\n}\n\n.tableform-message .form-message-item {\n    background-color: #FBF9F8;\n    margin: 0;\n    padding: 6px;\n    transition: all 0.25s ease-in-out;\n}\n\n.tableform-message .table-message-row {\n    cursor: pointer;\n}\n\n.form-message-item.none {\n    display: none;\n}\n\n.ellipsis {\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n}\n',""]),e.exports=t},7519:function(e,t,n){(t=n(3645)(!1)).push([e.id,".status-message-container {\n    display: flex;\n    flex-direction: column;\n    margin-bottom: 24px;\n}\n\n.status-message-wrapper {\n    align-items: center;\n    align-self: center;\n    animation: vibrate 0.5s linear both;\n    background-color: #f3f3f3;\n    border-radius: 4px;\n    display: flex;\n    flex: 0 1 auto;\n    max-width: 80%;\n    padding: 10px 24px;\n}\n\n@keyframes vibrate {\n    0% {\n        -webkit-transform: translate(0);\n                transform: translate(0);\n    }\n    20% {\n        -webkit-transform: translate(-2px, 2px);\n                transform: translate(-2px, 2px);\n    }\n    40% {\n        -webkit-transform: translate(-2px, -2px);\n                transform: translate(-2px, -2px);\n    }\n    60% {\n        -webkit-transform: translate(2px, 2px);\n                transform: translate(2px, 2px);\n    }\n    80% {\n        -webkit-transform: translate(2px, -2px);\n                transform: translate(2px, -2px);\n    }\n    100% {\n        -webkit-transform: translate(0);\n                transform: translate(0);\n    }\n}\n\n.status-image {\n    max-width: 16px;\n    max-height: 16px;\n}\n\n.status-message {\n    color: #737373;\n    font-size: 14px;\n    margin-left: 8px;\n    text-align: start;\n}\n",""]),e.exports=t},5380:function(e,t,n){(t=n(3645)(!1)).push([e.id,".hr {\n    border-top: 1px solid #eee;\n    padding: 0;\n    margin: 10px 0;\n}\n",""]),e.exports=t},6069:function(e,t,n){(t=n(3645)(!1)).push([e.id,"\n.webview-container {\n    background-color: #fff;\n    bottom: 0;\n    box-shadow: 0 -1px 1px rgba(0, 0, 0, 0.08),\n        0 -2px 2px rgba(0, 0, 0, 0.12),\n        0 -3px 4px rgba(0, 0, 0, 0.16),\n        0 -4px 8px rgba(0, 0, 0, 0.20);\n    display: flex;\n    flex-direction: column;\n    height: 0;\n    max-width: 100%;\n    position: absolute;\n    width: 100%;\n    z-index: 1;\n}\n\n.webview-container.none {\n    display: none;\n}\n\n.webview-container.webview-container-close {\n    animation: oda-chat-webview-slide-out-bottom .4s cubic-bezier(.55, .085, .68, .53) both;\n}\n\n@keyframes oda-chat-webview-slide-out-bottom {\n    0% {\n        transform: translateY(0);\n        opacity: 1;\n    }\n    95% {\n        opacity: 1;\n    }\n    100% {\n        transform: translateY(100%);\n        opacity: 0;\n    }\n}\n\n.webview-container.webview-container-open {\n    animation: oda-chat-webview-slide-in-bottom .4s cubic-bezier(.25, .46, .45, .94) both;\n}\n\n@keyframes oda-chat-webview-slide-in-bottom {\n    0% {\n        transform: translateY(100%);\n        opacity: 0;\n    }\n    1% {\n        opacity: 1;\n    }\n    100% {\n        transform: translateY(0%);\n        opacity: 1;\n    }\n}\n\n.webview-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    max-width: 100%;\n    height: 48px;\n}\n\n.webview-button-close {\n    align-items: center;\n    background: transparent;\n    border: none;\n    cursor: pointer;\n    display: flex;\n    flex: 0 0 auto;\n    justify-content: center;\n    margin: 4px;\n    padding: 4px;\n}\n\n.webview-button-close-icon {\n    height: 24px;\n    fill: #fff;\n    max-height: 32px;\n    max-width: 32px;\n    padding: 0;\n    width: 24px;\n}\n\n.progress-bar {\n    background-color: #dadada;\n    border-radius: 0;\n    border-style: none;\n    box-sizing: border-box;\n    display: block;\n    height: 4px;\n    margin: 0;\n    position: absolute;\n    overflow: hidden;\n    top: 48px;\n    width: 100%;\n}\n\n.progress-bar-overlay {\n    width: 25%;\n    height: 100%;\n    background-color: #33553c;\n    position: relative;\n    animation: oda-chat-progress-bar 2s linear infinite;\n}\n\n@keyframes oda-chat-progress-bar {\n    0% {\n        left: -35%;\n        right: 100%\n    }\n\n    60% {\n        left: 100%;\n        right: -90%\n    }\n\n    100% {\n        left: 100%;\n        right: -90%\n    }\n}\n\n.webview {\n    background-color: #fff;\n    border: none;\n    flex: 1 1 auto;\n    max-width: 100%;\n    width: 100%;\n}\n\n.webview-error {\n    align-items: center;\n    background-color: #eaeaea;\n    border: 1px solid #dadada;\n    border-radius: 4px;\n    bottom: 16px;\n    display: flex;\n    flex: 1 1 auto;\n    flex-direction: row;\n    justify-content: space-between;\n    left: 5%;\n    max-width: 400px;\n    padding: 8px 4px 8px 8px;\n    position: absolute;\n    width: 90%;\n    animation: webview-error-in .6s cubic-bezier(.390,.575,.565,1.000) both;\n}\n\n.webview-error.none {\n    animation: webview-error-out .6s cubic-bezier(.25,.46,.45,.94) both;\n}\n\n[dir=rtl] .webview-error {\n    flex-direction: row-reverse;\n    padding: 8px 8px 8px 4px;\n}\n\n.webview-error-text {\n    color: #161513;\n}\n\n.webview-alt-link {\n    font-weight: 700;\n}\n\n.webview-error-button-close svg {\n    fill: #333;\n}\n\n@keyframes webview-error-in{0%{transform:translateY(50px);opacity:0}100%{transform:translateY(0);opacity:1}}\n\n@keyframes webview-error-out{0%{transform:translateY(0);opacity:1}100%{transform:translateY(50px);opacity:0}}\n",""]),e.exports=t},3645:function(e){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n,o,i,r=e[1]||"",s=e[3];if(!s)return r;if(t&&"function"==typeof btoa){var a=(n=s,o=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(o),"/*# ".concat(i," */")),c=s.sources.map((function(e){return"/*# sourceURL=".concat(s.sourceRoot||"").concat(e," */")}));return[r].concat(c).concat([a]).join("\n")}return[r].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,o){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(o)for(var r=0;r<this.length;r++){var s=this[r][0];null!=s&&(i[s]=!0)}for(var a=0;a<e.length;a++){var c=[].concat(e[a]);o&&i[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),t.push(c))}},t}},9432:function(e,t,n){"use strict";n.r(t),n.d(t,{assign:function(){return u},format:function(){return O},parse:function(){return I},defaultI18n:function(){return g},setGlobalDateI18n:function(){return m},setGlobalDateMasks:function(){return A}});var o=/d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|Z|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g,i="[1-9]\\d?",r="\\d\\d",s="[^\\s]+",a=/\[([^]*?)\]/gm;function c(e,t){for(var n=[],o=0,i=e.length;o<i;o++)n.push(e[o].substr(0,t));return n}var l=function(e){return function(t,n){var o=n[e].map((function(e){return e.toLowerCase()})).indexOf(t.toLowerCase());return o>-1?o:null}};function u(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var o=0,i=t;o<i.length;o++){var r=i[o];for(var s in r)e[s]=r[s]}return e}var d=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],h=["January","February","March","April","May","June","July","August","September","October","November","December"],p=c(h,3),g={dayNamesShort:c(d,3),dayNames:d,monthNamesShort:p,monthNames:h,amPm:["am","pm"],DoFn:function(e){return e+["th","st","nd","rd"][e%10>3?0:(e-e%10!=10?1:0)*e%10]}},f=u({},g),m=function(e){return f=u(f,e)},v=function(e){return e.replace(/[|\\{()[^$+*?.-]/g,"\\$&")},b=function(e,t){for(void 0===t&&(t=2),e=String(e);e.length<t;)e="0"+e;return e},_={D:function(e){return String(e.getDate())},DD:function(e){return b(e.getDate())},Do:function(e,t){return t.DoFn(e.getDate())},d:function(e){return String(e.getDay())},dd:function(e){return b(e.getDay())},ddd:function(e,t){return t.dayNamesShort[e.getDay()]},dddd:function(e,t){return t.dayNames[e.getDay()]},M:function(e){return String(e.getMonth()+1)},MM:function(e){return b(e.getMonth()+1)},MMM:function(e,t){return t.monthNamesShort[e.getMonth()]},MMMM:function(e,t){return t.monthNames[e.getMonth()]},YY:function(e){return b(String(e.getFullYear()),4).substr(2)},YYYY:function(e){return b(e.getFullYear(),4)},h:function(e){return String(e.getHours()%12||12)},hh:function(e){return b(e.getHours()%12||12)},H:function(e){return String(e.getHours())},HH:function(e){return b(e.getHours())},m:function(e){return String(e.getMinutes())},mm:function(e){return b(e.getMinutes())},s:function(e){return String(e.getSeconds())},ss:function(e){return b(e.getSeconds())},S:function(e){return String(Math.round(e.getMilliseconds()/100))},SS:function(e){return b(Math.round(e.getMilliseconds()/10),2)},SSS:function(e){return b(e.getMilliseconds(),3)},a:function(e,t){return e.getHours()<12?t.amPm[0]:t.amPm[1]},A:function(e,t){return e.getHours()<12?t.amPm[0].toUpperCase():t.amPm[1].toUpperCase()},ZZ:function(e){var t=e.getTimezoneOffset();return(t>0?"-":"+")+b(100*Math.floor(Math.abs(t)/60)+Math.abs(t)%60,4)},Z:function(e){var t=e.getTimezoneOffset();return(t>0?"-":"+")+b(Math.floor(Math.abs(t)/60),2)+":"+b(Math.abs(t)%60,2)}},y=function(e){return+e-1},T=[null,i],C=[null,s],S=["isPm",s,function(e,t){var n=e.toLowerCase();return n===t.amPm[0]?0:n===t.amPm[1]?1:null}],w=["timezoneOffset","[^\\s]*?[\\+\\-]\\d\\d:?\\d\\d|[^\\s]*?Z?",function(e){var t=(e+"").match(/([+-]|\d\d)/gi);if(t){var n=60*+t[1]+parseInt(t[2],10);return"+"===t[0]?n:-n}return 0}],E={D:["day",i],DD:["day",r],Do:["day","[1-9]\\d?[^\\s]+",function(e){return parseInt(e,10)}],M:["month",i,y],MM:["month",r,y],YY:["year",r,function(e){var t=+(""+(new Date).getFullYear()).substr(0,2);return+(""+(+e>68?t-1:t)+e)}],h:["hour",i,void 0,"isPm"],hh:["hour",r,void 0,"isPm"],H:["hour",i],HH:["hour",r],m:["minute",i],mm:["minute",r],s:["second",i],ss:["second",r],YYYY:["year","\\d{4}"],S:["millisecond","\\d",function(e){return 100*+e}],SS:["millisecond",r,function(e){return 10*+e}],SSS:["millisecond","\\d{3}"],d:T,dd:T,ddd:C,dddd:C,MMM:["month",s,l("monthNamesShort")],MMMM:["month",s,l("monthNames")],a:S,A:S,ZZ:w,Z:w},x={default:"ddd MMM DD YYYY HH:mm:ss",shortDate:"M/D/YY",mediumDate:"MMM D, YYYY",longDate:"MMMM D, YYYY",fullDate:"dddd, MMMM D, YYYY",isoDate:"YYYY-MM-DD",isoDateTime:"YYYY-MM-DDTHH:mm:ssZ",shortTime:"HH:mm",mediumTime:"HH:mm:ss",longTime:"HH:mm:ss.SSS"},A=function(e){return u(x,e)},O=function(e,t,n){if(void 0===t&&(t=x.default),void 0===n&&(n={}),"number"==typeof e&&(e=new Date(e)),"[object Date]"!==Object.prototype.toString.call(e)||isNaN(e.getTime()))throw new Error("Invalid Date pass to format");var i=[];t=(t=x[t]||t).replace(a,(function(e,t){return i.push(t),"@@@"}));var r=u(u({},f),n);return(t=t.replace(o,(function(t){return _[t](e,r)}))).replace(/@@@/g,(function(){return i.shift()}))};function I(e,t,n){if(void 0===n&&(n={}),"string"!=typeof t)throw new Error("Invalid format in fecha parse");if(t=x[t]||t,e.length>1e3)return null;var i={year:(new Date).getFullYear(),month:0,day:1,hour:0,minute:0,second:0,millisecond:0,isPm:null,timezoneOffset:null},r=[],s=[],c=t.replace(a,(function(e,t){return s.push(v(t)),"@@@"})),l={},d={};c=v(c).replace(o,(function(e){var t=E[e],n=t[0],o=t[1],i=t[3];if(l[n])throw new Error("Invalid format. "+n+" specified twice in format");return l[n]=!0,i&&(d[i]=!0),r.push(t),"("+o+")"})),Object.keys(d).forEach((function(e){if(!l[e])throw new Error("Invalid format. "+e+" is required in specified format")})),c=c.replace(/@@@/g,(function(){return s.shift()}));var h=e.match(new RegExp(c,"i"));if(!h)return null;for(var p=u(u({},f),n),g=1;g<h.length;g++){var m=r[g-1],b=m[0],_=m[2],y=_?_(h[g],p):+h[g];if(null==y)return null;i[b]=y}1===i.isPm&&null!=i.hour&&12!=+i.hour?i.hour=+i.hour+12:0===i.isPm&&12==+i.hour&&(i.hour=0);for(var T=new Date(i.year,i.month,i.day,i.hour,i.minute,i.second,i.millisecond),C=[["month","getMonth"],["day","getDate"],["hour","getHours"],["minute","getMinutes"],["second","getSeconds"]],S=(g=0,C.length);g<S;g++)if(l[C[g][0]]&&i[C[g][0]]!==T[C[g][1]]())return null;return null==i.timezoneOffset?T:new Date(Date.UTC(i.year,i.month,i.day,i.hour,i.minute-i.timezoneOffset,i.second,i.millisecond))}var M={format:O,parse:I,defaultI18n:g,setGlobalDateI18n:m,setGlobalDateMasks:A};t.default=M},9297:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return m}});var o=function(e){var t=this.constructor;return this.then((function(n){return t.resolve(e()).then((function(){return n}))}),(function(n){return t.resolve(e()).then((function(){return t.reject(n)}))}))},i=function(e){return new this((function(t,n){if(!e||void 0===e.length)return n(new TypeError(typeof e+" "+e+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var o=Array.prototype.slice.call(e);if(0===o.length)return t([]);var i=o.length;function r(e,n){if(n&&("object"==typeof n||"function"==typeof n)){var s=n.then;if("function"==typeof s)return void s.call(n,(function(t){r(e,t)}),(function(n){o[e]={status:"rejected",reason:n},0==--i&&t(o)}))}o[e]={status:"fulfilled",value:n},0==--i&&t(o)}for(var s=0;s<o.length;s++)r(s,o[s])}))},r=setTimeout,s="undefined"!=typeof setImmediate?setImmediate:null;function a(e){return Boolean(e&&void 0!==e.length)}function c(){}function l(e){if(!(this instanceof l))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(e,this)}function u(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,l._immediateFn((function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var o;try{o=n(e._value)}catch(e){return void h(t.promise,e)}d(t.promise,o)}else(1===e._state?d:h)(t.promise,e._value)}))):e._deferreds.push(t)}function d(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof l)return e._state=3,e._value=t,void p(e);if("function"==typeof n)return void f((o=n,i=t,function(){o.apply(i,arguments)}),e)}e._state=1,e._value=t,p(e)}catch(t){h(e,t)}var o,i}function h(e,t){e._state=2,e._value=t,p(e)}function p(e){2===e._state&&0===e._deferreds.length&&l._immediateFn((function(){e._handled||l._unhandledRejectionFn(e._value)}));for(var t=0,n=e._deferreds.length;t<n;t++)u(e,e._deferreds[t]);e._deferreds=null}function g(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function f(e,t){var n=!1;try{e((function(e){n||(n=!0,d(t,e))}),(function(e){n||(n=!0,h(t,e))}))}catch(e){if(n)return;n=!0,h(t,e)}}l.prototype.catch=function(e){return this.then(null,e)},l.prototype.then=function(e,t){var n=new this.constructor(c);return u(this,new g(e,t,n)),n},l.prototype.finally=o,l.all=function(e){return new l((function(t,n){if(!a(e))return n(new TypeError("Promise.all accepts an array"));var o=Array.prototype.slice.call(e);if(0===o.length)return t([]);var i=o.length;function r(e,s){try{if(s&&("object"==typeof s||"function"==typeof s)){var a=s.then;if("function"==typeof a)return void a.call(s,(function(t){r(e,t)}),n)}o[e]=s,0==--i&&t(o)}catch(e){n(e)}}for(var s=0;s<o.length;s++)r(s,o[s])}))},l.allSettled=i,l.resolve=function(e){return e&&"object"==typeof e&&e.constructor===l?e:new l((function(t){t(e)}))},l.reject=function(e){return new l((function(t,n){n(e)}))},l.race=function(e){return new l((function(t,n){if(!a(e))return n(new TypeError("Promise.race accepts an array"));for(var o=0,i=e.length;o<i;o++)l.resolve(e[o]).then(t,n)}))},l._immediateFn="function"==typeof s&&function(e){s(e)}||function(e){r(e,0)},l._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};var m=l},7927:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stopAudioInput=t.getAudioInputUserMedia=t.getAudioInput=t.isAudioInputAvailable=t.AudioInputSourceType=void 0;var o=n(9297);!function(e){e[e.DEFAULT=0]="DEFAULT",e[e.VOICE_RECOGNITION=6]="VOICE_RECOGNITION"}(t.AudioInputSourceType||(t.AudioInputSourceType={})),t.isAudioInputAvailable=function(){return void 0!==(0,t.getAudioInput)()},t.getAudioInput=function(){return window.audioinput},t.getAudioInputUserMedia=function(e){return new o.default((function(e,n){(0,t.getAudioInput)().checkMicrophonePermission((function(o){o?e():(0,t.getAudioInput)().getMicrophonePermission((function(t,o){t?e():n(o)}))}))})).then((function(){return(0,t.getAudioInput)().start(e),(0,t.getAudioInput)()}))},t.stopAudioInput=function(){return new o.default((function(e){(0,t.getAudioInput)().isCapturing()?((0,t.getAudioInput)().stop(e),(0,t.getAudioInput)().disconnect()):e()}))}},7496:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ChatEvent=void 0,function(e){e.CHAT_LANG="chatlanguagechange",e.CLICK_AUDIO_RESPONSE_TOGGLE="click:audiotoggle",e.CLICK_ERASE="click:erase",e.CLICK_VOICE_TOGGLE="click:voicetoggle",e.DESTROY="destroy",e.CHAT_END="chatend",e.MESSAGE="message",e.MESSAGE_RECEIVED="message:received",e.MESSAGE_SENT="message:sent",e.NETWORK="networkstatuschange",e.READY="ready",e.TYPING="typing",e.UNREAD="unreadCount",e.WIDGET_CLOSED="widget:closed",e.WIDGET_OPENED="widget:opened"}(n||(n={})),t.ChatEvent=n},7632:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CONNECTION_STATE=void 0,function(e){e[e.CONNECTING=0]="CONNECTING",e[e.OPEN=1]="OPEN",e[e.CLOSING=2]="CLOSING",e[e.CLOSED=3]="CLOSED"}(t.CONNECTION_STATE||(t.CONNECTION_STATE={}))},4534:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Constants=t.ATTACHMENT_MAX_SIZE=t.BYTE_MULTIPLIER=t.STYLE_SHEET_ID=t.SDK_VERSION=t.SDK_NAME=void 0;var n=function(){function e(){}return e.GEOLOCATION_REQUEST_DENIED=1,e.CHAT_SCROLL_DELAY=300,e.WEBSOCKET_READY_STATE=["CONNECTING","OPEN","CLOSING","CLOSED"],e.WEBSOCKET_CLOSE_EVENT={CODE:{ABNORMAL_CLOSURE:1006}},e.ATTACHMENT_HEADER={AUTHORIZATION:"Authorization",FILE_AUTH_TYPE:"x-oda-meta-file-authType",FILE_IS_PROTECTED:"x-oda-meta-file-isProtected",FILE_SIZE:"x-oda-meta-file-size"},e.ATTACHMENT_STATUS={ERROR_FILE_SIZE_LIMIT_EXCEEDED:413,ERROR_FILE_SIZE_ZERO_BYTE:465,ERROR_UNSUPPORTED_FILE_TYPE:415,OK:200},e.MAX_SUGGESTIONS_COUNT=5,e.MIN_SUGGESTIONS_COUNT=1,e.SUGGESTIONS_COUNT_THRESHOLD=30,e.SDK_NAME="oda-chat",e.TIME={MIN_FIFTY:3e6},e}();t.Constants=n,t.SDK_NAME="oda-chat",t.SDK_VERSION="21.12.0",t.STYLE_SHEET_ID="".concat(t.SDK_NAME,"-stylesheet"),t.BYTE_MULTIPLIER=1024,t.ATTACHMENT_MAX_SIZE=25*t.BYTE_MULTIPLIER*t.BYTE_MULTIPLIER},5544:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Deferred=void 0;var o=n(9297),i=function(){var e=this;this.promise=new o.default((function(t,n){e.resolve=t,e.reject=n})),Object.freeze(this)};t.Deferred=i},1489:function(e,t,n){"use strict";var o=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var o,i=0,r=t.length;i<r;i++)!o&&i in t||(o||(o=Array.prototype.slice.call(t,0,i)),o[i]=t[i]);return e.concat(o||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.getConfirmationDialog=t.ButtonType=t.getBanner=t.addChild=t.on=t.createImageIcon=t.createIconButton=t.getPrefixCSSClass=t.removeCSSClass=t.addCSSClass=t.createImage=t.createElementFromString=t.createButton=t.createMedia=t.createAnchor=t.createDiv=t.createElement=void 0;var i=n(4534),r=n(1389),s=n(5949);t.createElement=function(e,t){var n=document.createElement(e);return c(n,t),n},t.createDiv=function(e){return(0,t.createElement)("div",e)},t.createAnchor=function(e,n,o,i,r){void 0===i&&(i=!1);var s=(0,t.createElement)("a",o);s.rel="noreferrer noopener";var a=!1;return s.href=e,s.innerText=n,r&&(r.onclick&&(s.onclick=r.onclick.bind(s),a=!0),r.target&&(s.target=r.target,a=!0)),a||(i?s.addEventListener("click",(function(t){return window.open(e,"","height=450px,width=800px,menubar,toolbar,personalbar,status,resizable,noopener,noreferrer"),t.preventDefault(),t.stopPropagation(),!1})):s.target="_blank"),s},t.createMedia=function(e,n,o){var i=(0,t.createElement)(e,n);return o&&(i.src=o),i.autoplay=!1,i},t.createButton=function(e){var n="button",o=(0,t.createElement)(n,e);return o.type=n,o},t.createElementFromString=function(e,n){var i=(0,t.createDiv)();i.innerHTML=e.trim();var r=i.firstElementChild;return n&&t.addCSSClass.apply(void 0,o([i.firstElementChild],n.map((function(e){return(0,t.getPrefixCSSClass)(e)})),!1)),r},t.createImage=function(e,n,o){var i=(0,t.createElement)("img",n);return e&&(i.src=e),o&&(i.alt=o),i.setAttribute("draggable","false"),i};var a,c=function(e,n){return e.dir?e.dir="auto":e.setAttribute("dir","auto"),n&&t.addCSSClass.apply(void 0,o([e],n.map((function(e){return(0,t.getPrefixCSSClass)(e)})),!1)),e};function l(e){var n=e.icon,o=e.title,i=e.iconCss;if((0,s.isSVG)(n)){var r=(0,t.createElementFromString)(n,i);return r.setAttribute("role","img"),r.setAttribute("aria-label",o),r}return(0,t.createImage)(n,i,o)}function u(e,t,n,o){e.addEventListener(t,n,o)}function d(e,t){e.appendChild(t)}t.addCSSClass=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];e.classList?t.forEach((function(t){return e.classList.add(t)})):e.setAttribute("class",t.reduce((function(e,t){return"".concat(e," ").concat(t)}),""))},t.removeCSSClass=function(e){for(var t,n,o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];if(e.classList)o.forEach((function(t){return e.classList.remove(t)}));else{var r="class",s=null!==(n=null===(t=e.getAttribute(r))||void 0===t?void 0:t.split(" "))&&void 0!==n?n:[];if(s.length){var a=s.filter((function(e){return s.indexOf(e)<0})).join(" ");e.setAttribute(r,a)}}},t.getPrefixCSSClass=function(e){return"".concat(i.SDK_NAME,"-").concat(e)},t.createIconButton=function(e){var n=e.css,o=e.icon,i=e.title,r=e.iconCss,s=(0,t.createButton)(n);s.innerHTML="",s.title=i;var a=l({icon:o,iconCss:r,title:i});return s.appendChild(a),s},t.createImageIcon=l,t.on=u,t.addChild=d,t.getBanner=function(e){var n="prompt-banner",o=(0,t.createDiv)([n]),s=l({icon:r.iconWarn,title:""}),a=(0,t.createDiv)(["".concat(n,"-icon")]);d(a,s);var c=(0,t.createDiv)(["".concat(n,"-text")]);c.innerText=e.text,c.setAttribute("role","alert");var h=e.closeIcon||r.iconClose,p="".concat(n,"-close-button"),g=(0,t.createIconButton)({css:[p],icon:h,title:e.closeText,iconCss:["".concat(p,"-icon")]});return u(g,"click",(function(){(0,t.addCSSClass)(o,"".concat(i.SDK_NAME,"-").concat(n,"-out")),setTimeout((function(){return o.remove()}),200)})),setTimeout((function(){g&&g.click()}),6e3),d(o,a),d(o,c),d(o,g),o},function(e){e.FILLED="filled",e.OUTLINE="outline"}(a=t.ButtonType||(t.ButtonType={})),t.getConfirmationDialog=function(e,n){var o="prompt-banner",i=(0,t.createDiv)(["dialog-wrapper"]),r=(0,t.createDiv)(["".concat(o,"-background")]),s=(0,t.createDiv)(["prompt-banner","dialog"]),c=(0,t.createDiv)(["".concat(o,"-text")]);if(c.innerText=e.title,s.appendChild(c),e.description){var l=(0,t.createDiv)(["".concat(o,"-description")]);l.innerText=e.description,s.appendChild(l)}var u=e.actions;if(u&&u.length){var d=(0,t.createDiv)(["action-wrapper"]);u.forEach((function(e){var o=["action-postback"];e.type===a.FILLED&&o.push("filled");var i=(0,t.createButton)(o);i.innerHTML=e.label,i.onclick=e.handler.bind(n),d.appendChild(i)})),s.appendChild(d)}return i.appendChild(r),i.appendChild(s),i}},8674:function(e,t,n){"use strict";var o=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var o,i=0,r=t.length;i<r;i++)!o&&i in t||(o||(o=Array.prototype.slice.call(t,0,i)),o[i]=t[i]);return e.concat(o||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.generateEventDispatcher=void 0;var i=n(5949),r=n(8798);t.generateEventDispatcher=function(){var e={},t=new r.Logger("event");return{bind:function(t,n){t&&n&&(0,i.isFunction)(n)&&(e.hasOwnProperty(t)?e[t].push(n):e[t]=[n])},trigger:function(n){for(var i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];e.hasOwnProperty(n)&&(i=null!=i?i:[],e[n].forEach((function(e){try{e.call.apply(e,o([null],i,!1))}catch(e){t.error("".concat(n," listener threw error"),e)}})))},unbind:function(t,n){t?n?e[t]=e[t].filter((function(e){return e!==n})):e.hasOwnProperty(t)&&e[t].splice(0,e[t].length):e={}}}}},3729:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isValidMessage=t.isMessagePayload=t.isProfileMessage=t.isMessage=void 0;var o=n(4347),i=n(6213),r=n(330);function s(e){return e&&"messagePayload"in e}function a(e){return e&&"type"in e}function c(e){return e&&e.length&&e.every((function(e){return e.type&&e.label&&"string"==typeof e.label}))}function l(e){var t=e.headings,n=e.rows;return t&&t.length&&n&&n.length&&t.every((function(e){return d(e)}))&&n.every((function(e){return h(e)}))}function u(e){var t=e.forms,n=e.formColumns;return t&&t.length&&t.every((function(e){return h(e)}))&&(1===n||2===n)}function d(e){var t=e.label;return t&&t.length>0}function h(e){var t=e.fields;return t&&t.length&&t.every((function(e){return function(e){var t=e.displayType;return t&&("link"===t||"text"===t)&&d(e)}(e)}))}t.isMessage=s,t.isProfileMessage=function(e){return e&&"profile"in e&&"object"==typeof e.profile&&null!==e.profile},t.isMessagePayload=a,t.isValidMessage=function(e,t){var n=!1;if(s(e)){var d=e.messagePayload;if(a(d)){if(d.actions&&!c(d.actions))return n;if(d.globalActions&&!c(d.globalActions))return n;switch(d.type){case i.PAYLOAD_TYPE.ATTACHMENT:return function(e){var t=e.attachment;return!!(t&&t.type&&t.url)}(d);case i.PAYLOAD_TYPE.CARD:if(t&&t!==r.SENDER_TYPE.BOT)break;return function(e){var t=e.layout,n=e.cards;return(t===o.LAYOUT.HORIZONTAL||t===o.LAYOUT.VERTICAL)&&n&&n.length&&n.every((function(e){return e.title&&(!e.actions||c(e.actions))}))}(d);case i.PAYLOAD_TYPE.LOCATION:return function(e){var t=e.location;return!!(t&&t.latitude&&t.longitude)}(d);case i.PAYLOAD_TYPE.POSTBACK:return function(e){return!!e.postback}(d);case i.PAYLOAD_TYPE.TEXT:return function(e){return!!e.text}(d);case i.PAYLOAD_TYPE.Table:return l(d);case i.PAYLOAD_TYPE.Form:return u(d);case i.PAYLOAD_TYPE.TableForm:return function(e){return l(e)&&u(e)}(d)}}}return n}},9594:function(){"use strict";Number.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}},8952:function(){"use strict";[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach((function(e){e.hasOwnProperty("prepend")||Object.defineProperty(e,"prepend",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=Array.prototype.slice.call(arguments),t=document.createDocumentFragment();e.forEach((function(e){var n=e instanceof Node;t.appendChild(n?e:document.createTextNode(String(e)))})),this.insertBefore(t,this.firstChild)}})}))},6400:function(){"use strict";[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach((function(e){e.hasOwnProperty("remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode&&this.parentNode.removeChild(this)}})}))},4428:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.Response=void 0,function(e){e[e.OK=200]="OK"}(n||(n={}));var o=function(){function e(){}return e.STATUS=n,e}();t.Response=o},1389:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.iconZoom=t.iconWarn=t.iconVideo=t.iconTypingIndicator=t.iconTTSUnmute=t.iconTTSMute=t.iconShareMedia=t.iconShareLocation=t.iconShareFile=t.iconShareAudio=t.iconSend=t.iconRating=t.iconMic=t.iconLogo=t.iconLaunchButton=t.iconKeyboard=t.iconImage=t.iconFile=t.iconError=t.iconDownload=t.iconCollapse=t.iconClose=t.iconClearHistory=t.iconChevronPrevious=t.iconChevronNext=t.iconChevronDown=t.iconAudio=t.iconAttach=void 0;var n=I('<path d="M11.007 15.117A1 1 0 0 0 13 15V7l-.005-.176A3 3 0 0 0 7 7v8l.005.217A5 5 0 0 0 17 15V5h2v10a7 7 0 1 1-14 0V7a5 5 0 0 1 10 0v8l-.005.176A3 3 0 0 1 9 15V9h2v6z"/>');t.iconAttach=n;var o=I('<path d="M4 2h10.414L20 7.586V10h-2V9h-5V4H6v16h12v-1h2v3H4zm11 3.414L16.586 7H15z"/><path d="m7.764 17 1.849-4.87h1.012L12.486 17H11.32l-.32-.998H9.204L8.882 17zm1.722-1.883h1.226l-.617-1.916zm3.278-.415v-2.573h1.045v2.553c0 .531.079.916.235 1.152.156.233.404.349.744.349.344 0 .591-.116.743-.349.157-.236.235-.62.235-1.152v-2.553h1.045v2.573c0 .822-.165 1.427-.496 1.816-.326.384-.835.576-1.527.576s-1.204-.192-1.535-.576c-.326-.389-.489-.994-.489-1.816zM17.686 17v-4.87h1.635c.795 0 1.396.205 1.802.616.407.41.61 1.018.61 1.822 0 .795-.203 1.4-.61 1.816-.402.41-1.002.616-1.802.616zm1.622-4.02h-.577v3.17h.577c.45 0 .786-.128 1.005-.383.223-.259.335-.659.335-1.2s-.11-.94-.329-1.198c-.218-.26-.556-.389-1.011-.389z"/>');t.iconAudio=o;var i=I('<path d="M6.35 8L5 9.739 12 16l7-6.261L17.65 8 12 13.054z"/>');t.iconChevronDown=i;var r=I('<path d="M8 17.65L9.739 19 16 12 9.739 5 8 6.35 13.054 12z"/>');t.iconChevronNext=r;var s=I('<path d="M16 17.65L14.261 19 8 12l6.261-7L16 6.35 10.946 12z"/>');t.iconChevronPrevious=s;var a=I('<path d="M6 11h8v2H6zm0-4h12v2H6z"/><path d="M2 2v20h3.5l3-4H14v-2H7.5l-3 4H4V4h16v6h2V2z"/><path d="M20.3 12.3L19 13.6l-1.3-1.3-1.4 1.4 1.3 1.3-1.3 1.3 1.4 1.4 1.3-1.3 1.3 1.3 1.4-1.4-1.3-1.3 1.3-1.3z"/>');t.iconClearHistory=a;var c=I('<path d="M17.524 5 19 6.476 13.475 12 19 17.524 17.524 19 12 13.475 6.476 19 5 17.524 10.525 12 5 6.476 6.476 5 12 10.525z"/>');t.iconClose=c;var l=I('<path d="M11 13v9H9v-5.586l-6.293 6.293-1.414-1.414L7.586 15H2v-2zM21.293 1.293l1.414 1.414L16.414 9H22v2h-9V2h2v5.586z"/>');t.iconCollapse=l;var u=I('<path xmlns="http://www.w3.org/2000/svg" d="M4 15v5h16v-5h2v7H2v-7zm9-13v10.587l3.293-3.294 1.414 1.414L12 16.414l-5.707-5.707 1.414-1.414L11 12.585V2z"/>');t.iconDownload=u;var d=I('<path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zM8.707 7.293l8 8-1.414 1.414-8-8z"/></svg>');t.iconError=d;var h=I('<path d="M14.414 2 21 8.584V22H3V2.009zM13 3.999l-8 .007v15.995h14V9.996l-6 .001zm4.585 3.998L15 5.413v2.585z"/>');t.iconFile=h;var p=I('<path d="M4 2h10.414L20 7.586V22H4zm2 2v16h12V9h-5V4zm9 1.414L16.586 7H15z"/><path d="M16 12a1 1 0 11-2 0 1 1 0 012 0zm-6.143 1L7 19h10l-2.857-4.5L12 16.75z"/>');t.iconImage=p;var g=I('<path d="M22 5v14H2V5zm-2 2H4v10h16zM7 13v2H5v-2zm12 0v2h-2v-2zm-4 0v2H9v-2zM7 9v2H5V9zm12 0v2h-2V9zm-4 0v2h-2V9zm-4 0v2H9V9z" />');t.iconKeyboard=g,t.iconLaunchButton='<svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 36 36"><path d="M0 0h36v36H0V0z" fill="#025e7e"/><path fill-rule="evenodd" clip-rule="evenodd" d="M7.875 8.625a2.25 2.25 0 00-2.25 2.25v16c0 .621.504 1.125 1.125 1.125h.284c.298 0 .585-.119.796-.33l2.761-2.76a2.25 2.25 0 011.59-.66h15.944a2.25 2.25 0 002.25-2.25V10.875a2.25 2.25 0 00-2.25-2.25H7.875zM24.75 18a2.25 2.25 0 100-4.5 2.25 2.25 0 000 4.5zm-4.5-2.25a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0zm-9 2.25a2.25 2.25 0 100-4.5 2.25 2.25 0 000 4.5z" fill="#fff"/></svg>';var f=I('<path d="M4.014 3C2.911 3 2 3.888 2 4.992v15c0 .6.408 1.008 1.007 1.008h.6a.887.887 0 0 0 .695-.288l3.094-3.12c.407-.384.91-.6 1.415-.6h11.175C21.089 16.992 22 16.104 22 15V4.992C22 3.888 21.089 3 19.986 3zm3.981 7.008A1.986 1.986 0 0 1 6.005 12c-1.103 0-1.99-.888-1.99-1.992s.887-2.016 1.99-2.016 1.99.912 1.99 2.016zm5.995 0C13.99 11.112 13.103 12 12 12s-1.99-.888-1.99-1.992.887-2.016 1.99-2.016 1.99.912 1.99 2.016zm5.996 0c0 1.104-.888 1.992-1.99 1.992s-1.991-.888-1.991-1.992.887-2.016 1.99-2.016 1.99.912 1.99 2.016z" fill="#fff"/>');t.iconLogo=f;var m=I('<path d="M7 22v-2h4v-2.062C7.06 17.444 4 14.073 4 10h2c0 3.309 2.691 6 6 6s6-2.691 6-6h2c0 4.072-3.059 7.444-7 7.938V20h4v2h-6zm5-20c2.206 0 4 1.794 4 4v4c0 2.206-1.794 4-4 4s-4-1.794-4-4V6c0-2.206 1.794-4 4-4zm0 2c-1.103 0-2 .897-2 2v4c0 1.103.897 2 2 2s2-.897 2-2V6c0-1.103-.897-2-2-2z"/>');t.iconMic=m;var v=I('<path d="M19.33 23.02l-7.332-3.666-7.332 3.666 1.418-7.995L1 9.555l7.331-1.222L11.998 1l3.666 7.333 7.332 1.222-5.084 5.47z"/>');t.iconRating=v;var b=I('<path d="M21.692 2.28l.015.015a1.02 1.02 0 01.205.294l.007.018a.97.97 0 01.03.711l-.005.014-6 18c-.3.855-1.49.904-1.858.076l-3.844-7.648-7.648-3.844c-.828-.368-.78-1.559.076-1.858l18-6 .018-.006a.998.998 0 01.049-.015l-.067.021c.048-.017.096-.03.144-.04.005 0 .012 0 .018-.002.33-.06.641.054.86.264zM18.68 6.735l-6.456 6.456 2.665 5.1zm-1.416-1.413L5.711 9.112l5.099 2.664z"/>');t.iconSend=b;var _=I('<path d="M22 2v20H2V2zm-2 2H4v16h16zm-3 1.674V14a2 2 0 11-2.15-1.995L15 12V8.326l-5 1.428V16a2 2 0 11-2.15-1.995L8 14V8.246z"/>');t.iconShareAudio=_;var y=I('<path d="M13.414 2L17 5.586V7h.414L21 10.586V22H7v-4H3V2zM17 9.414V18H9v2h10v-8.586zm-2-3L12.586 4H5v12h10zM13 11v2H7v-2zm-2-4v2H7V7z"/>');t.iconShareFile=y;var T=I('<path d="M12 2c3.874 0 6.994 3.28 6.99 7.214l.011.285c.008.927-.202 2.23-.787 3.837-.96 2.639-2.73 5.452-5.49 8.353L12 22.45l-.724-.761c-2.76-2.901-4.53-5.714-5.49-8.353-.627-1.722-.823-3.095-.782-4.03l.006-.252C5.134 5.147 8.205 2 12 2zm0 2C9.254 4 7.006 6.362 7.002 9.386L7 9.529c-.004.694.168 1.753.667 3.123.741 2.036 2.038 4.221 4.014 6.507l.32.365.32-.365c1.867-2.159 3.127-4.228 3.886-6.166l.128-.34c.535-1.469.694-2.58.664-3.259l-.008-.32C16.879 6.244 14.676 4 12 4zm0 2a3 3 0 1 1-.001 6A3 3 0 0 1 12 6zm0 2a1 1 0 1 0 .001 2A1 1 0 0 0 12 8z"/>');t.iconShareLocation=T;var C=I('<path d="M22 2v16h-4v4H2V6h4V2zm-9.036 12.378L6.93 20H16v-2.585zM16 8H4v11.999l9.036-8.377L16 14.585zm4-4H8v2h10v10h2zM7 9a2 2 0 110 4 2 2 0 010-4z"/>');t.iconShareMedia=C;var S=I('<path d="M1.707.293l22 22-1.414 1.414L12 13.414V21l-6.35-5.114H1V7.954h4.65l.5-.39L.293 1.707zM19.67 4.446c2.119 1.967 3.302 4.613 3.33 7.452a10.363 10.363 0 01-1.392 5.295l-1.476-1.476c.58-1.18.88-2.472.868-3.8-.023-2.29-.981-4.43-2.697-6.025zM7.583 8.996l-1.232.955H3v3.964h3.351L10 16.875v-5.461zm8.051-1.68C17.15 8.547 17.991 10.21 18 11.999c.003.482-.055.956-.17 1.416l-1.86-1.86c-.133-1.017-.691-1.964-1.604-2.706zM12 3v4.586L9.424 5.01z"/>');t.iconTTSMute=S;var w=I('<path d="M13 3v18l-6.35-5.114H2V7.954h4.65zm5.67 1.446c2.119 1.967 3.302 4.613 3.33 7.452.029 2.904-1.15 5.658-3.316 7.75l-1.396-1.421c1.772-1.71 2.735-3.95 2.712-6.31-.023-2.29-.981-4.43-2.697-6.025zM11 7.125L7.351 9.95H4v3.964h3.351L11 16.875zm4.634.19C17.15 8.548 17.991 10.212 18 12c.01 1.806-.828 3.5-2.358 4.771l-1.284-1.519c1.065-.885 1.65-2.037 1.642-3.242-.006-1.187-.587-2.309-1.634-3.16z"/>');t.iconTTSUnmute=w;var E=I('<path d="M18 12.99h-6.267L8 17.125a1.119 1.119 0 0 1-1.021-1.36V12.99H6a5.849 5.849 0 0 1-6-5.87A6.061 6.061 0 0 1 6 1h12a6.061 6.061 0 0 1 6 6.12 5.849 5.849 0 0 1-6 5.87z" fill="#d1d1d1"/><path d="M4 7a2 2 0 1 0 4 0 2 2 0 1 0-4 0" style="animation-name:dotScaleleft;animation-duration:1s;animation-iteration-count:infinite;transform-origin:20%;animation-delay:0s" fill="#fff"/><path d="M10 7a2 2 0 1 0 4 0 2 2 0 1 0-4 0" style="animation-name:dotScalecenter;animation-duration:1s;animation-iteration-count:infinite;transform-origin:43%;animation-delay:.2s" fill="#fff"/><path d="M16 7a2 2 0 1 0 4 0 2 2 0 1 0-4 0" style="animation-name:dotScaleright;animation-duration:1s;animation-iteration-count:infinite;transform-origin:70%;animation-delay:.4s" fill="#fff"/><style>@keyframes dotScaleleft{0%,to{transform:scale(1)}50%{transform:scale(1.25)}}@keyframes dotScalecenter{0%,to{transform:scale(1)}50%{transform:scale(1.25)}}@keyframes dotScaleright{0%,to{transform:scale(1)}50%{transform:scale(1.25)}}</style>');t.iconTypingIndicator=E;var x=I('<path d="M4 2h10.414L20 7.586V10h-2V9h-5V4H6v16h12v-1h2v3H4zm11 3.414L16.586 7H15z"/><path d="m12.36 17-1.796-4.87h1.18l1.138 3.584 1.153-3.585h1.132L13.37 17zm3.33 0v-4.87h1.046V17zm1.996 0v-4.87h1.635c.795 0 1.396.205 1.802.616.407.41.61 1.018.61 1.822 0 .795-.203 1.4-.61 1.816-.402.41-1.002.616-1.802.616zm1.622-4.02h-.577v3.17h.577c.45 0 .786-.128 1.005-.383.223-.259.335-.659.335-1.2s-.11-.94-.329-1.198c-.218-.26-.556-.389-1.011-.389z"/>');t.iconVideo=x;var A=I('<path d="M11 11h2v4h-2zm0 6h2v2h-2z"/><path d="M12 1.8L1.9 22h20.2L12 1.8zm0 4.4L18.9 20H5.1L12 6.2z"/>');t.iconWarn=A;var O=I('<path d="M11 2a9 9 0 017.032 14.617l3.675 3.676-1.414 1.414-3.676-3.675A9 9 0 1111 2zm0 2a7 7 0 100 14 7 7 0 000-14zm1 3v3h3v2h-3v3h-2v-3H7v-2h3V7z"/>');function I(e){return'<svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 24 24">'.concat(e,"</svg>")}t.iconZoom=O},5949:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setEmbeddedWebViewLinksHandler=t.sanitizeText=t.resetRegex=t.matchStringIgnoreCase=t.getValues=t.formatDate=t.utils=t.skipHTTPS=t.getYouTubeID=t.linkify=t.isFeedbackComponent=t.isAnyVoiceAvailable=t.isSVG=t.isMobile=t.isInteger=t.isFunction=void 0;var o,i=n(2466),r=n(9432),s={createCssClass:function(e,t){var n="";return(null==t?void 0:t.length)>0&&(n=e+" {\n",t.forEach((function(e){n+="  "+e+";\n"})),n+="}\n\n"),n},deepFreeze:function(e){for(var t=0,n=Object.keys(e);t<n.length;t++){var o=e[n[t]];o&&"object"==typeof o&&s.deepFreeze(o)}return Object.freeze(e)},isDivVisible:function(e,t){var n=e.scrollTop,o=n+e.offsetHeight,i=t.offsetTop,r=i+t.offsetHeight;return o>i&&o<r||n<r&&o>r||n<i&&o>r||n>i&&o<r},isSvg:function(e){var t=e.match(/<svg\s/gi);return t&&t.length>0},isSameDay:function(e,t){return e=new Date(e),t=new Date(t),e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()},secToMillisec:function(e){return 1e3*e},setEmbeddedLinksHandler:function(e,t){for(var n=0;n<e.childElementCount;n++){var o=e.children[n];if("a"===o.tagName.toLowerCase()){var i=o;i.rel="noreferrer noopener",t.onclick&&(i.onclick=t.onclick.bind(i)),t.target&&(i.target=t.target)}o.hasChildNodes()&&s.setEmbeddedLinksHandler(o,t)}},setLinksOpenInNewWindow:function(e){for(var t=function(t){var n=e.children[t];"a"===n.tagName.toLowerCase()&&(n.onclick=function(e){return window.open(n.href,"","height=450px,width=800px,menubar,toolbar,personalbar,status,resizable,noopener,noreferrer"),e.preventDefault(),e.stopPropagation(),!1}),n.hasChildNodes()&&s.setLinksOpenInNewWindow(n)},n=0;n<e.childElementCount;n++)t(n)},setObjectReadOnly:function(e){for(var t=0,n=Object.getOwnPropertyNames(e);t<n.length;t++){var o=n[t];Object.defineProperty(e,o,{configurable:!0,writable:!1})}return e},setSearchParams:function(e,t){for(var n=[],o=0,i=Object.keys(t);o<i.length;o++){var r=i[o];n.push("".concat(r,"=").concat(t[r]))}return n.length&&(e="".concat(e,"?").concat(n.join("&"))),e},syncTTSLocaleIfUnavailable:(o=!1,function(e){var t;void 0===e&&(e={hasRecognition:!1,hasSynthesis:!1,isReset:!1,recognitionLocale:"",synthesisLocales:[]}),e.isReset&&(o=!1);var n=e.synthesisLocales;return Array.isArray(n)||(n=[]),e.hasRecognition&&e.hasSynthesis&&(null===(t=e.recognitionLocale)||void 0===t?void 0:t.length)&&(!o&&e.synthesisLocales.length||(o=!0,n=[{lang:e.recognitionLocale}])),n})};t.utils=s,t.formatDate=function(e,t){var n=t.pattern,o=t.fallback,i=t.locale,s=e.toLocaleString(i,o);if("object"==typeof n&&null!==n)return e.toLocaleString(i,n);if("string"==typeof n)try{return(0,r.format)(e,n)}catch(e){}return s},t.getValues=function(e){var t=[];if("object"==typeof e&&null!==e)for(var n=0,o=Object.keys(e);n<o.length;n++){var i=o[n];t.push(e[i])}return t},t.isFunction=function(e){return e instanceof Function},t.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},t.isMobile=function(){return/Android/i.test(navigator.userAgent)||/iPhone|iPad/i.test(navigator.userAgent)},t.isSVG=function(e){var t=e.match(/<svg\s/gi);return t&&t.length>0},t.matchStringIgnoreCase=function(e,t){return(e=e.toLowerCase())===(t=t.toLowerCase())};var a=function(e){return e.lastIndex=0,e};t.resetRegex=a;var c=[{match:/<([a-z])/gi,replace:function(e,t){return"&#x3c;".concat(t)}},{match:/<\/([a-z])/gi,replace:function(e,t){return"&#x3c;&#47;".concat(t)}}],l=function(e){return c.forEach((function(t){e=e.replace(a(t.match),t.replace)})),e};t.sanitizeText=l;var u=function(e,t){for(var n,o=0;o<e.childElementCount;o++){var r=e.children[o];if("a"===r.tagName.toLowerCase()){var s=r;s.rel="noreferrer noopener",(null===(n=s.target)||void 0===n?void 0:n.toLowerCase())===i.default.NAME&&s.addEventListener("click",t.onclick.bind(s))}r.hasChildNodes()&&u(r,t)}};t.setEmbeddedWebViewLinksHandler=u,t.isAnyVoiceAvailable=function(e,t){if(!t)return Promise.resolve(!1);if(Array.isArray(t)||(t=[t]),!t.length)return Promise.resolve(!1);var n=t.map((function(e){var t;return null===(t=e.lang)||void 0===t?void 0:t.toLowerCase()}));return e.getVoices().then((function(e){for(var t=!1,o=e.map((function(e){return e.lang.toLowerCase()})),i=0,r=n;i<r.length;i++){var s=r[i];if(o.indexOf(s)>=0){t=!0;break}}return t}))},t.isFeedbackComponent=function(e){return void 0!==e.ratingId};var d=/((?:href|src)\s*=\s*['"])?(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim,h=/((?:href|src)\s*=\s*['"])?([-+&@#\/%?=~_|!:,.;])?(\bwww\.[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim,p=/(youtube\.com\/watch\?v=|youtu.be\/)([^#&?\s]*)/gim;function g(e,t){var n=t?f(e):null;return n?'<iframe width="100%" src="https://www.youtube.com/embed/'.concat(n,'" frameborder="0" ')+'allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>':'<a href="'.concat(e,'" target="_blank">').concat(e,"</a>")}function f(e){var t;return e.replace(a(p),(function(e,n,o){return o&&o.length&&(t=o),e})),t}t.linkify=function(e,t){var n=(t=t||{}).emHTML?e:l(e),o=n&&n.replace(a(d),(function(e,n,o){return n?e:g(o,t.emVideo)}));return o&&o.replace(a(h),(function(e,n,o,i){return n||o?e:g(i,t.emVideo)}))},t.getYouTubeID=f,t.skipHTTPS=function(e){return e.replace(/^https?\:\/\//i,"")}},8656:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setAudioContext=t.polyfillUserMedia=t.isUserMediaAvailable=t.isStorageAvailable=t.isLocationServiceAvailable=t.getLocales=t.getCurrentLocation=t.getBrowserLocale=void 0;var o=n(9297);t.getBrowserLocale=function(){return navigator.language.toLowerCase()},t.getCurrentLocation=function(){return(0,t.isLocationServiceAvailable)()?new o.default((function(e,t){navigator.geolocation.getCurrentPosition((function(t){e(t)}),(function(e){t(e)}),{timeout:5e3})})):o.default.reject(new Error("Location service is not available."))},t.getLocales=function(){var e;return(null===(e=navigator.languages)||void 0===e?void 0:e.map((function(e){return e.toLowerCase()})))||[]},t.isLocationServiceAvailable=function(){return navigator&&navigator.geolocation},t.isStorageAvailable=function(e){return i(e)},t.isUserMediaAvailable=function(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia)},t.polyfillUserMedia=function(){(0,t.isUserMediaAvailable)()&&(void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(e){var t=navigator.webkitGetUserMedia||navigator.mozGetUserMedia;if(!t){var n=new Error("getUserMedia is not implemented in this browser");return n.name="TypeError",o.default.reject(n)}return new o.default((function(n,o){t.call(navigator,e,n,o)}))}))},t.setAudioContext=function(){window.AudioContext=window.AudioContext||window.webkitAudioContext};var i=function(e){var t;try{t=window[e];var n="__storage_test__";return t.setItem(n,n),t.removeItem(n),!0}catch(e){return e instanceof DOMException&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&t&&0!==t.length}}},7214:function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.WidgetComponent=void 0;var s=n(9297),a=n(93),c=n(3145),l=n(7632),u=n(4534),d=n(1389),h=n(5949),p=n(3884),g=n(7074),f=n(6213),m=n(466),v=n(4230),b=n(8414),_=n(3777),y=n(2365),T=n(2304),C=n(8798),S=n(2401),w=n(9176),E=n(134),x=n(7332),A=n(1793),O=n(7496),I=n(1489),M=n(8674),k=n(8656),P=n(3729),L=n(2466),N=n(9622),D=n(330),B=n(8861),R=n(2601),F=n(6979),V=n(9978),H=I.createDiv,U=I.getPrefixCSSClass,z=I.removeCSSClass,Y=I.addCSSClass,j=p.isBotMessage,W=window.BroadcastChannel,G=function(e){function t(t,n,o,i,r,s,a,l,u,d,h,p){var g,f,v=e.call(this)||this;return v.settings=t,v.openChat=n,v.closeChat=o,v.handleSessionEnd=i,v.receiveMessage=r,v.sentMessage=s,v.getUnreadMessagesCount=a,v.onConnectionStatusChange=l,v.dataService=u,v._speechRecognitionService=d,v.authTokenService=h,v._eventDispatcher=p,v.FINAL_RESULT_DISPLAY_TIMEOUT=200,v._logger=new C.Logger("ChatComponent"),v._attachmentDivs=[],v._unreadMessages=[],v._latestSkillMessages=[],v._skillMessages=[],v._isNewMessage=!0,v.isInitMessageSent=!1,v.isExpanded=!1,v.isFirstConnectionOpen=!1,v.isFirstMessage=!1,v.timestampHeaderFormat={month:"long",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0},v.messageIDs=[],v.currentLocale=t.locale,v._localeText=t.i18n[t.locale],v.isOpen=t.openChatOnLoad,v.isExpanded="init"===(null===(g=t.initMessageOptions)||void 0===g?void 0:g.sendAt)||t.openChatOnLoad||t.embedded,v.isInitMessageSent=t.enableHeadless,v.ttsService=t.ttsService,v._isFirstConnect=!0,v.observer=(0,M.generateEventDispatcher)(),v.settings.enableEndConversation&&(v.endConversationPrompt=(0,I.getConfirmationDialog)({title:v._localeText.endConversationConfirmMessage||"",description:v._localeText.endConversationDescription||"",actions:[{label:v._localeText.noText,handler:v.closePrompt},{label:v._localeText.yesText,handler:v.endConversation,type:I.ButtonType.FILLED}]},v)),v.settings.enableTabsSync||(v.initBroadcaster=function(){}),v.dataService.on(m.ChatServerEvent.STATUS,v.onChatServerStatusChange.bind(v)),v.dataService.onMessage=v._onMessageReceived.bind(v),v.dataService.onOriginalMessage=v._onOriginalMessageReceived.bind(v),v.dataService.onFinalSentMessage=v._onFinalMessageSent.bind(v),v.dataService.onSuggestions=v._onSuggestionsReceived.bind(v),v.element=v._createElement(),v.ttsService&&(v.isTTSMute=v.settings.initBotAudioMuted),v.initMultiLangChat(),"function"!=typeof l&&(v.onConnectionStatusChange=function(){}),v.settings.showTypingIndicator&&(v.typingIndicator=new x.TypingIndicatorComponent(c.MESSAGE_SIDE.LEFT,t)),"relative"===v.settings.timestampMode?v.relativeTimestamp=new N.RelativeTimestampComponent(t):(v.setTimestampHeaderIfNewDate=function(){},v.updateRelativeTimestamp=function(){}),"action"!==(null===(f=v.settings.focusOnNewMessage)||void 0===f?void 0:f.toLowerCase())&&(v.focusMessageFirstAction=function(){}),v}return i(t,e),t.prototype.render=function(e){},t.prototype.embedInElement=function(e){var t=this,n=document.getElementById(e);if(!n)throw new Error("Can not embed chat widget.");var o=function(){t.chatWidgetDiv.style.width=n.clientWidth+"px",t.chatWidgetDiv.style.height=n.clientHeight+"px",t.chatWidgetDiv.style.position="inherit",t.chatWidgetDiv.style.boxShadow="none"};o(),this.appendToElement(n),this.resizeEventListener=function(){o()},window.addEventListener("resize",this.resizeEventListener)},t.prototype.showChat=function(){var e=this;this.isOpen||(z(this.element,U("collapsed")),Y(this.element,U("expanded")),z(this.chatWidgetDiv,U("none")),this.settings.embedded||setTimeout((function(){Y(e._botButton,U("none"))}),250),this.isOpen=!0,this.isExpanded=!0,this._sendInitMessages(),this._updateUnreadMessages(),this._scrollToBottom(),this.footer.focusTextArea(),this.observer.trigger(O.ChatEvent.WIDGET_OPENED))},t.prototype.onClose=function(){var e,t=this;if(this.isOpen){if(this._ttsCancel(),z(this.element,U("expanded")),Y(this.element,U("collapsed")),!this.settings.embedded){z(this._botButton,U("none")),setTimeout((function(){Y(t.chatWidgetDiv,U("none")),t._botButton.focus()}),250);var n=this.getUnreadMessagesCount();n>0?this._botButton.appendChild(this._botNotificationBadge):(null===(e=this._botNotificationBadge)||void 0===e?void 0:e.parentElement)&&this._botNotificationBadge.remove(),this._botNotificationBadge.innerText=""+n}this.isOpen=!1}},t.prototype.sendExitEvent=function(){var e={messagePayload:{type:f.PAYLOAD_TYPE.CLOSE_SESSION},userId:this.settings.userId,date:new Date,isRead:!0};this.dataService.send(e,null,null,{hidden:!0,delegate:!1})},t.prototype.updateNotificationBadge=function(e){var t;this.isOpen||(e>0?this._botButton.appendChild(this._botNotificationBadge):((null===(t=this._botNotificationBadge)||void 0===t?void 0:t.parentElement)&&this._botNotificationBadge.remove(),this._unreadMessages=[]))},t.prototype.onToggleNarration=function(e){this._toggleNarration(e),this._eventDispatcher.trigger(O.ChatEvent.CLICK_AUDIO_RESPONSE_TOGGLE,e)},t.prototype.remove=function(){e.prototype.remove.call(this),this.dataService.onMessage=function(){},this.settings.embedded&&window.removeEventListener("resize",this.resizeEventListener)},t.prototype.clearConversationHistory=function(){this.dataService.clearMessages(this.settings.userId),this.clearChatPane(),this.broadcastAction({type:"actionClearHistory"})},t.prototype.setUserInputMessage=function(e){this.footer.setUserInputText(e,!0)},t.prototype.setUserInputPlaceholder=function(e){this.footer.setUserInputPlaceholder(e)},t.prototype.getWebViewComponent=function(){return this.webViewComponent},t.prototype.onMessageActionClicked=function(e){var t=this;switch(this.onSpeechToggle(!1),e.type){case g.ACTION_TYPE.POSTBACK:this._scrollToBottom(),"none"!==this.settings.disablePastActions&&e.messageComponent.disableActions(),e.getPayload().then((function(n){var o=(0,a.createUserMessage)({postback:n,text:e.label,type:f.PAYLOAD_TYPE.POSTBACK},t.settings.userId,new Date,!0);e.label===t._localeText.retryMessage?t.dataService.retryMessage(o):t._sendMessageToServer(o)}));break;case g.ACTION_TYPE.LOCATION:this.shareUserLocation();break;case g.ACTION_TYPE.SHARE:navigator.share?e.getPayload().then((function(n){navigator.share({text:n,title:e.label}).then((function(){"none"!==t.settings.disablePastActions&&e.messageComponent.disableActions()}))})):this._showBanner(this._localeText.shareFailureMessage)}},t.prototype.sendMessage=function(e,t){var n,o=!1;if(!e)return this._logger.error("No message passed to send to bot"),o;if("string"==typeof e?(n=!this.settings.enableSpeechAutoSend&&this.speechFinalResult&&e.toLowerCase().indexOf(this.speechFinalResult.text)>=0?(0,a.createUserTextMessage)(e,this.speechFinalResult.speechId):(0,a.createUserTextMessage)(e),this.speechFinalResult=null):n=e,n){var i=(0,a.createUserMessage)(n,this.settings.userId,new Date,!0);(0,P.isValidMessage)(i,D.SENDER_TYPE.USER)&&(o=this._sendMessageToServer(i,t))}else this._logger.error("Can not parse payload from message",e);return o},t.prototype.uploadFile=function(e,t){var n=this;this._ttsCancel(),this._onSendMessage();var o=new s.default((function(o,i){var r;if(n.settings.enableHeadless)n.dataService.uploadAttachment(e).then((function(e){o(e)})).catch((function(e){i(e)}));else{n._scrollToBottom();var s=null===(r=e.name)||void 0===r?void 0:r.replace(/[\s:\'"\\/\[\]~,\.;^`()@#%\*+=$&!{}?<>|]/g,""),a="".concat(s).concat(Math.floor(1e4+9e4*Math.random())).concat(Date.now()%1e5),l=H();l.id=a,n._attachmentDivs.push({divId:a,fileName:e.name}),n.setTimestampHeaderIfNewDate(new Date),n._appendMessageToConversation(l),n.updateRelativeTimestamp(D.SENDER_TYPE.USER);var d=t?t.maxSize:u.ATTACHMENT_MAX_SIZE;if(e.size>d){n._scrollToBottom();var p=d/(u.BYTE_MULTIPLIER*u.BYTE_MULTIPLIER),g=p.toString();(0,h.isInteger)(p)||(g=p.toFixed(3));var f="".concat(e.name," - ").concat(n._localeText.uploadFileSizeLimitExceeded.replace("{0}",g));n.displayUploadError(f,a),i(new Error(f))}else if(0===e.size)n._scrollToBottom(),f="".concat(e.name," - ").concat(n._localeText.uploadFileSizeZeroByte),n.displayUploadError(f,a),i(new Error(f));else{var m=new S.LoadingMessageComponent(e.name,c.MESSAGE_SIDE.RIGHT,n.settings);l.appendChild(m.render()),n._scrollToBottom(),n.dataService.uploadAttachment(e,n._handleUploadError.bind(n),a,!0).then((function(e){o(e)})).catch((function(e){i(e)}))}}}));return o.catch((function(e){n._logger.error(e)})),o},t.prototype.refreshTTS=function(){this.ttsService=this.settings.ttsService,this.header.showTTSButton(!!this.ttsService)},t.prototype.speakTTS=function(e){var t;if("string"==typeof e)t=e;else{if(!(0,P.isValidMessage)(e))return;t=(0,F.getUtteranceText)(e,this._localeText)}this._ttsSpeak(t)},t.prototype.cancelSpeechSynthesis=function(){this._ttsCancel()},t.prototype.getSuggestions=function(e){var t=this;if(!this.settings.enableAutocompleteClientCache||this.settings.enableAutocompleteClientCache&&!this.footer.getSuggestionsValid()){var n=u.Constants.SUGGESTIONS_COUNT_THRESHOLD,o=(0,a.createUserMessage)({query:e,threshold:n,type:f.PAYLOAD_TYPE.SUGGEST},this.settings.userId,new Date,!0);return new s.default((function(e,n){t._suggestionsResolve=e,t.dataService.getSuggestions(o),setTimeout((function(){n("Request timeout. Taking too long to get suggestions.")}),1e4)}))}var i=this._filterSuggestions(this.footer.getSuggestions(),e);return null!=this.footer&&this.footer.displaySuggestions(i),s.default.resolve(i)},t.prototype.setSkillResponseVoices=function(e){var t;(null==e?void 0:e.length)&&(null===(t=this.ttsService)||void 0===t||t.setVoice(e))},t.prototype.setVoiceRecognitionService=function(e){this.footer.disableVoiceModeButton(!e,{src:"lang"})},t.prototype.enableSpeechSynthesisService=function(e){this.header.disableTTSButton(!e)},t.prototype.onShareLocation=function(){this.shareUserLocation()},t.prototype.setPrimaryChatLanguage=function(e){this.multiLangChat.setTag(e)},t.prototype.onLanguageUpdate=function(e,t){void 0===t&&(t=!0);var n=this.settings.i18n,o=r(r({},n[this.settings.locale]),n[e]);t&&this.broadcastAction({type:"actionLanguage",tag:e}),this.currentLocale=e,this._botButton.title=o.chatTitle,this.header.setLocale(o),this.footer.setLocale(o),this.webViewComponent.setProps({accessibilityTitle:o.webViewAccessibilityTitle,closeButtonLabel:o.webViewClose,errorInfoDismissLabel:o.webViewErrorInfoDismiss,errorInfoText:o.webViewErrorInfoText}),this.relativeTimestamp&&this.relativeTimestamp.setLocale(o),this._localeText=o},t.prototype.on=function(e,t){this.observer.bind(e,t)},t.prototype.off=function(e,t){this.observer.unbind(e,t)},t.prototype.showTypingIndicator=function(){this.settings.showTypingIndicator&&(this.typingIndicator.append(this._conversationContainer),this._scrollToBottom())},t.prototype.showEndConversationPrompt=function(){(0,I.addChild)(this.chatPane.element,this.endConversationPrompt)},t.prototype.endConversation=function(){this.sendExitEvent(),this.endConversationPrompt.remove()},t.prototype.closePrompt=function(){var e=this.endConversationPrompt;e.parentElement&&e.remove()},t.prototype.hideTypingIndicator=function(){this.settings.showTypingIndicator&&this.typingIndicator.remove()},t.prototype.onChatServerStatusChange=function(e){if(this._isFirstConnect&&(this._loadPreviousConversations(),this._isFirstConnect=!1),Number.isInteger(e)&&e!==l.CONNECTION_STATE.OPEN){this.stopBroadcaster(),this.footer.isDisabled()||(this.footer.disable(),this.header.disable(),this._logger.debug("WebSocket not open, send message button disabled")),this._onDisconnection(),this.hideTypingIndicator();for(var t=0,n=this._attachmentDivs;t<n.length;t++){var o=n[t];this._handleUploadError(o.fileName,500,o.divId)}}else this.initBroadcaster(),this.isFirstConnectionOpen=!0,this._sendInitMessages(),this.footer.isDisabled()&&(this.footer.disable(!1),this.header.disable(!1),this._logger.debug("Connection established, send message button enabled")),this._onConnection();this.onConnectionStatusChange(e)},t.prototype.initMultiLangChat=function(){var e=this.settings;this.multiLangChat=new B.MultiLangChatComponent(e.multiLangChat,{chatService:this.dataService,chatWidget:this,eventDispatcher:this._eventDispatcher,settings:e,speechSynthesisService:this.ttsService,storageService:new R.StorageService(e.storageType),synthesisVoices:e.skillVoices,voiceRecognitionService:this._speechRecognitionService});var t=this.multiLangChat.render();t&&this.header.addLanguageSelect(t)},t.prototype.shareUserLocation=function(){var e=this;if((0,k.isLocationServiceAvailable)()){var t=new S.LoadingMessageComponent(this._localeText.requestLocation,c.MESSAGE_SIDE.LEFT,this.settings);this._appendMessageToConversation(t.render()),this._scrollToBottom(),(0,k.getCurrentLocation)().then((function(n){var o=n.coords,i=(0,a.createUserMessage)({location:{latitude:o.latitude,longitude:o.longitude,title:void 0},type:f.PAYLOAD_TYPE.LOCATION},e.settings.userId,new Date,!0);t.remove(),e._sendMessageToServer(i)}),(function(n){var o;switch(n.code){case n.PERMISSION_DENIED:o=e._localeText.requestLocationDeniedPermission;break;case n.POSITION_UNAVAILABLE:o=e._localeText.requestLocationDeniedUnavailable;break;case n.TIMEOUT:o=e._localeText.requestLocationDeniedTimeout;break;default:o=e._localeText.requestLocationDeniedPermission}e._showBanner(o),t.remove()}))}else this._showBanner(this._localeText.requestLocationDeniedUnavailable)},t.prototype._filterSuggestions=function(e,t){for(var n=[],o=0,i=e;o<i.length;o++){var r=i[o];-1!==r.search(new RegExp(t,"i"))&&n.push(r)}return n},t.prototype._handleUploadError=function(e,t,n){var o;switch(t){case u.Constants.ATTACHMENT_STATUS.ERROR_FILE_SIZE_LIMIT_EXCEEDED:o=e+" - "+this._localeText.uploadFileSizeLimitExceeded.replace("{0}","25");break;case u.Constants.ATTACHMENT_STATUS.ERROR_FILE_SIZE_ZERO_BYTE:o=e+" - "+this._localeText.uploadFileSizeZeroByte;break;case u.Constants.ATTACHMENT_STATUS.ERROR_UNSUPPORTED_FILE_TYPE:o=e+" - "+this._localeText.uploadUnsupportedFileType;break;default:o=e+" - "+this._localeText.uploadFailed}this.displayUploadError(o,n)},t.prototype.displayUploadError=function(e,t){var n=new w.MessageStringComponent(e,c.MESSAGE_SIDE.LEFT,this.settings),o=document.getElementById(t);o.firstElementChild&&o.removeChild(o.firstElementChild),this._attachmentDivs=this._attachmentDivs.filter((function(e){return e.divId!==t}));var i=this.settings.icons.error||d.iconError;o.appendChild(n.render(i))},t.prototype._makeButtonDraggable=function(e,t){var n,o,i=this,r=!1,s=!1,a=0,c=0,l=0,u=0,d=0,h=0,p=function(e){for(var t,n,o=e.target.classList,i=0;i<o.length;i++)o[i].indexOf("button-drag-handle")&&("touchstart"===e.type?(t=e.touches[0].clientX,n=e.touches[0].clientY):(t=e.clientX,n=e.clientY),a=t-l,c=n-u,d=t,h=n,r=!0)},g=function(i){var p,g;if(r){"touchmove"===i.type?(p=i.touches[0].clientX,g=i.touches[0].clientY):(p=i.clientX,g=i.clientY);var f=p-d,m=g-h;l=n=p-a,u=o=g-c,(f>=5||m>=5||f<=-5||m<=-5)&&(e.classList.add(U("drag")),t.style.transform="translate3d("+n+"px, "+o+"px, 0)",t.onclick=null,s=!0)}},f=function(){s&&(setTimeout((function(){t.onclick=i.openChat.bind(i)}),10),t.focus(),s=!1),r=!1},m=H(["button-drag-handle"]);t.appendChild(m),t.addEventListener("touchstart",p),document.addEventListener("touchmove",g),t.addEventListener("touchend",f),t.addEventListener("mousedown",p),document.addEventListener("mousemove",g),t.addEventListener("mouseup",f)},t.prototype._createElement=function(){var e,n,o,i,r,s=this,a=this.settings,c=H(a.embedded?[]:["wrapper"]);this.chatWidgetDiv=H(["widget"]),this.chatWidgetDiv.setAttribute("role","region"),this.chatWidgetDiv.setAttribute("aria-labelledby","oda-chat-title"),this.header=new b.ChatHeaderComponent(a,this.closeChat.bind(this),this.clearConversationHistory.bind(this),this.onToggleNarration.bind(this),this.dataService,this.showEndConversationPrompt.bind(this)),this.chatWidgetDiv.appendChild(this.header.element),a.embedTopStickyId&&this.addCustomBanner(a.embedTopStickyId,this.chatWidgetDiv,["embed-sticky-top"]),this.chatPane=new _.WidgetMainComponent,this.chatPane.element.id=t.CHAT_MESSAGES_PARENT_ID,this.chatPane.element.addEventListener("scroll",this._updateUnreadMessages.bind(this)),this._scrollContent=H(["conversation-pane"]),a.embedTopScrollId&&this.addCustomBanner(a.embedTopScrollId,this._scrollContent,["embed-scroll-top"]);var l=H("bottom"===a.conversationBeginPosition?["empty-conversation-div"]:void 0);this._scrollContent.appendChild(l),this._conversationContainer=H(["conversation-container"]),this._conversationContainer.setAttribute("role","log"),this._conversationContainer.setAttribute("aria-live","polite"),this._conversationContainer.setAttribute("aria-atomic","false"),this._scrollContent.appendChild(this._conversationContainer),this.chatPane.element.appendChild(this._scrollContent),a.embedBottomScrollId&&this.addCustomBanner(a.embedBottomScrollId,this.chatPane.element,["embed-scroll-bottom"]),this.chatWidgetDiv.appendChild(this.chatPane.element),a.embedBottomStickyId&&this.addCustomBanner(a.embedBottomStickyId,this.chatWidgetDiv,["embed-sticky-bottom"]),this.footer=new v.ChatFooterComponent(this.sendMessage.bind(this),this.uploadFile.bind(this),a,this.getSuggestions.bind(this),this.onSpeechToggle.bind(this),this.shareUserLocation.bind(this),this._eventDispatcher),this.chatWidgetDiv.appendChild(this.footer.element),(e=a.webViewConfig).accessibilityTitle||(e.accessibilityTitle=this._localeText.webViewAccessibilityTitle),(n=a.webViewConfig).closeButtonLabel||(n.closeButtonLabel=this._localeText.webViewClose),(o=a.webViewConfig).errorInfoDismissLabel||(o.errorInfoDismissLabel=this._localeText.webViewErrorInfoDismiss),(i=a.webViewConfig).errorInfoText||(i.errorInfoText=this._localeText.webViewErrorInfoText),(r=a.webViewConfig).closeButtonIcon||(r.closeButtonIcon=a.icons.close),this.webViewComponent=new L.default(a.webViewConfig),this.chatWidgetDiv.appendChild(this.webViewComponent.render());var u=this;if(this.webviewLinkHandler={target:L.default.NAME,onclick:function(){u.webViewComponent.open(this.href)}},a.linkHandler&&a.linkHandler.target===L.default.NAME&&(a.linkHandler=this.webviewLinkHandler),c.appendChild(this.chatWidgetDiv),a.embedded)this.isOpen=!0,Y(c,U("open"));else{var h=a.icons.launch||(a.colors&&a.colors.branding?d.iconLaunchButton.replace("#025e7e",a.colors.branding):d.iconLaunchButton),p="button",g=(0,I.createIconButton)({css:[p],icon:h,iconCss:["".concat(p,"-icon")],title:this._localeText.chatTitle});this._botButton=g,this._botButton.onclick=this.openChat.bind(this),this._botNotificationBadge=H(["notification-badge"]),c.appendChild(g),a.openChatOnLoad?(Y(c,U("expanded")),Y(g,U("none")),setTimeout((function(){return s.footer.focusTextArea()}))):(Y(c,U("collapsed")),Y(this.chatWidgetDiv,U("none"))),a.enableDraggableButton&&this._makeButtonDraggable(c,g)}return c},t.prototype._appendMessageToConversation=function(e){var t;this._conversationContainer.appendChild(e),(null===(t=this.typingIndicator)||void 0===t?void 0:t.isVisible())&&(this.hideTypingIndicator(),this.showTypingIndicator())},t.prototype._scrollToBottom=function(){var e=document.getElementById(t.CHAT_MESSAGES_PARENT_ID);setTimeout((function(){e&&(e.scrollTop=e.scrollHeight)}),u.Constants.CHAT_SCROLL_DELAY)},t.prototype.renderMessagesAndScroll=function(e,t){var n=this,o=t.attachmentDivId;return(null==e?void 0:e.length)?new s.default((function(t){n.authTokenService&&n.settings.enableAttachmentSecurity?n.authTokenService.getToken().then((function(i){n._renderMessages(e,{attachmentDivId:o,authToken:i.token}),t(),n._scrollToBottom()})).catch((function(){n._renderMessages(e,{attachmentDivId:o}),t(),n._scrollToBottom()})):(n._renderMessages(e,{attachmentDivId:o}),t(),n._scrollToBottom())})):(this._renderMessages(e,{}),s.default.resolve())},t.prototype._renderMessages=function(e,t){var n=this,o=t.attachmentDivId,i=t.authToken,r={locale:this.currentLocale,webviewLinkHandler:this.webviewLinkHandler};(null==i?void 0:i.length)&&(r.authToken=i,r.uri=this.settings.URI),e.forEach((function(e){if(j(e)){var t=(0,V.getMessageDigest)(e);if(n.messageIDs.indexOf(t)>=0)return;n.messageIDs.push(t)}var i=T.MessageComponentFactory.fromMessage(n.settings,e,n._markAsRead.bind(n),r);if(i.onActionClick=n.onMessageActionClicked.bind(n),(0,h.isFeedbackComponent)(i)&&(n.pendingFeedback=i),j(e))n._isNewMessage?n._onReceiveMessage(i):n._skillMessages.push(i);else if(n.pendingFeedback){if(e.messagePayload.type===f.PAYLOAD_TYPE.TEXT||e.messagePayload.type===f.PAYLOAD_TYPE.POSTBACK){var s=e.messagePayload;n.pendingFeedback.highlightRating(s.text)}n.pendingFeedback=null}if(o){var a=document.getElementById(o);a.removeChild(a.firstElementChild),a.appendChild(i.render()),n._attachmentDivs=n._attachmentDivs.filter((function(e){return e.divId!==o}))}else{n.setTimestampHeaderIfNewDate(e.date);var c=i.render();n._appendMessageToConversation(c),n.updateRelativeTimestamp(j(e)?D.SENDER_TYPE.BOT:D.SENDER_TYPE.USER);var l={component:i,element:c};n._markMessageAsReadIfVisible(l),n._unreadMessages.push(l),j(e)&&n.focusMessageFirstAction(i)}})),this.settings.embedded||this.isOpen||setTimeout((function(){var e=n.getUnreadMessagesCount();e>0&&(n._botNotificationBadge.innerText=""+e,n._botButton.appendChild(n._botNotificationBadge))}))},t.prototype.setTimestampHeaderIfNewDate=function(e){!this.isFirstMessage&&h.utils.isSameDay(this.currTimestampHeader,e)||(this.currTimestampHeader=new Date(e),this._appendMessageToConversation(this.createTimestampHeader(this.currTimestampHeader)),this.isFirstMessage=!1)},t.prototype.createTimestampHeader=function(e){var t=H(["timestamp-header"]);return t.textContent=(0,h.formatDate)(e,{pattern:this.settings.timestampFormat,fallback:this.timestampHeaderFormat,locale:this.currentLocale||this.settings.locale}),t},t.prototype.updateRelativeTimestamp=function(e){this.relativeTimestampElement||(this.relativeTimestampElement=this.relativeTimestamp.render()),this.relativeTimestampElement.remove(),this.relativeTimestamp.refresh(e),this._appendMessageToConversation(this.relativeTimestampElement)},t.prototype.focusMessageFirstAction=function(e){e.hasActions()&&setTimeout((function(){e.focusFirstAction()}),290)},t.prototype.addCustomBanner=function(e,t,n){var o=document.querySelector("#".concat(e));if(o){var i=H(n);i.appendChild(o),t.appendChild(i)}else this._logger.error("Could not find element with ID '".concat(e,"'. No element embedded to the chat conversation pane."))},t.prototype.onSpeechToggle=function(e){var t=this;this._ttsCancel(),this._eventDispatcher.trigger(O.ChatEvent.CLICK_VOICE_TOGGLE,e),this.settings.enableSpeech&&(e?(this._hideBanner(),this._speechRecognitionService.startRecording(this.onSpeechRecognition.bind(this),this.onSpeechNetworkChange.bind(this),{onAnalyserFrequencies:function(e){t.footer.updateVisualizer(Array.from(e))}}).then((function(){t.footer.setVoiceRecording(!0),t._scrollToBottom()})).catch((function(e){t.footer.setVoiceRecording(!1),t._showBanner(e.message)}))):(this._speechRecognitionService.isRecording()&&this._speechRecognitionService.stopRecording(),this.footer.setVoiceRecording(!1)))},t.prototype.onSpeechRecognition=function(e){var t,n,o,i=this;if(e)switch(e.event){case A.IVoiceRecognitionEvent.FINAL_RESULT:(null===(t=null==e?void 0:e.nbest)||void 0===t?void 0:t.length)>0?(r=e.nbest[0].utterance).length>0?(this.footer.setUserInputText(r),this.settings.enableSpeechAutoSend?setTimeout((function(){var t=(0,a.createUserTextMessage)(i.footer.getUserInputText(),e.requestId);i.sendMessage(t),i.footer.setVoiceRecording(!1),i.footer.setUserInputText("")}),this.FINAL_RESULT_DISPLAY_TIMEOUT):this.speechFinalResult={speechId:e.requestId,text:r.toLowerCase()}):this.footer.setUserInputText(""):this._showBanner((null===(n=e.resultCode)||void 0===n?void 0:n.message)===A.SpeechRecognitionService.ERROR_MESSAGE.TOO_MUCH_SPEECH_TIMEOUT?this._localeText.errorSpeechTooMuchTimeout:this._localeText.noSpeechTimeout);break;case A.IVoiceRecognitionEvent.PARTIAL_RESULT:var r;(null===(o=null==e?void 0:e.nbest)||void 0===o?void 0:o.length)>0&&(r=e.nbest[0].utterance).length>0&&this.footer.setUserInputText(r)}},t.prototype.onSpeechNetworkChange=function(e){this.footer.setVoiceRecording(e===l.CONNECTION_STATE.OPEN)},t.prototype._onLoadPreviousMessages=function(){var e=this.settings.disablePastActions,t=this._skillMessages;"all"===e?t.forEach((function(e){return e.disableActions()})):t.forEach((function(e){return e.disablePostbacks()}))},t.prototype._onReceiveMessage=function(e){("none"===this.settings.disablePastActions?this._skillMessages:this._latestSkillMessages).push(e)},t.prototype._onSendMessage=function(){switch(this.settings.disablePastActions){case"all":this._latestSkillMessages.forEach((function(e){return e.disableActions()}));break;case"postback":this._latestSkillMessages.forEach((function(e){return e.disablePostbacks()}))}this._latestSkillMessages=[]},t.prototype._onConnection=function(){("none"===this.settings.disablePastActions?this._skillMessages:this._latestSkillMessages).forEach((function(e){return e.enablePostbacks()}))},t.prototype._onDisconnection=function(){("none"===this.settings.disablePastActions?this._skillMessages:this._latestSkillMessages).forEach((function(e){return e.disablePostbacks()}))},t.prototype._markAsRead=function(e){this.dataService.markAsRead(e)},t.prototype.clearChatPane=function(){var e,t=!1;for((null===(e=this.typingIndicator)||void 0===e?void 0:e.isVisible())&&(t=!0,this.hideTypingIndicator());this._conversationContainer.firstChild;)this._conversationContainer.removeChild(this._conversationContainer.lastChild);t&&this.showTypingIndicator(),this.renderMessagesAndScroll([],{}),this.isFirstMessage=!0,this._ttsCancel(),this._eventDispatcher.trigger(O.ChatEvent.CLICK_ERASE)},t.prototype.initBroadcaster=function(){var e=this.settings,t=e.userId,n=e.channelId;W&&(this.broadcaster=new W("".concat(t,"-").concat(n)),this.broadcaster.onmessage=this.onBroadcastMessage.bind(this))},t.prototype.stopBroadcaster=function(){this.broadcaster&&(this.broadcaster.close(),this.broadcaster=null)},t.prototype.broadcast=function(e){if(this.broadcaster){var t={type:"message",message:e};if(j(e)){var n=(0,V.getMessageDigest)(e);if(this.messageIDs.indexOf(n)>=0)return;t.digest=n}this.broadcaster.postMessage(t)}},t.prototype.broadcastAction=function(e){this.broadcaster&&this.broadcaster.postMessage(e)},t.prototype.onBroadcastMessage=function(e){var t=e.data;switch(t.type){case"message":if(t.message.messagePayload.type===f.PAYLOAD_TYPE.SESSION_CLOSED)return void this.handleSessionEnd();if(t.digest){if(this.messageIDs.indexOf(t.digest)>=0)return;this._onOriginalMessageReceived(t.message)}else this._onFinalMessageSent(t.message),this._onSendMessage(),this.showTypingIndicator();this.hideTypingIndicator(),this.renderMessagesAndScroll([t.message],{});break;case"actionClearHistory":this.clearChatPane();break;case"actionLanguage":this.multiLangChat.setTag(t.tag,!1)}},t.prototype._showBanner=function(e){(0,I.addChild)(this.chatPane.element,(0,I.getBanner)({text:e,closeText:this._localeText.webViewErrorInfoDismiss,closeIcon:this.settings.icons.close}))},t.prototype._hideBanner=function(){document.querySelectorAll(".".concat(u.SDK_NAME,"-prompt-banner-close-button")).forEach((function(e){return e.click()}))},t.prototype._onMessageReceived=function(e,t){this._logger.debug("onMessageReceived",e),this.hideTypingIndicator(),this._scrollToBottom(),e&&(this.broadcast(e),e.messagePayload.type===f.PAYLOAD_TYPE.SESSION_CLOSED?this.handleSessionEnd():(this.renderMessagesAndScroll([e],{attachmentDivId:t}),j(e)&&this._ttsSpeak((0,F.getUtteranceText)(e,this._localeText))))},t.prototype._onOriginalMessageReceived=function(e){this.receiveMessage(e)},t.prototype._onFinalMessageSent=function(e){this.sentMessage(e)},t.prototype._toggleNarration=function(e){e||this._ttsCancel(),this.isTTSMute=!e},t.prototype._onSuggestionsReceived=function(e){var t;(null===(t=null==e?void 0:e.suggestions)||void 0===t?void 0:t.length)?(this._suggestionsResolve&&this._suggestionsResolve(e.suggestions),null!=this.footer&&this.footer.displaySuggestions(e.suggestions)):this._suggestionsResolve&&this._suggestionsResolve([])},t.prototype._sendMessageToServer=function(e,t){this._scrollToBottom(),this._ttsCancel();var n=this.dataService.send(e,null,null,t);return this.footer.focusTextArea(),this.footer.getSuggestionsValid(),n?(this._onSendMessage(),this.showTypingIndicator()):this.hideTypingIndicator(),n},t.prototype._updateUnreadMessages=function(){var e=this;if(this.isOpen){var t=[];this._unreadMessages.forEach((function(n){e._markMessageAsReadIfVisible(n)||t.push(n)})),this._unreadMessages=t}},t.prototype._markMessageAsReadIfVisible=function(e){var t=!1;return this.isOpen&&h.utils.isDivVisible(this.chatPane.element,e.element)&&(e.component.updateMarkAsRead(),t=!0),t},t.prototype._loadPreviousConversations=function(){var e=this;if(this.settings.enableLocalConversationHistory){var t=this.dataService.loadChat();t.length&&(this._isNewMessage=!1,this.renderMessagesAndScroll(t.slice(),{}).then((function(){if(e._isNewMessage=!0,e._onLoadPreviousMessages(),e.relativeTimestamp&&(e.relativeTimestamp.setRelativeTime(new Date(t[t.length-1].date)),e.relativeTimestampElement=e.relativeTimestamp.render(),e._appendMessageToConversation(e.relativeTimestampElement)),e.settings.showPrevConvStatus){e._appendMessageToConversation(new E.StatusComponent(e._localeText.previousChats).render());var n=(0,I.createElement)("hr",["hr"]);e._appendMessageToConversation(n)}})))}},t.prototype._sendInitMessages=function(){var e,t;if(!this.isInitMessageSent&&this.isExpanded&&this.isFirstConnectionOpen){var n=this.settings.initUserProfile;if(n)if((0,P.isProfileMessage)(n)&&!(0,P.isMessage)(n)){var o={profile:n.profile};this.dataService.send(o,null,null,{delegate:!1})}else this._logger.error('The object passed in "initUserProfile" setting must only contain the "profile" object.');if(this.settings.initUserHiddenMessage){var i=this.settings.initUserHiddenMessage,r=void 0;"string"==typeof i?r=(0,a.createUserTextMessage)(i):((0,f.isIMessagePayload)(i)&&(i.type===f.PAYLOAD_TYPE.TEXT||i.type===f.PAYLOAD_TYPE.LOCATION)||(0,P.isMessage)(i)&&((null===(e=i.messagePayload)||void 0===e?void 0:e.type)===f.PAYLOAD_TYPE.TEXT||(null===(t=i.messagePayload)||void 0===t?void 0:t.type)===f.PAYLOAD_TYPE.LOCATION))&&(r=(0,a.createUserMessage)(i,this.settings.userId,new Date,!0)),r&&this._sendMessageToServer(r,{hidden:!0})}this.isInitMessageSent=!0}},t.prototype._ttsSpeak=function(e){this.ttsService&&!this.isTTSMute&&this.ttsService.speak(e)},t.prototype._ttsCancel=function(){this.ttsService&&this.ttsService.cancel()},t.CHAT_MESSAGES_PARENT_ID="chat_widget_main",t}(y.Component);t.WidgetComponent=G},4230:function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.ChatFooterComponent=void 0;var r,s,a,c=n(7496),l=n(4534),u=n(1489),d=n(1389),h=n(5949),p=n(2365),g=n(1001),f=u.createDiv,m=u.createElement,v=u.getPrefixCSSClass,b=u.removeCSSClass,_=u.addCSSClass;!function(e){e.ARROW_DOWN="ArrowDown",e.ARROW_UP="ArrowUp",e.BACKSPACE="Backspace",e.END="End",e.ENTER="Enter",e.ESCAPE="Escape",e.HOME="Home",e.PAGEUP="PageUp",e.PAGEDOWN="PageDown",e.SPACE=" ",e.SPACE_BAR="Spacebar",e.TAB="Tab"}(r||(r={})),function(e){e.ARROW_DOWN="ArrowDown",e.ARROW_UP="ArrowUp",e.ENTER="Enter"}(s||(s={})),function(e){e[e.KEYBOARD=0]="KEYBOARD",e[e.VOICE=1]="VOICE"}(a||(a={}));var y={AUDIO:".aac, .amr, .m4a, .mp3, .mp4a, .mpga, .oga, .ogg, .wav, audio/*",FILE:".7z, .csv, .doc, .docx, .eml, .ics, .key, .log, .msg, .neon, .numbers, .odt, .pages, .pdf, .pps, .ppsx, .ppt, .pptx, .rtf, .txt, .vcf, .xls, .xlsx, .xml, .yml, .yaml, application/msword, application/vnd.openxmlformats-officedocument.wordprocessingml.document",IMAGE:".gif, .jfif, .jpeg, .jpg, .png, .svg, .tif, .tiff, .webp, image/*",VIDEO:".3g2, .3gp, .avi, .m4v, .mov, .mp4, .mpeg, .mpg, .ogv, .qt, .webm, .wmv, video/*",ALL:""};y.ALL="".concat(y.AUDIO,",").concat(y.FILE,",").concat(y.IMAGE,",").concat(y.VIDEO);var T="".concat(l.SDK_NAME,"-share-button"),C="aria-expanded",S="aria-activedescendant",w="".concat(l.SDK_NAME,"-share-popup-expand"),E=function(e){function t(t,n,o,i,r,s,c){var u=e.call(this)||this;return u.onSend=t,u.onUpload=n,u.settings=o,u.onQueryChange=i,u.onSpeechToggle=r,u.onShareLocation=s,u.eventDispatcher=c,u.mode=void 0,u.fileMaxSize=l.ATTACHMENT_MAX_SIZE,u._shareMenuItems=[],u._navKeys=[],u.isDisabledVoiceButtonLang=!1,u.isDisabledVoiceButtonNetwork=!1,u.modeSwitchPreservedText="",u.recognitionRequested=!1,u.isFocusableDevice=!0,u.isTyping=!1,u.i18n=o.i18n,u.icons=o.icons,u.locale=u.i18n[o.locale],u.isFocusableDevice=!(0,h.isMobile)(),u.element=u._createElement(),u.setInputMode(a.KEYBOARD),u.disable(!0),u}return i(t,e),t.prototype.setInputMode=function(e){e!==this.mode&&(this.settings.enableSpeech?(this.mode=e,this.mode===a.KEYBOARD?this._showKeyboardMode():this._showVoiceMode()):(this.mode=a.KEYBOARD,this._showKeyboardMode()))},t.prototype.setUserInputText=function(e,t){void 0===t&&(t=!1),this.mode===a.KEYBOARD?this._textArea&&(this._textArea.value=e,this._textArea.setSelectionRange(e.length,e.length),this.focusTextArea(),this.updateSendButtonDisabledState()):t||(this._recognitionTextView.value=this.modeSwitchPreservedText+e,this._recognitionTextView.setSelectionRange(e.length,e.length),this._recognitionTextView.scrollLeft=this._recognitionTextView.scrollWidth)},t.prototype.getUserInputText=function(){return this.mode===a.KEYBOARD?this._textArea.value:this._recognitionTextView.value},t.prototype.setUserInputPlaceholder=function(e){this._textArea&&k(this._textArea,e)},t.prototype.setVoiceRecording=function(e){this.settings.enableSpeech&&(e&&this.recognitionRequested?this.setInputMode(a.VOICE):e||this.setInputMode(a.KEYBOARD))},t.prototype.updateVisualizer=function(e){this.mode===a.VOICE&&this._drawVisualizer(e)},t.prototype.focusTextArea=function(){this.isFocusableDevice&&this._textArea.focus(),this._textArea.scrollTop=this._textArea.scrollHeight},t.prototype.render=function(e){},t.prototype.disable=function(e){void 0===e&&(e=!0),this.settings.enableAttachment&&(this._popupClose(),this._shareButton.disabled=e),e?(_(this._textArea,v("disabled")),this.settings.enableAutocomplete&&(this._invalidateSuggestions(),this._removeSuggestionsPopup()),this._sendButton.disabled=e):(b(this._textArea,v("disabled")),this.updateSendButtonDisabledState()),this.settings.enableSpeech&&(this.setInputMode(a.KEYBOARD),this.disableVoiceModeButton(e,{src:"network"})),this.isFooterDisabled=e},t.prototype.isDisabled=function(){return this.isFooterDisabled},t.prototype.disableVoiceModeButton=function(e,t){var n=t.src;if(this.settings.enableSpeech){switch(n){case"lang":this.isDisabledVoiceButtonLang=e;break;case"network":this.isDisabledVoiceButtonNetwork=e}this.settings.multiLangChat&&(this.isDisabledVoiceButtonLang||this.isDisabledVoiceButtonNetwork)?this._switchToVoiceModeButton.disabled=!0:this._switchToVoiceModeButton.disabled=this.isDisabledVoiceButtonNetwork}},t.prototype.displaySuggestions=function(e){if(this._removeSuggestionsPopup(),0===e.length)this._suggestions=e,this._isSuggestionsValid=!1;else if(this._textArea.value){this._currentSuggestionFocus=e.length>l.Constants.MAX_SUGGESTIONS_COUNT?l.Constants.MAX_SUGGESTIONS_COUNT:e.length<l.Constants.MIN_SUGGESTIONS_COUNT?l.Constants.MIN_SUGGESTIONS_COUNT:e.length,this._suggestions=e,this._isSuggestionsValid=!0;var n=f(this.settings.enableAttachment?["autocomplete-items"]:["autocomplete-items","no-attach"]);n.setAttribute("role","list");var o=this._textArea.value.trim();n.id=t.SUGGESTIONS_ID;for(var i=this._currentSuggestionFocus-1;i>-1;i--){var r=this._createSuggestionListItem(e[i],o);n.appendChild(r)}this.element.appendChild(n)}},t.prototype.getSuggestions=function(){return this._suggestions},t.prototype.getSuggestionsValid=function(){return this._isSuggestionsValid},t.prototype.setLocale=function(e){if(this.locale=e,this._shareButton){var t=e.upload;O(this._uploadFileInput,t),this._sharePopup.firstElementChild.remove(),this._sharePopup.appendChild(this._getShareMenu())}this.setUserInputPlaceholder(e.inputPlaceholder),this._sendButton&&M(this._sendButton,e.send),this._switchToVoiceModeButton&&M(this._switchToVoiceModeButton,e.speak),this._recognitionTextView&&I(this._recognitionTextView,e.recognitionTextPlaceholder)},t.prototype._createElement=function(){return f(["footer"])},t.prototype._showKeyboardMode=function(){var e;if(b(this.element,v("mode-voice")),_(this.element,v("mode-keyboard")),this.keyboardComponent||(this.keyboardComponent=this._createKeyboardComponent(),this.element.appendChild(this.keyboardComponent)),this._recognitionTextView){var t=this._recognitionTextView.value.toString();this._textArea.value=t,this.modeSwitchPreservedText="",this._recognitionTextView.value=""}this.updateSendButtonDisabledState(),this.settings.enableAutocomplete&&(null===(e=this._textArea.value)||void 0===e?void 0:e.trim().length)>=3&&this._setSuggestionsRequestTimer()},t.prototype._showVoiceMode=function(){var e,t;if(b(this.element,v("mode-keyboard")),_(this.element,v("mode-voice")),this.voiceComponent||(this.voiceComponent=this._createVoiceComponent(),this.element.appendChild(this.voiceComponent)),this._textArea){var n=null!==(t=null===(e=this._textArea.value)||void 0===e?void 0:e.trim().toString())&&void 0!==t?t:"";this.modeSwitchPreservedText=n?n+" ":"",this._recognitionTextView.value=this.modeSwitchPreservedText,this._removeSuggestionsPopup(),this._textArea.value=""}},t.prototype._createKeyboardComponent=function(){var e=f(["footer-mode-keyboard"]);if(this.settings.enableAttachment){var t=this._createShareComponent();e.appendChild(t)}this._textArea=this._createInputTextArea(),e.appendChild(this._textArea);var n=this._createSendMessageButton();return this._sendButton=n,e.appendChild(n),this.settings.enableSpeech&&(this._switchToVoiceModeButton=this._createVoiceSwitchButton(),e.appendChild(this._switchToVoiceModeButton)),e},t.prototype._createShareComponent=function(){var e=this,t=f(),n=x({css:["button-upload"],customIcon:this.icons.shareMenu,defaultIcon:d.iconAttach,title:this.locale.upload});n.id=T,n.setAttribute("role","button"),n.setAttribute("aria-haspopup","true"),this._shareButton=n;var o=m("input",["none"]);o.type="file",o.tabIndex=-1,o.setAttribute("aria-hidden","true"),O(o,this.locale.upload),this._uploadFileInput=o;var i=f(["share-popup"]),s=this._getShareMenu();return i.appendChild(s),this._sharePopup=i,n.setAttribute("aria-controls",s.id),document.addEventListener("deviceready",(function(){var t=globalThis?globalThis.device:window?window.device:void 0;"Android"===(null==t?void 0:t.platform)&&e._uploadFileInput.removeAttribute("accept")}),!1),(0,u.on)(n,"click",(function(t){e._removeSuggestionsPopup(),n.hasAttribute(C)?e._popupClose():(e._popupOpen(),e._popupFocusFirstItem())})),(0,u.on)(n,"keydown",(function(t){var n=!1;switch(t.key){case r.ENTER:case r.ARROW_DOWN:case r.SPACE:case r.SPACE_BAR:e._popupOpen(),e._popupFocusFirstItem(),n=!0;break;case r.ARROW_UP:e._popupOpen(),e._popupFocusLastItem(),n=!0}n&&(t.stopPropagation(),t.preventDefault())})),(0,u.on)(o,"click",(function(){return o.value=null})),(0,u.on)(o,"change",(function(t){var n=t.target;n.files&&n.files.length&&e._onUpload(n.files[0])})),t.appendChild(n),t.appendChild(i),t.appendChild(o),t},t.prototype._getShareMenu=function(){var e=this,t=m("ul",["share-popup-list"]);return t.id="".concat(l.SDK_NAME,"-share-menu"),t.tabIndex=-1,t.setAttribute("role","menu"),t.setAttribute("aria-labelledby",T),this._getShareItems().forEach((function(e){return t.appendChild(e)})),(0,u.on)(t,"click",(function(){return e._popupClose()})),(0,u.on)(t,"keydown",(function(t){var n=!1;if(!(t.ctrlKey||t.altKey||t.metaKey)){if(t.shiftKey&&t.key===r.TAB)e._popupClose();else switch(t.key){case r.ENTER:case r.SPACE:case r.SPACE_BAR:t.target.click(),n=!0;break;case r.ESCAPE:case r.TAB:e._popupClose(),t.key===r.ESCAPE&&(n=!0);break;case r.ARROW_UP:e._popupFocusPreviousItem(),n=!0;break;case r.ARROW_DOWN:e._popupFocusNextItem(),n=!0;break;case r.HOME:case r.PAGEUP:e._popupFocusFirstItem(),n=!0;break;case r.END:case r.PAGEDOWN:e._popupFocusLastItem(),n=!0}n&&(t.stopPropagation(),t.preventDefault())}})),this._sharePopupMenu=t,t},t.prototype._getShareItems=function(){var e=this,t=this.icons,n=this.locale,o=this._uploadFileInput,i="".concat(l.SDK_NAME,"-share-"),r=this.settings.shareMenuItems,s=[],a=new Set;if((null==r?void 0:r.length)||(r=[g.ShareCategory.AUDIO,g.ShareCategory.FILE,g.ShareCategory.LOCATION,g.ShareCategory.VISUAL]),r.forEach((function(e){"string"==typeof e&&a.add(e.toLowerCase())})),a.has(g.ShareCategory.VISUAL)){var c="".concat(i,"visual"),u=t.shareMenuVisual||d.iconShareMedia;s.push(A(c,n.shareVisual,u,(function(){o.accept="".concat(y.IMAGE,",").concat(y.VIDEO),o.click()})))}a.has(g.ShareCategory.AUDIO)&&(c="".concat(i,"audio"),u=t.shareMenuAudio||d.iconShareAudio,s.push(A(c,n.shareAudio,u,(function(){o.accept=y.AUDIO,o.click()})))),a.has(g.ShareCategory.FILE)&&(c="".concat(i,"file"),u=t.shareMenuFile||d.iconShareFile,s.push(A(c,n.shareFile,u,(function(){o.accept=y.FILE,o.click()})))),a.has(g.ShareCategory.LOCATION)&&(c="".concat(i,"location"),u=t.shareMenuLocation||d.iconShareLocation,s.push(A(c,n.shareLocation,u,(function(){return e.onShareLocation()}))));var h=t.shareMenuFile||d.iconShareFile;return this.settings.shareMenuItems.filter((function(e){return"string"!=typeof e&&"string"==typeof e.type})).forEach((function(t){var i=t.type.toLowerCase(),r="share_".concat(i.indexOf("*")>=0?"all":i.replace(/ /g,"_")),a="".concat(l.SDK_NAME,"-").concat(r),c=n[r]||t.label,u=t.icon||h,d=t.maxSize&&t.maxSize>=1?Math.min(t.maxSize*l.BYTE_MULTIPLIER,l.ATTACHMENT_MAX_SIZE):l.ATTACHMENT_MAX_SIZE,p=i.indexOf("*")>=0?y.ALL:i.split(" ").filter((function(e){return y.ALL.indexOf(e)>=0})).map((function(e){return".".concat(e," ")})).join(",");s.push(A(a,c,u,(function(){e.fileMaxSize=d,o.accept=p,o.click()})))})),this._shareMenuItems=s.map((function(e){return e.id})),s},t.prototype._popupOpen=function(){var e=this;this._shareButton.getAttribute(C)||(_(this._sharePopup,w),this._shareButton.setAttribute(C,"true"),setTimeout((function(){document.addEventListener("click",(function(){e._popupClose()}),{once:!0})})))},t.prototype._popupClose=function(){this._shareButton.getAttribute(C)&&(b(this._sharePopup,w),this._shareButton.removeAttribute(C))},t.prototype._popupFocusFirstItem=function(){this._popupFocusItem(this._shareMenuItems[0])},t.prototype._popupFocusLastItem=function(){this._popupFocusItem(this._shareMenuItems[this._shareMenuItems.length-1])},t.prototype._popupFocusPreviousItem=function(){var e=this._sharePopupMenu.getAttribute(S),t=this._shareMenuItems.indexOf(e)-1,n=this._shareMenuItems[t<0?this._shareMenuItems.length-1:t];this._popupFocusItem(n)},t.prototype._popupFocusNextItem=function(){var e=this._sharePopupMenu.getAttribute(S),t=this._shareMenuItems[(this._shareMenuItems.indexOf(e)+1)%this._shareMenuItems.length];this._popupFocusItem(t)},t.prototype._popupFocusItem=function(e){document.getElementById(e).focus(),this._sharePopupMenu.setAttribute(S,e)},t.prototype._createInputTextArea=function(){var e=this,t=["user-input"];this.settings.enableSpeech&&t.push("user-input-inline-send");var n=m("textarea",t);return I(n,this.locale.inputPlaceholder),n.rows=1,n.onkeydown=this.onInputKeyDown.bind(this),n.onkeyup=this.onInputKeyUp.bind(this),n.oninput=this._expand.bind(this),(0,u.on)(n,"paste",(function(){setTimeout(e.updateSendButtonDisabledState.bind(e))})),this._handleInputChange(n),n},t.prototype._handleInputChange=function(e){var t=this,n=Object.getOwnPropertyDescriptor(HTMLTextAreaElement.prototype,"value");Object.defineProperty(e,"value",{set:function(o){n.set.call(e,o),t.updateSendButtonDisabledState(),t._expand()},get:n.get})},t.prototype._createSendMessageButton=function(){var e=this,t=["button-send"];this.settings.enableSpeech&&t.push("button-send-inline");var n=x({css:t,customIcon:this.icons.send,defaultIcon:d.iconSend,title:this.locale.send});return n.onclick=function(){var t,o;e._isUserInputEmpty()||(e._previousInputValue=void 0,e._textArea.value=null===(o=null===(t=e._textArea)||void 0===t?void 0:t.value.trim())||void 0===o?void 0:o.replace("\n",""),e.settings.enableAutocomplete&&(e._invalidateSuggestions(),e._removeSuggestionsPopup()),e._onSend(),n.disabled=!0)},n},t.prototype._createVoiceSwitchButton=function(){var e=this,t=x({css:["button-switch-voice"],customIcon:this.icons.mic,defaultIcon:d.iconMic,title:this.locale.speak});return t.onclick=function(){e.onSpeechToggle(!0),e.recognitionRequested=!0},t},t.prototype._createVoiceComponent=function(){var e=f(["footer-mode-voice"]),t=f(["footer-visualizer-wrapper"]),n=f(["footer-recognition-wrapper"]);if(this._visualizerCanvas=m("canvas"),this._visualizerCanvas.width=244,this._visualizerCanvas.height=32,t.appendChild(this._visualizerCanvas),this._recognitionTextView=this._createRecognitionTextView(),n.appendChild(this._recognitionTextView),this.settings.enableSpeech){var o=this._createKeyboardSwitchButton();n.appendChild(o)}return e.appendChild(t),e.appendChild(n),e},t.prototype._createRecognitionTextView=function(){var e=m("input",["recognition-text-view"]);return e.readOnly=!0,e.type="text",I(e,this.locale.recognitionTextPlaceholder),e},t.prototype._createKeyboardSwitchButton=function(){var e=this,t=x({css:["button-switch-kbd"],customIcon:this.icons.keyboard,defaultIcon:d.iconKeyboard,title:this.locale.inputPlaceholder});return t.onclick=function(){e.recognitionRequested=!1,e.onSpeechToggle(!1)},t},t.prototype.updateSendButtonDisabledState=function(){this._sendButton&&(this._sendButton.disabled=!(this._textArea&&this._textArea.value&&this._textArea.value.trim().length))},t.prototype._drawVisualizer=function(e){var t=this._visualizerCanvas.height,n=this._visualizerCanvas.width,o=Math.floor(t/2);e=this._getGroupedFrequencyValues(e,31),e=this._getScaledFrequencyValues(e,t/255);var i=this._visualizerCanvas.getContext("2d");i.fillStyle=this.settings.colors.visualizer,i.clearRect(0,0,n,t),i.save();var r=0;e.forEach((function(e){var t=Math.ceil(e/2)+1;i.fillRect(r,o-t,4,2*t),r+=8})),i.save()},t.prototype._getGroupedFrequencyValues=function(e,t){for(var n=Math.ceil(t/2),o=e.length/n,i=[],r=[],s=0;s<e.length;s+=o){var a=e.slice(s,s+o).reduce((function(e,t){return e+t}),0);i.push(a/o),r.unshift(a/o)}return i.splice(0,1),r.concat(i)},t.prototype._getScaledFrequencyValues=function(e,t){return e.map((function(e){return e*t}))},t.prototype._isUserInputEmpty=function(){return!this._textArea||0===this._textArea.value.trim().length},t.prototype.onInputKeyDown=function(e){var t;this.isDisabled()||e.isComposing||229===e.keyCode||e.key===r.ENTER&&!e.shiftKey&&(null===(t=this._textArea.value)||void 0===t?void 0:t.trim().length)>0&&(e.preventDefault(),this._sendButton.click())},t.prototype.onInputKeyUp=function(e){var t,n=this;if(this.isDisabled())return this._invalidateSuggestions(),void this._removeSuggestionsPopup();this.isTyping||(this.isTyping=!0,this.eventDispatcher.trigger(c.ChatEvent.TYPING,this.isTyping)),clearTimeout(this.typingTimer),this.typingTimer=window.setTimeout((function(){n.isTyping=!1,n.eventDispatcher.trigger(c.ChatEvent.TYPING,n.isTyping)}),1e3);var o=null===(t=this._textArea.value)||void 0===t?void 0:t.trim();if(this.updateSendButtonDisabledState(),!e.isComposing&&this.settings.enableAutocomplete){if(this._onNavigateSuggestion(e))return;e.key===r.BACKSPACE&&(this._previousInputValue=void 0,this._invalidateSuggestions(),this._removeSuggestionsPopup(),clearTimeout(this._suggestionsRequest)),this._getNavKeys().indexOf(e.key)<0&&(o.length>=3?this._previousInputValue!==this._textArea.value&&(this._previousInputValue=this._textArea.value,clearTimeout(this._suggestionsRequest),this._setSuggestionsRequestTimer()):(this._previousInputValue=void 0,this._removeSuggestionsPopup(),clearTimeout(this._suggestionsRequest)))}},t.prototype._expand=function(){this._textArea.style.height=null;var e=this._textArea.scrollHeight;this._textArea.style.height=e+"px"},t.prototype._onNavigateSuggestion=function(e){var n=!1,o=document.getElementById(t.SUGGESTIONS_ID);if(o){var i=o.getElementsByTagName("div");e.key===r.ARROW_DOWN?(e.preventDefault(),this._currentSuggestionFocus<i.length-1?(this._currentSuggestionFocus++,this._addActive(i)):(this._removeActive(i),this._textArea.value=this._currentInputValue?this._currentInputValue:this._textArea.value,this._currentSuggestionFocus=i.length),n=!0):e.key===r.ARROW_UP&&(e.preventDefault(),this._currentSuggestionFocus===i.length&&(this._currentInputValue=this._textArea.value),this._currentSuggestionFocus>0&&this._currentSuggestionFocus--,this._addActive(i),n=!0)}return n},t.prototype._addActive=function(e){e&&(this._removeActive(e),_(e[this._currentSuggestionFocus],v("autocomplete-active")),e[this._currentSuggestionFocus].scrollIntoView(),this._textArea.value=e[this._currentSuggestionFocus].innerText)},t.prototype._removeActive=function(e){for(var t=0,n=e;t<n.length;t++){var o=n[t];b(o,v("autocomplete-active"))}},t.prototype._removeSuggestionsPopup=function(){var e=document.getElementById(t.SUGGESTIONS_ID);e&&e.remove()},t.prototype._onSend=function(){this.onSend(this._textArea.value),this._textArea.value="",this._textArea.innerText="",setTimeout(this._expand.bind(this))},t.prototype._onUpload=function(e){var t=this.fileMaxSize;this.fileMaxSize=l.ATTACHMENT_MAX_SIZE,this.onUpload(e,{maxSize:t}),this._uploadFileInput.value=""},t.prototype._onQueryChange=function(){this.onQueryChange(this._textArea.value.trim()).catch((function(){}))},t.prototype._setSuggestionsRequestTimer=function(){var e=this;this._suggestionsRequest=setTimeout((function(){e._onQueryChange()}),300)},t.prototype._invalidateSuggestions=function(){this._suggestions=null,this._isSuggestionsValid=!1},t.prototype._getNavKeys=function(){if(!this._navKeys.length)for(var e=0,t=Object.keys(s);e<t.length;e++){var n=t[e];this._navKeys.push(s[n])}return this._navKeys},t.prototype._createSuggestionListItem=function(e,t){var n=this,o=f();o.setAttribute("role","listitem"),o.onclick=function(){n._textArea.value=o.innerText,n._removeSuggestionsPopup(),n._sendButton.click()};var i=new RegExp(t,"i"),r=e.match(i);if(r){if(0!==r.index){var s=m("span");s.textContent=e.substr(0,r.index),o.appendChild(s)}var a=m("strong");if(a.textContent=e.substr(r.index,t.length),o.appendChild(a),r.index+t.length!==e.length){var c=m("span");c.textContent=e.substring(r.index+t.length),o.appendChild(c)}}else o.textContent=e;return o},t.SUGGESTIONS_ID="chat_widget_suggestions",t}(p.Component);function x(e){var t=e.css,n=e.customIcon,o=e.defaultIcon,i=e.title,r="footer-button",s=n||o,a=[(0,h.isSVG)(s)?"".concat(r,"-svg-icon"):"".concat(r,"-icon")];return(0,u.createIconButton)({css:[r].concat(t),icon:s,iconCss:a,title:i})}function A(e,t,n,o){var i="share-popup-item",r=(0,u.createImageIcon)({icon:n,iconCss:["".concat(i,"-icon")],title:t}),s=m("span",["".concat(i,"-text")]);s.innerText=t;var a=m("li",[i]);return a.id=e,a.tabIndex=-1,a.setAttribute("dir","auto"),a.setAttribute("role","menuitem"),a.appendChild(r),a.appendChild(s),(0,u.on)(a,"click",o),a}function O(e,t){M(e,t),P(e,t)}function I(e,t){k(e,t),P(e,t)}function M(e,t){e.title=t}function k(e,t){e.placeholder=t}function P(e,t){e.setAttribute("aria-label",t)}t.ChatFooterComponent=E},8414:function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.ChatHeaderComponent=void 0;var r=n(5949),s=n(2365),a=n(7632),c=n(1389),l=n(8798),u=n(466),d=n(1489),h=d.addCSSClass,p=d.createDiv,g=d.getPrefixCSSClass,f=d.removeCSSClass,m=function(e){function t(t,n,o,i,r,s){var a=e.call(this)||this;return a.settings=t,a.onClose=n,a.onClearMessage=o,a.onAudioToggle=i,a.chatService=r,a.onEndConversation=s,a.logger=new l.Logger("ChatHeaderComponent"),a.i18n=a.settings.i18n,a.element=a._createElement(),a.settings.showConnectionStatus&&a.chatService.on(u.ChatServerEvent.STATUS,a.updateStatusMessage.bind(a)),a.disable(!0),a}return i(t,e),t.prototype.render=function(e){},t.prototype.addLanguageSelect=function(e){this.languageSelect?this.languageSelect=e:(this.languageSelect=e,this.actionsContainer.prepend(this.languageSelect))},t.prototype.closeWidgetPopup=function(){this.onClose()},t.prototype.clearHistory=function(){this.onClearMessage()},t.prototype.showTTSButton=function(e){var t=this.audioButton;t&&(t.style.display=e?"flex":"none")},t.prototype.disableTTSButton=function(e){this.audioButton&&(this.audioButton.disabled=e)},t.prototype.setLocale=function(e){this.currentTranslations=e;var t=e.chatTitle;t&&(this.title.innerText=this.title.title=t,this.logo&&(this.logo.title=t));var n=e.chatSubtitle;if(n?this.subtitle.innerText=this.subtitle.title=n:this.settings.showConnectionStatus&&this.updateStatusMessage(this.chatStatus),this.clearButton){var o=e.clear;this.clearButton.title=o}if(this.audioButton){var i=this._audioButtonOn?e.audioResponseOn:e.audioResponseOff;this.audioButton.title=i}if(this.closeButton){var r=e.close;this.closeButton.title=r}},t.prototype._createElement=function(){var e=this.settings,t=e.icons,n=p(["header"]),o=p(["header-info-wrapper"]),i=p(["header-actions"]),s=e.locale,a=this.i18n[s],l=a.chatTitle,u=a.chatSubtitle;if(!("logo"in t)||t.logo){var h=(0,d.createImageIcon)({icon:t.logo||c.iconLogo,iconCss:["logo"],title:l});n.appendChild(h),this.logo=h}if(l){var g=p(["title"]);g.id="oda-chat-title",g.innerText=l,g.title=l,o.appendChild(g),this.title=g}if(u){var f=p(["subtitle"]);f.innerText=u,f.title=u,o.appendChild(f),e.showConnectionStatus=!1,this.subtitle=f}else e.showConnectionStatus&&(this.networkStatus=p(["connection-status","disconnected"]),this.networkStatus.innerText=a.connecting,this.networkStatus.title=this.networkStatus.innerText,o.appendChild(this.networkStatus));n.appendChild(o);var m=p(["header-gap"]);if(n.appendChild(m),e.customHeaderElementId){var v=document.getElementById(e.customHeaderElementId);if(v){var b=p(["header-custom-element"]);b.appendChild(v),n.appendChild(b)}else this.logger.error("Could not find element with ID '".concat(e.customHeaderElementId,"'. No custom element added to the chat header."))}var _="header-button";if(e.enableClearMessage){var y=t.clearHistory||c.iconClearHistory,T=(0,d.createIconButton)({css:[_,"button-clear"],icon:y,iconCss:[(0,r.isSVG)(y)?"header-button-icon":"header-button-img-icon"],title:a.clear});T.onclick=this.clearHistory.bind(this),i.appendChild(T),this.clearButton=T}var C=this.getAudioSwitchButton(a);if(i.appendChild(C),this.audioButton=C,this.showTTSButton(!!e.ttsService),!e.embedded){y=t.collapse||c.iconCollapse;var S=(0,d.createIconButton)({css:[_,"button-close"],icon:y,iconCss:[(0,r.isSVG)(y)?"header-button-icon":"header-button-img-icon"],title:a.close});S.onclick=this.closeWidgetPopup.bind(this),i.appendChild(S),this.closeButton=S}if(e.enableEndConversation){var w=t.close||c.iconClose,E=(0,d.createIconButton)({css:[_,"button-close"],icon:w,iconCss:[(0,r.isSVG)(w)?"header-button-icon":"header-button-img-icon"],title:a.endConversation});E.onclick=this.onEndConversation.bind(this),i.appendChild(E),this.endButton=E}return n.appendChild(i),this.actionsContainer=i,n},t.prototype.getAudioSwitchButton=function(e){var t=this,n=this.settings,o=n.icons;this._audioButtonOn=!n.initBotAudioMuted;var i=(0,d.createButton)(["header-button","button-narration"]),s=function(){var n=t.currentTranslations||e;i.innerHTML="";var s=t._audioButtonOn?n.audioResponseOn:n.audioResponseOff,a=t._audioButtonOn?o.ttsOn||c.iconTTSUnmute:o.ttsOff||c.iconTTSMute,l=(0,d.createImageIcon)({icon:a,iconCss:[(0,r.isSVG)(a)?"header-button-icon":"header-button-img-icon"],title:s});i.appendChild(l),i.title=s};return s(),i.onclick=function(){t._audioButtonOn=!t._audioButtonOn,s(),t.onAudioToggle(t._audioButtonOn)},i},t.prototype.updateStatusMessage=function(e){this.networkStatus.className=g("connection-status"),this.chatStatus=e;var t=this.currentTranslations||this.i18n[this.settings.locale];switch(e){case a.CONNECTION_STATE.OPEN:this.networkStatus.innerText=t.connected,f(this.networkStatus,g("connecting"),g("disconnected")),h(this.networkStatus,g("connected"));break;case a.CONNECTION_STATE.CLOSED:this.networkStatus.innerText=t.disconnected,f(this.networkStatus,g("connecting"),g("connected")),h(this.networkStatus,g("disconnected"));break;case a.CONNECTION_STATE.CLOSING:this.networkStatus.innerText=t.closing,f(this.networkStatus,g("connected"),g("disconnected")),h(this.networkStatus,g("connecting"));break;case a.CONNECTION_STATE.CONNECTING:this.networkStatus.innerText=t.connecting,f(this.networkStatus,g("connected"),g("disconnected")),h(this.networkStatus,g("connecting"))}this.networkStatus.title=this.networkStatus.innerText},t.prototype.disable=function(e){void 0===e&&(e=!0),this.settings.enableEndConversation&&(this.endButton.disabled=e)},t}(s.Component);t.ChatHeaderComponent=m},3777:function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.WidgetMainComponent=void 0;var r=n(1489),s=function(e){function t(){var t=e.call(this)||this;return t.element=t._createElement(),t}return i(t,e),t.prototype.render=function(e){},t.prototype._createElement=function(){return(0,r.createDiv)(["conversation"])},t}(n(2365).Component);t.WidgetMainComponent=s},8861:function(e,t,n){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.MultiLangChatComponent=void 0;var i=n(1001),r=n(7632),s=n(4534),a=n(7496),c=n(5949),l=n(466),u=n(8656),d=n(1489),h=function(){function e(e,t){var n=this;this.langOptions=e,this.config=t,this.isFirstConnection=!0,this.isWidgetOpen=!1,this.isTTSEnabled=!0,this.isVoiceEnabled=!0,this.recognitionLocaleMap={},this.synthesisLocaleVoiceMap={},this.supportedLangList=[];var o=t.settings;this.localizedText=o.i18n[o.locale];var s=e||{},u=s.supportedLangs,d=s.primary;if("string"==typeof d&&(e.primary=d.toLowerCase()),u&&u.length)if(u.forEach((function(e){e.lang=e.lang.toLowerCase(),e.label=e.label||n.localizedText["language_".concat(e.lang)]||e.lang})),u.length>1?(u.unshift({lang:"und",label:this.localizedText.language_detect}),e.primary||(e.primary=null)):e.primary=u[0].lang,this.supportedLangList=u.map((function(e){return e.lang})),t.speechSynthesisService){var h=t.synthesisVoices;if(h&&h.length){var p={};u.forEach((function(e){var t=h.find((function(t){return t.lang.indexOf(e.lang)>=0}));t&&(p[e.lang]=t)})),this.synthesisLocaleVoiceMap=p}}else this.updateSynthesis=function(){};if(t.voiceRecognitionService){var f={};(0,c.getValues)(i.SPEECH_LOCALE).forEach((function(e){f[e.substring(0,2)]=e,f[e]=e})),g(i.SPEECH_LOCALE.EN_GB,f),g(i.SPEECH_LOCALE.EN_AU,f),g(i.SPEECH_LOCALE.EN_IN,f),this.recognitionLocaleMap=f}else this.updateRecognition=function(){};t.chatService.on(l.ChatServerEvent.STATUS,(function(e){e===r.CONNECTION_STATE.OPEN?(n.disableComponent(!1),n.isFirstConnection?n.initLanguage():void 0!==n.currentTag&&n.setTag(n.currentTag)):n.disableComponent(!0)})),o.initMessageOptions&&"expand"!==o.initMessageOptions.sendAt||o.openChatOnLoad||o.embedded?this.isWidgetOpen=!0:t.chatWidget.on(a.ChatEvent.WIDGET_OPENED,(function(){n.isWidgetOpen||(n.isWidgetOpen=!0,t.chatService.isConnectionOpen()&&n.initLanguage())}))}return e.prototype.render=function(){var e=this,t=this.langOptions;if(!(t&&t.supportedLangs&&t.supportedLangs.length>=2))return null;if(!this.component){var n="language-selection",o=(0,d.createElement)("select",[n]);o.setAttribute("aria-label",this.localizedText.languageSelectDropdown),this.disableComponent(!1),t.supportedLangs.forEach((function(e){var t=(0,d.createElement)("option",["".concat(n,"-option")]);t.innerText=e.label,t.value=e.lang,o.appendChild(t)})),o.addEventListener("change",(function(){e.selectLanguage(o.value)})),this.component=o}return this.component},e.prototype.setTag=function(e,t){void 0===t&&(t=!0),null!==e&&(e=e.toLowerCase()),this.supportedLangList.length&&(e=this.supportedLangList.indexOf(e)>=0?e:null),this.selectLanguage(e,t),this.component&&(this.component.value=e||"und")},e.prototype.selectLanguage=function(e,t){void 0===t&&(t=!0),"und"===e&&(e=null),t&&(this.updateProfile(e),this.config.storageService.setItem(p(this.config.settings),e)),this.updateSynthesis(e),this.updateRecognition(e),this.config.chatWidget.onLanguageUpdate(e,t),this.setLocale(e),this.currentTag!==e&&(this.currentTag=e,this.config.eventDispatcher.trigger(a.ChatEvent.CHAT_LANG,e))},e.prototype.updateProfile=function(e){var t=this.config.chatService;if(t.isConnectionOpen()){var n={profile:{languageTag:e}};e||(n.profile.locale=e),t.updateUser(n,{delegate:!1})}},e.prototype.updateSynthesis=function(e){var t=this.config,n=t.speechSynthesisService,o=t.chatWidget;if(e){if(this.isTTSEnabled||(o.enableSpeechSynthesisService(!0),this.isTTSEnabled=!0),n){var i=this.synthesisLocaleVoiceMap[e]||{lang:e};n.setVoice([i])}}else this.isTTSEnabled=!1,n&&n.cancel(),o.enableSpeechSynthesisService(!1)},e.prototype.updateRecognition=function(e){var t=this.config,n=this.recognitionLocaleMap[e],o=t.voiceRecognitionService,i=t.chatWidget;n?(this.isVoiceEnabled||(i.setVoiceRecognitionService(!0),this.isVoiceEnabled=!0),o.isInitialized()&&o.setSpeechLocale(n)):(this.isVoiceEnabled=!1,o.isRecording()&&o.stopRecording(),o.isInitialized()&&o.setSpeechLocale(null),i.setVoiceRecognitionService(!1))},e.prototype.disableComponent=function(e){this.component&&(this.component.disabled=e)},e.prototype.setLocale=function(e){var t=this.component;if(t){var n=o(o({},this.localizedText),this.config.settings.i18n[e]),i=this.langOptions.supportedLangs.map((function(e){return n["language_".concat(e.lang)]||e.label||e.lang}));t.setAttribute("aria-label",n.languageSelectDropdown);for(var r=t.childElementCount,s=0;s<r;s++){var a=t.children[s];a.innerText=0!==s?i[s]:n.language_detect}}},e.prototype.initLanguage=function(){var e=this,t=e.langOptions||{},n=t.supportedLangs,o=t.primary;if(e.isFirstConnection&&e.isWidgetOpen){if(n&&n.length){var i=e.config.storageService.getItem(p(e.config.settings));i&&(o="null"===i?null:i)}void 0!==o&&e.setTag(o),e.isFirstConnection=!1}},e}();function p(e){return"".concat(s.Constants.SDK_NAME,"-").concat(e.channelId,"-").concat(e.userId)}function g(e,t){(0,u.getBrowserLocale)()===e&&(t[e.substring(0,2)]=e)}t.MultiLangChatComponent=h},2365:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Component=void 0;var n=function(){function e(){}return e.prototype.remove=function(){this.element.remove()},e.prototype.appendToElement=function(e){e.appendChild(this.element)},e.prototype.prependToElement=function(e){var t=e.firstChild;t?e.insertBefore(this.element,t):e.appendChild(this.element)},e.prototype.appendContentChildElement=function(e){this._getContentElement().appendChild(e)},e.prototype.appendContentChild=function(e){this._getContentElement().appendChild(e.element)},e.prototype._getContentElement=function(){return this.element},e}();t.Component=n},6137:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultSettings=void 0;var o=n(1001),i="Please try sharing it again, or else type it in.";t.defaultSettings={badgePosition:{right:"-5px",top:"-5px"},chatBubbleIconHeight:"42px",chatBubbleIconWidth:"56px",clientAuthEnabled:!1,conversationBeginPosition:"top",disablePastActions:"all",displayActionsAsPills:!1,embedded:!1,embeddedVideo:!0,enableAttachment:!0,enableAttachmentSecurity:!1,enableAutocomplete:!1,enableAutocompleteClientCache:!1,enableBotAudioResponse:!1,enableClearMessage:!1,enableEndConversation:!0,enableHeadless:!1,enableLocalConversationHistory:!1,enableLongPolling:!1,enableSecureConnection:!0,enableSpeech:!1,enableSpeechAutoSend:!0,enableTabsSync:!0,enableTimestamp:!0,focusOnNewMessage:"input",font:'16px "Helvetica Neue", Helvetica, Arial, sans-serif',fontFamily:'"Oracle Sans", "Helvetica Neue", Helvetica, Arial, sans-serif',height:"620px",i18n:{en:{attachment_audio:"Audio attachment",attachment_file:"File attachment",attachment_image:"Image attachment",attachment_video:"Video attachment",attachmentAudioFallback:"Your browser does not support embedded audio. However you can {0}download it{/0}.",attachmentVideoFallback:"Your browser does not support embedded video. However you can {0}download it{/0}.",audioResponseOff:"Turn audio response on",audioResponseOn:"Turn audio response off",card:"Card {0}",cardImagePlaceholder:"Card image",cardNavNext:"Next card",cardNavPrevious:"Previous card",chatTitle:"Chat",clear:"Clear conversation",close:"Close widget",closing:"Closing",connected:"Connected",connecting:"Connecting",disconnected:"Disconnected",download:"Download",endConversation:"End Conversation",endConversationConfirmMessage:"Are you sure you want to end the conversation?",endConversationDescription:"This will also clear your conversation history.",errorSpeechInvalidUrl:"ODA URL for connection is not set. Please pass 'URI' parameter during SDK initialization.",errorSpeechMultipleConnection:"Another voice recognition is ongoing. Can't start a new one.",errorSpeechTooMuchTimeout:"The voice message is too long to recognize and generate text.",errorSpeechUnavailable:"To allow voice messaging, update your browser settings to enable access to your microphone.",errorSpeechUnsupportedLocale:"The locale set for voice recognition is not supported. Please use a valid locale in 'speechLocale' setting.",inputPlaceholder:"Type a message",imageViewerClose:"Close image viewer",imageViewerOpen:"Open image viewer",itemIterator:"Item {0}",language_ar:"Arabic",language_de:"German",language_detect:"Detect Language",language_en:"English",language_es:"Spanish",language_fr:"French",language_it:"Italian",language_nl:"Dutch",language_pt:"Portuguese",languageSelectDropdown:"Select chat language",linkField:"Click on the highlighted text to open Link for {0}",noSpeechTimeout:"The voice could not be detected to perform recognition.",noText:"No",openMap:"Open Map",previousChats:"Previous conversations",ratingStar:"Rate {0} star",recognitionTextPlaceholder:"Speak your message",relTimeDay:"{0}d ago",relTimeHr:"{0}hr ago",relTimeMin:"{0}min ago",relTimeMoment:"A few seconds ago",relTimeMon:"{0}mth ago",relTimeNow:"Now",relTimeYr:"{0}yr ago",requestLocation:"Requesting location",requestLocationDeniedPermission:"To allow sharing your location, update your browser settings to enable access to your location. You can also type in the location instead.",requestLocationDeniedTimeout:"It is taking too long to get your location. ".concat(i),requestLocationDeniedUnavailable:"Your current location is unavailable. ".concat(i),retryMessage:"Try again",send:"Send message",shareAudio:"Share Audio",shareFailureMessage:"Sorry, sharing is not available on this device.",shareFile:"Share File",shareLocation:"Share Location",shareVisual:"Share Image/Video",skillMessage:"Skill says",speak:"Speak a message",typingIndicator:"Waiting for response",upload:"Share popup",uploadFailed:"Upload Failed.",uploadFileSizeLimitExceeded:"Upload Failed. File size should not be more than {0}MB.",uploadFileSizeZeroByte:"Upload Failed. Files of size zero bytes can't be uploaded.",uploadUnsupportedFileType:"Upload Failed. Unsupported file type.",userMessage:"I say",utteranceGeneric:"Message from skill.",webViewAccessibilityTitle:"In-widget WebView to display links",webViewClose:"Done",webViewErrorInfoDismiss:"Dismiss",webViewErrorInfoText:"Donâ€™t see the page? {0}Click here{/0} to open it in a browser.",yesText:"Yes"}},initBotAudioMuted:!0,isDebugMode:!1,locale:"en",messageCacheSizeLimit:2e3,openChatOnLoad:!1,openLinksInNewWindow:!1,readMark:"âœ“",reconnectInterval:5,reconnectMaxAttempts:50,reconnectTimeout:300,shareMenuItems:[o.ShareCategory.AUDIO,o.ShareCategory.FILE,o.ShareCategory.LOCATION,o.ShareCategory.VISUAL],showConnectionStatus:!1,showPrevConvStatus:!0,showTypingIndicator:!0,speechLocale:o.SPEECH_LOCALE.EN_US,theme:o.IWidgetTheme.DEFAULT,timestampMode:"default",typingIndicatorTimeout:20,upgradeToWebSocketInterval:300,webViewConfig:{},width:"375px"}},2226:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionComponentFactory=void 0;var o=n(7074),i=n(9315),r=n(4910),s=n(6848),a=n(4254),c=n(1349),l=n(8798),u=function(){function e(){}return e.fromActionPayload=function(t,n,l,u,d){switch(t.type){case o.ACTION_TYPE.POSTBACK:return new s.PostbackActionComponent(t);case o.ACTION_TYPE.URL:return new c.UrlActionComponent(t,n,u);case o.ACTION_TYPE.WEBVIEW:return new c.UrlActionComponent(t,n,d.webviewLinkHandler);case o.ACTION_TYPE.LOCATION:return new r.LocationActionComponent(t);case o.ACTION_TYPE.CALL:return new i.CallActionComponent(t);case o.ACTION_TYPE.SHARE:return new a.ShareActionComponent(t,l);default:return e.logger.error("Payload contains wrong action type:"+t.type),null}},e.logger=new l.Logger("ActionComponentFactory"),e}();t.ActionComponentFactory=u},2304:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageComponentFactory=void 0;var o=n(3884),i=n(6213),r=n(986),s=n(8954),a=n(8215),c=n(3145),l=n(6790),u=n(523),d=n(1597),h=n(3353),p=n(3538),g=n(3357),f=function(){function e(){}return e.fromMessage=function(e,t,n,f){var m,v,b=t.messagePayload;(0,o.isBotMessage)(t)?(m=c.MESSAGE_SIDE.LEFT,v=t.source||o.ISkillMessageSource.BOT):m=c.MESSAGE_SIDE.RIGHT;var _=t.date;switch(b.type){case i.PAYLOAD_TYPE.TEXT:var y=b;return y.channelExtensions&&"stars"===y.channelExtensions.displayType?new d.FeedbackComponent(e,y,m,_,n,v,f):new u.TextMessageComponent(e,y,m,_,n,v,f);case i.PAYLOAD_TYPE.ATTACHMENT:return new r.AttachmentMessageComponent(e,b,m,_,n,v,f);case i.PAYLOAD_TYPE.CARD:return new s.CardMessageComponent(e,b,m,_,n,v,f);case i.PAYLOAD_TYPE.LOCATION:return new a.LocationMessageComponent(e,b,m,_,n,v,f);case i.PAYLOAD_TYPE.Table:return new g.TableMessageComponent(e,b,m,_,n,v,f);case i.PAYLOAD_TYPE.Form:return new h.FormMessageComponent(e,b,m,_,n,v,f);case i.PAYLOAD_TYPE.TableForm:return new p.TableFormMessageComponent(e,b,m,_,n,v,f);case i.PAYLOAD_TYPE.RAW:return new l.RawMessageComponent(e,b,m,_,n,v,f);default:throw Error("Wrong message payload type:"+b.type)}},e}();t.MessageComponentFactory=f},1639:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JWT=void 0;var n=function(){function e(e){this.token=e;var t=this.token.split(".");this.header=JSON.parse(atob(t[0])),this.payload=JSON.parse(atob(t[1]))}return e.prototype.getClaim=function(e){return this.payload[e]},e}();t.JWT=n},8798:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=void 0;var n=function(){function e(e){this.module=e}return e.prototype.debug=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._log(e.LOG_LEVEL.DEBUG,t)},e.prototype.error=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._log(e.LOG_LEVEL.ERROR,t)},e.prototype.info=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._log(e.LOG_LEVEL.INFO,t)},e.prototype.warn=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._log(e.LOG_LEVEL.WARN,t)},e.prototype._log=function(t,n){if(e.logLevel>=t){n.unshift("["+e.appName+"."+e.appVersion+"."+this.module+"]");var o=void 0;switch(e.logLevel){case e.LOG_LEVEL.ERROR:o=console.error;break;case e.LOG_LEVEL.WARN:o=console.warn;break;case e.LOG_LEVEL.INFO:o=console.info;break;case e.LOG_LEVEL.DEBUG:o=console.debug}e.historyEnabled&&(e.history.push(Object.assign({},n,{level:t})),e._historySize<=e.history.length&&e.history.shift()),o.apply(console,n)}},e.LOG_LEVEL={DEBUG:4,ERROR:1,INFO:3,NONE:0,WARN:2},e.logLevel=e.LOG_LEVEL.ERROR,e.history=[],e.historyEnabled=!1,e._historySize=100,e}();t.Logger=n},9978:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMessageDigest=void 0;var o=n(3884),i=n(6213);t.getMessageDigest=function(e){if((0,o.isBotMessage)(e)&&e.msgId)return e.msgId;var t=e.messagePayload,n=t.type;switch(t.type){case i.PAYLOAD_TYPE.TEXT:n="".concat(n).concat(t.text.substring(0,10));break;case i.PAYLOAD_TYPE.CARD:n="".concat(n).concat(t.cards[0].title.substring(0,10));break;case i.PAYLOAD_TYPE.ATTACHMENT:n="".concat(n).concat(t.attachment.url.substring(0,20));break;case i.PAYLOAD_TYPE.LOCATION:var r=t.location;n="".concat(n).concat(r.latitude).concat(r.latitude)}return n}},6979:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getUtteranceText=void 0;var o=n(6213),i=n(5949),r="; ",s="",a=/<[^>]+>/g,c=/&#(\d+);/g,l=/&#[xX]([\da-fA-F]+);/g;function u(e){return e&&e.length&&e.filter((function(e){return e&&e.label})).map((function(e){return e.label})).join(r)||s}function d(e,t,n){return"".concat(n.itemIterator.replace("{0}","".concat(t+1)),": ").concat(h(e.fields,n))}function h(e,t){return e&&e.length?e.filter((function(e){return e&&e.value})).map((function(e){return"".concat(e.label,": ").concat("link"===e.displayType?t.linkField.replace("{0}",e.label):e.value)})).join(r):s}t.getUtteranceText=function(e,t){var n,p=e.messagePayload,g=s;switch(p.type){case o.PAYLOAD_TYPE.ATTACHMENT:g=function(e,t){return"".concat(t["".concat(e.type,"_").concat(e.attachment.type)])}(p,t);break;case o.PAYLOAD_TYPE.CARD:g=function(e,t){var n=e.cards,o=s;if(n&&n.length){var i=t.card,a=i?i.indexOf("{0}")>=0?i:"".concat(i," {0}"):s,c=n.length>1;o=n.filter((function(e){return e.title})).map((function(e,t){var n="".concat(c?"".concat(a.replace("{0}","".concat(t+1)),": "):s),o=e.description,i=o?r+o:s,l=u(e.actions),d=l?r+l:s;return"".concat(n).concat(e.title).concat(i).concat(d)})).join(r)}return o}(p,t);break;case o.PAYLOAD_TYPE.LOCATION:g=function(e){var t=e.location;return"".concat(t.title?"".concat(t.title).concat(r):s).concat(t.latitude,", ").concat(t.longitude)}(p);break;case o.PAYLOAD_TYPE.TEXT:g=p.text;break;case o.PAYLOAD_TYPE.Table:g=function(e,t){var n=e.paginationInfo,o=n&&n.status;return(o?o+r:s)+e.rows.filter((function(e){return e&&e.fields&&e.fields.length})).map((function(e,n){return d(e,n,t)})).join(r)}(p,t);break;case o.PAYLOAD_TYPE.Form:g=function(e,t){var n=e.paginationInfo,o=n&&n.status;return(o?o+r:s)+e.forms.filter((function(e){return e&&e.fields&&e.fields.length})).map((function(e,n){return d(e,n,t)})).join(r)}(p,t);break;case o.PAYLOAD_TYPE.TableForm:g=function(e,t){var n=e.paginationInfo,o=n&&n.status;return(o?o+r:s)+e.rows.filter((function(e){return e&&e.fields&&e.fields.length})).map((function(n,o){return d(n,o,t)+r+h(e.forms[o].fields,t)})).join(r)}(p,t)}return(n=function(e,t){var n=e.headerText,o=n?n+r:s,i=u(e.actions),a=i?r+i:s,c=e.footerText,l=c?r+c:s,d=u(e.globalActions);return o+t+a+l+(d?r+d:s)}(p,g))&&n.length?n.replace((0,i.resetRegex)(c),(function(e,t){return String.fromCharCode(t)})).replace((0,i.resetRegex)(l),(function(e,t){var n=parseInt("0x".concat(t),16);return String.fromCharCode(n)})).replace((0,i.resetRegex)(a),s):s}},1001:function(e,t){"use strict";var n,o,i,r;Object.defineProperty(t,"__esModule",{value:!0}),t.ShareCategory=t.StorageType=t.SPEECH_LOCALE=t.IWidgetTheme=void 0,function(e){e.SESSION="sessionStorage",e.LOCAL="localStorage"}(n||(n={})),t.StorageType=n,function(e){e.CLASSIC="classic",e.DEFAULT="default",e.REDWOOD_DARK="redwood-dark"}(o||(o={})),t.IWidgetTheme=o,function(e){e.AUDIO="audio",e.FILE="file",e.LOCATION="location",e.VISUAL="visual"}(i||(i={})),t.ShareCategory=i,function(e){e.DE_DE="de-de",e.EN_AU="en-au",e.EN_GB="en-gb",e.EN_IN="en-in",e.EN_US="en-us",e.ES_ES="es-es",e.FR_FR="fr-fr",e.HI_IN="hi-in",e.IT_IT="it-it",e.PT_BR="pt-br"}(r||(r={})),t.SPEECH_LOCALE=r},2601:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StorageService=void 0;var o=n(8656),i=function(e){var t=this;this.getItem=function(e){return!t.cache[e]&&t.isStorage&&(t.cache[e]=t.storage.getItem(e)),t.cache[e]},this.setItem=function(e,n){t.isStorage?(t.storage.setItem(e,n),delete t.cache[e]):t.cache[e]=n},this.removeItem=function(e){t.isStorage&&t.storage.removeItem(e),delete t.cache[e]},this.cache={},(0,o.isStorageAvailable)(e)?(this.isStorage=!0,this.storage=window[e]):this.isStorage=!1};t.StorageService=i},5439:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionComponent=void 0;var o=n(5949),i=n(1489),r=n(7074),s=i.addCSSClass,a=i.getPrefixCSSClass,c=function(){function e(e){this._disabled=!1,this._type=e.type,this._label=e.label,this._imageUrl=e.imageUrl}return e.prototype.render=function(){if(this._htmlElement=(0,i.createButton)(),this._htmlElement.onclick=this.handleOnClick.bind(this),this._imageUrl){var e=(0,i.createImage)(this._imageUrl,["action-image"],this._label||"");this._htmlElement.appendChild(e)}if(this._label){var t=(0,o.linkify)(this._label,{emHTML:!0}),n=(0,i.createDiv)();n.innerHTML=t,this._htmlElement.appendChild(n),this._htmlElement.title=this._htmlElement.textContent}return this._disabled&&s(this._htmlElement,a("disabled")),this._htmlElement},e.prototype.handleOnClick=function(e){if(this.onActionClick&&!this._disabled){var t={getPayload:this.getEventPayload.bind(this),label:this._label,type:this._type};this.onActionClick(t)}this._type!==r.ACTION_TYPE.POSTBACK&&this._type!==r.ACTION_TYPE.LOCATION&&this._type!==r.ACTION_TYPE.SHARE||(e.preventDefault(),e.stopPropagation())},e.prototype.disable=function(){this._disabled=!0,this._htmlElement&&(s(this._htmlElement,a("disabled")),this._htmlElement.disabled=!0)},e.prototype.enable=function(){this._disabled=!1,this._htmlElement&&((0,i.removeCSSClass)(this._htmlElement,a("disabled")),this._htmlElement.disabled=!1)},e.prototype.getActionType=function(){return this._type},e}();t.ActionComponent=c},9315:function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.CallActionComponent=void 0;var r=n(9297),s=n(1489),a=n(5439),c=s.getPrefixCSSClass,l=function(e){function t(t){var n=e.call(this,t)||this;return n._phoneNumber=t.phoneNumber,n}return i(t,e),t.prototype.render=function(){var t=e.prototype.render.call(this);(0,s.addCSSClass)(t,c("action-postback"),c("action-call"));var n=(0,s.createAnchor)("tel:".concat(this._phoneNumber),"");return this.onActionClick=function(){n.click()},t},t.prototype.getEventPayload=function(){return r.default.resolve(this._phoneNumber)},t}(a.ActionComponent);t.CallActionComponent=l},4910:function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.LocationActionComponent=void 0;var r=n(9297),s=n(1489),a=function(e){function t(t){return e.call(this,t)||this}return i(t,e),t.prototype.render=function(){var t=e.prototype.render.call(this);return(0,s.addCSSClass)(t,(0,s.getPrefixCSSClass)("action-postback"),(0,s.getPrefixCSSClass)("action-location")),t},t.prototype.getEventPayload=function(){return this.getCurrentPosition()},t.prototype.getCurrentPosition=function(){return new r.default((function(e,t){setTimeout((function(){navigator.geolocation.getCurrentPosition((function(t){e({latitude:t.coords.latitude,longitude:t.coords.longitude})}),(function(e){t(e)}))}))}))},t}(n(5439).ActionComponent);t.LocationActionComponent=a},6848:function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.PostbackActionComponent=void 0;var r=n(9297),s=n(1489),a=function(e){function t(t){var n=e.call(this,t)||this;return n._postback=t.postback,n}return i(t,e),t.prototype.render=function(){var t=e.prototype.render.call(this);return(0,s.addCSSClass)(t,(0,s.getPrefixCSSClass)("action-postback")),t},t.prototype.getEventPayload=function(){return r.default.resolve(this._postback)},t}(n(5439).ActionComponent);t.PostbackActionComponent=a},4254:function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.ShareActionComponent=void 0;var r=n(9297),s=n(1489),a=function(e){function t(t,n){var o=e.call(this,t)||this;return o.shareText=n,o}return i(t,e),t.prototype.render=function(){var t=e.prototype.render.call(this);return(0,s.addCSSClass)(t,(0,s.getPrefixCSSClass)("action-postback"),(0,s.getPrefixCSSClass)("action-share")),t},t.prototype.getEventPayload=function(){return r.default.resolve(this.shareText)},t}(n(5439).ActionComponent);t.ShareActionComponent=a},1349:function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.UrlActionComponent=void 0;var r=n(9297),s=n(1489),a=function(e){function t(t,n,o){void 0===n&&(n=!1);var i=e.call(this,t)||this;return i._openInWindow=n,i._linkHandler=o,i._url=t.url,i}return i(t,e),t.prototype.render=function(){var t=e.prototype.render.call(this);if((0,s.addCSSClass)(t,(0,s.getPrefixCSSClass)("action-url"),(0,s.getPrefixCSSClass)("action-postback")),this._url){var n=(0,s.createAnchor)(this._url,"",[],this._openInWindow,this._linkHandler);t.onclick=function(){n.click()}}return t},t.prototype.getEventPayload=function(){return r.default.resolve(this._url)},t}(n(5439).ActionComponent);t.UrlActionComponent=a},986:function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.AttachmentMessageComponent=void 0;var r=n(6737),s=n(2714),a=n(6086),c=n(2406),l=n(8175),u=function(e){function t(n,o,i,r,s,a,c){var l=e.call(this,n,o,i,r,s,a,c)||this;return l._date=r,l._attachment=t.fromPayload(n,o.attachment,i,c),l}return i(t,e),t.fromPayload=function(e,t,n,o){if(o&&o.authToken&&o.uri&&t.url.indexOf(o.uri)>=0&&!this.tokenRegex.test(t.url)){var i=null==o?void 0:o.authToken;(null==i?void 0:i.length)&&(t.url="".concat(t.url,"?token=").concat(i))}switch(t.type){case r.ATTACHMENT_TYPE.IMAGE:return new c.ImageAttachmentComponent(e,t,n);case r.ATTACHMENT_TYPE.VIDEO:return new l.VideoAttachmentComponent(e,t,n);case r.ATTACHMENT_TYPE.AUDIO:return new s.AudioAttachmentComponent(e,t,n);case r.ATTACHMENT_TYPE.FILE:return new a.FileAttachmentComponent(e,t,n);default:throw Error("Payload contains wrong attachment type")}},t.prototype.getContent=function(){return e.prototype.getContent.call(this,this._attachment.render())},t.tokenRegex=/token=[a-z\.\d]+/i,t}(n(3145).MessageComponent);t.AttachmentMessageComponent=u},4483:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AttachmentComponent=void 0;var o=n(6737),i=n(1489),r=n(1389),s=n(3145),a=n(4534),c=i.createDiv,l=function(){function e(e,t,n){this.settings=t,this.side=n,this._url=e.url,this._type=e.type;var o=e.url.split("/");this._title=decodeURI(e.title||e.fileName||o[o.length-1])}return e.capitalize=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},e.prototype.createDownloadButton=function(e){var t=this.settings,n=(0,i.createElement)("a"),o=(0,i.createIconButton)({css:["attachment-control-icon"],icon:t.icons.download||r.iconDownload,iconCss:["attachment-download-icon"],title:t.i18n[t.locale].download});return n.setAttribute("href",e),n.setAttribute("download",""),n.setAttribute("target","_blank"),n.appendChild(o),n},e.prototype.createMessageElement=function(e,t){var n=c(["attachment-message"]),o=c(["attachment-icon"]),r=(0,i.createImageIcon)({icon:e,title:""}),a=c(["attachment-fileName"]),l=(0,i.createElement)("span",["attachment-file"]);return o.appendChild(r),l.innerText=t,a.appendChild(l),n.appendChild(o),n.appendChild(a),this.side===s.MESSAGE_SIDE.LEFT&&n.appendChild(this.createDownloadButton(this._url)),n},e.prototype.createFooterControls=function(){var e=this,t=this.settings,n=this._title,a=(0,i.createElement)("label");a.innerText=n;var l=c(["attachment-footer"]),u=c(["attachment-controls"]);if(a.setAttribute("title",n),l.appendChild(a),this._type===o.ATTACHMENT_TYPE.IMAGE){var d=(0,i.createIconButton)({css:["attachment-control-icon"],icon:t.icons.expandImage||r.iconZoom,iconCss:["attachment-expand-icon"],title:t.i18n[t.locale].imageViewerOpen});d.onclick=function(){e.createImagePreview(e._url,n)},u.appendChild(d)}return this.side===s.MESSAGE_SIDE.LEFT&&u.appendChild(this.createDownloadButton(this._url)),l.appendChild(u),l},e.prototype.createImagePreview=function(e,t){var n="image-preview",o=this.settings,s=c(["".concat(n,"-wrapper")]),l=(0,i.createImage)(e,[n]),u=(0,i.createElement)("label",["".concat(n,"-title")]);u.innerText=t;var d=document.querySelector(".".concat(a.SDK_NAME,"-wrapper")),h=o.icons.close||r.iconClose,p=(0,i.createIconButton)({css:["".concat(n,"-close")],icon:h,iconCss:["".concat(n,"-close-icon")],title:o.i18n[o.locale].imageViewerClose});p.onclick=function(){s.remove()},p.onkeydown=function(e){"Tab"===e.key&&(s.focus(),e.preventDefault())};var g=c(["".concat(n,"-header")]);g.appendChild(u),g.appendChild(p),s.appendChild(g),s.appendChild(l),s.setAttribute("tabindex","-1"),s.onkeydown=function(e){"Escape"===e.key&&s.remove()},d.appendChild(s),s.focus()},e}();t.AttachmentComponent=l},2714:function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.AudioAttachmentComponent=void 0;var r=n(1489),s=n(1389),a=n(5949),c=n(3145),l=function(e){function t(t,n,o){return e.call(this,n,t,o)||this}return i(t,e),t.prototype.render=function(){var e=this,t=this.settings,n=(0,r.createMedia)("video",["attachment-audio"],this._url);n.controls=!0,n.preload="metadata",c.MESSAGE_SIDE.RIGHT===this.side&&n.setAttribute("controlsList","nodownload");var o='<a href="'+this._url+'">',i=t.i18n[t.locale].attachmentAudioFallback.replace("{0}",o).replace("{/0}","</a>");return n.innerHTML=i,t.linkHandler?a.utils.setEmbeddedLinksHandler(n,t.linkHandler):t.openLinksInNewWindow&&a.utils.setLinksOpenInNewWindow(n),n.onloadeddata=function(){var t;e.side===c.MESSAGE_SIDE.LEFT&&(null===(t=n.parentElement)||void 0===t||t.appendChild(e.createFooterControls()))},n.onerror=function(){var o,i=t.icons.fileAudio||s.iconAudio;null===(o=n.parentElement)||void 0===o||o.appendChild(e.createMessageElement(i,e._title)),n.remove()},n},t}(n(4483).AttachmentComponent);t.AudioAttachmentComponent=l},6086:function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.FileAttachmentComponent=void 0;var r=n(1389),s=n(3145),a=n(4483),c=n(1489),l=function(e){function t(t,n,o){return e.call(this,n,t,o)||this}return i(t,e),t.prototype.render=function(){var e=this.settings;if(s.MESSAGE_SIDE.RIGHT===this.side){var t=e.icons.fileGeneric||r.iconFile;return this.createMessageElement(t,this._title)}return(0,c.createAnchor)(this._url,this._title,["attachment-file"],e.openLinksInNewWindow,e.linkHandler)},t}(a.AttachmentComponent);t.FileAttachmentComponent=l},2406:function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.ImageAttachmentComponent=void 0;var r=n(4483),s=n(1389),a=n(1489),c=function(e){function t(t,n,o){return e.call(this,n,t,o)||this}return i(t,e),t.prototype.render=function(){var e=this,t=this._title,n=(0,a.createImage)(this._url,["attachment-image"],t);return n.onload=function(){var t;null===(t=n.parentElement)||void 0===t||t.appendChild(e.createFooterControls())},n.onerror=function(){var o,i=e.settings.icons.fileImage||s.iconImage;null===(o=n.parentElement)||void 0===o||o.appendChild(e.createMessageElement(i,t)),n.remove()},n.onclick=function(){e.createImagePreview(e._url,t)},n},t}(r.AttachmentComponent);t.ImageAttachmentComponent=c},8175:function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.VideoAttachmentComponent=void 0;var r=n(1489),s=n(1389),a=n(5949),c=n(3145),l=function(e){function t(t,n,o){return e.call(this,n,t,o)||this}return i(t,e),t.prototype.render=function(){var e=this,t=this.settings;if((0,a.getYouTubeID)(this._url)){var n=(0,r.createElement)("span");return n.innerHTML=(0,a.linkify)(this._url,{emHTML:!0,emVideo:t.embeddedVideo}),n}var o=(0,r.createMedia)("video",["attachment-video"],this._url);o.controls=!0,o.preload="metadata",c.MESSAGE_SIDE.RIGHT===this.side&&o.setAttribute("controlsList","nodownload");var i='<a href="'+this._url+'">',l=t.i18n[t.locale].attachmentVideoFallback.replace("{0}",i).replace("{/0}","</a>");return o.innerHTML=l,this.settings.linkHandler?a.utils.setEmbeddedLinksHandler(o,t.linkHandler):this.settings.openLinksInNewWindow&&a.utils.setLinksOpenInNewWindow(o),o.onloadeddata=function(){var t;e.side===c.MESSAGE_SIDE.LEFT&&(null===(t=o.parentElement)||void 0===t||t.appendChild(e.createFooterControls()))},o.onerror=function(){var n,i=t.icons.fileVideo||s.iconVideo;null===(n=o.parentElement)||void 0===n||n.appendChild(e.createMessageElement(i,e._title)),o.remove()},o},t}(n(4483).AttachmentComponent);t.VideoAttachmentComponent=l},9070:function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.C2SQLBaseMessageComponent=void 0;var r=n(4534),s=n(1489),a=n(3145),c=s.createDiv,l=r.SDK_NAME,u=function(e){function t(t,n,o,i,r,s,a){var c=e.call(this,t,n,o,i,r,s,a)||this;return c._payload=n,c._isActionsExternal=!0,c}return i(t,e),t.prototype.render=function(){var t=e.prototype.render.call(this),n=t.querySelector(".".concat(l,"-content-wrapper"));return n.style.width="100%",n.style.overflow="hidden",t},t.prototype.getHeader=function(){var t=e.prototype.getHeader.call(this);return(0,s.addCSSClass)(t,"".concat(l,"-message-header-yellow")),t},t.prototype.getContent=function(e){var t="message-bubble",n=c([t,"".concat(t,"-tabular-message")]);e&&n.appendChild(e);var o=this.getPageStatus();return o&&n.appendChild(o),n},t.prototype.getPageStatus=function(){var e,t=this._payload.paginationInfo;return t&&t.totalCount>t.rangeSize&&((e=c(["results-page-status"])).innerText=t.status),e},t}(a.MessageComponent);t.C2SQLBaseMessageComponent=u},8954:function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var o,i=0,r=t.length;i<r;i++)!o&&i in t||(o||(o=Array.prototype.slice.call(t,0,i)),o[i]=t[i]);return e.concat(o||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.CardMessageComponent=void 0;var s=n(1389),a=n(4347),c=n(1887),l=n(3145),u=n(1489),d=n(4534),h=u.createDiv,p=u.createButton,g=u.createElementFromString,f=function(e){function t(t,n,o,i,r,s,a){var l=e.call(this,t,n,o,i,r,s,a)||this;l.cards=[];var u=l;u.layout=n.layout,u.numCards=n.cards.length;var d=0;return n.cards.forEach((function(e){d++,u.cards.push(new c.CardComponent(u.settings,e,d,a))})),u.globalActions=u.actions.concat(u.globalActions),u.actions=[],l}return i(t,e),t.prototype.hasActions=function(){return this.cards[0].hasActions()||this.actions.length>0||this.globalActions.length>0},t.prototype.disableActions=function(){e.prototype.disableActions.call(this),this.cards.forEach((function(e){return e.disableActions()}))},t.prototype.disablePostbacks=function(){e.prototype.disablePostbacks.call(this),this.cards.forEach((function(e){return e.disablePostbacks()}))},t.prototype.enableActions=function(){e.prototype.enableActions.call(this),this.cards.forEach((function(e){return e.enableActions()}))},t.prototype.enablePostbacks=function(){e.prototype.enablePostbacks.call(this),this.cards.forEach((function(e){return e.enablePostbacks()}))},t.prototype.render=function(){var t=d.SDK_NAME,n=["".concat(t,"-card-message-").concat(this.layout)],o=e.prototype.render.call(this);if(o.querySelector(".".concat(d.SDK_NAME,"-icon-wrapper"))){n.push("".concat(t,"-has-message-icon"));var i=o.querySelector(".".concat(t,"-content-wrapper"));(0,u.addCSSClass)(i,"".concat(t,"-with-icon"))}return u.addCSSClass.apply(void 0,r([o],n,!1)),o},t.prototype.getContent=function(){var e,t=this,n=h(["card-message-content"]),o=h(["card-message-cards"]),i=!0;return t.cards.forEach((function(e){e.onActionClick=t.handleOnActionClick.bind(t);var n=e.render();i&&e.hasActions()&&(t.firstActionButton=e.getFirstActionButton(),i=!1),o.appendChild(n)})),n.appendChild(o),t.layout===a.LAYOUT.HORIZONTAL&&t.numCards>1&&(n.appendChild(t.getNextButton()),t.activeCard=0,o.addEventListener("scroll",(function(){window.clearTimeout(e),e=window.setTimeout((function(){for(var e=0,n=0;n<t.numCards;n++){var i=o.children[n];if(o.scrollLeft<=i.offsetLeft+5){e=n;break}}e!==t.activeCard&&(t.activeCard=e,t.updateCardsScrollState())}),100)}))),t.content=n,t.cardsWrapper=o,n},t.prototype.getNextButton=function(){if(!this.nextButton){var e=this.translations.cardNavNext;this.nextButton=p(["round","next"]),this.nextButton.title=e,this.nextButton.setAttribute("aria-label",e);var t=g(s.iconChevronNext);t.setAttribute("role","img"),t.setAttribute("aria-label",e),this.nextButton.appendChild(t),this.nextButton.onclick=this.showNextCard.bind(this)}return this.nextButton},t.prototype.getPreviousButton=function(){if(!this.prevButton){var e=this.translations.cardNavPrevious;this.prevButton=p(["round","previous"]),this.prevButton.title=e,this.prevButton.setAttribute("aria-label",e);var t=g(s.iconChevronPrevious);t.setAttribute("role","img"),t.setAttribute("aria-label",e),this.prevButton.appendChild(t),this.prevButton.onclick=this.showPrevCard.bind(this)}return this.prevButton},t.prototype.showNextCard=function(){this.activeCard<this.numCards&&(this.activeCard++,this.updateCardsScrollState())},t.prototype.showPrevCard=function(){this.activeCard>0&&(this.activeCard--,this.updateCardsScrollState())},t.prototype.updateCardsScrollState=function(){var e,t,n,o,i=this.cardsWrapper.children[this.activeCard];i&&(this.cardsWrapper.scrollLeft=i.offsetLeft,0===this.activeCard?null===(e=this.prevButton)||void 0===e||e.remove():(null===(t=this.prevButton)||void 0===t?void 0:t.parentElement)||this.content.prepend(this.getPreviousButton()),this.activeCard===this.numCards-1?null===(n=this.nextButton)||void 0===n||n.remove():(null===(o=this.nextButton)||void 0===o?void 0:o.parentElement)||this.content.appendChild(this.getNextButton()))},t}(l.MessageComponent);t.CardMessageComponent=f},1887:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CardComponent=void 0;var o=n(416),i=n(2226),r=n(5949),s=n(1489),a=s.createDiv,c=function(){function e(e,t,n,r){var s;if(this.settings=e,this.options=r,this._actions=[],this._postActions=[],this._title=t.title,this._description=t.description,this._imageUrl=t.imageUrl,this._url=t.url,t.actions){for(var a=0,c=0,l=t.actions;c<l.length;c++){var u=l[c],d=(this._title?this._title+" - ":"")+(this._description?this._description+" - ":"")+(null!==(s=this._url)&&void 0!==s?s:"");a++,u.actionId="card"+n+"Action"+a;var h=i.ActionComponentFactory.fromActionPayload(u,this.settings.openLinksInNewWindow,d,e.linkHandler,r);h&&(h.onActionClick=this.handleOnActionClick.bind(this),this._actions.push(h))}this._postActions=(0,o.getPostActions)(this._actions)}}return e.prototype.handleOnActionClick=function(e){this.onActionClick&&this.onActionClick(e)},e.prototype.render=function(){var e=this.settings,t=e.locale,n=this._url,o=a(["card"]),i=n?(0,s.createAnchor)(n,"",["card-component"],e.openLinksInNewWindow,e.linkHandler):a(["card-content"]);if(this._url&&(i.innerText=""),this._imageUrl){var c=e.i18n,l=c[t].cardImagePlaceholder;if(this.options&&this.options.locale){var u=c[this.options.locale];l=u?u.cardImagePlaceholder:l}i.appendChild((0,s.createImage)(this._imageUrl,["card-image"],l))}var d={emHTML:!0,emVideo:!0},h=a(["card-title"]);if(h.innerHTML=(0,r.linkify)(this._title,d),i.appendChild(h),this._description){var p=a(["card-description"]);p.innerHTML=(0,r.linkify)(this._description,d),i.appendChild(p)}if(o.appendChild(i),this.settings.linkHandler?r.utils.setEmbeddedLinksHandler(i,e.linkHandler):this.settings.openLinksInNewWindow&&r.utils.setLinksOpenInNewWindow(i),(0,r.setEmbeddedWebViewLinksHandler)(i,this.options.webviewLinkHandler),this._actions.length>0){for(var g=a(e.displayActionsAsPills?["card-actions","card-actions-pill"]:["card-actions"]),f=!0,m=0,v=this._actions;m<v.length;m++){var b=v[m].render();f&&(this.firstActionButton=b,f=!1),g.appendChild(b)}o.appendChild(g)}return o},e.prototype.hasActions=function(){return this._actions.length>0},e.prototype.disableActions=function(){this._actions.forEach((function(e){return e.disable()}))},e.prototype.disablePostbacks=function(){this._postActions.forEach((function(e){return e.disable()}))},e.prototype.enableActions=function(){this._actions.forEach((function(e){return e.enable()}))},e.prototype.enablePostbacks=function(){this._postActions.forEach((function(e){return e.enable()}))},e.prototype.getFirstActionButton=function(){return this.firstActionButton},e}();t.CardComponent=c},3353:function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.getFormItem=t.FormMessageComponent=void 0;var r=n(9070),s=n(1489),a=n(5949),c=s.createDiv,l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.getContent=function(){var t=this._payload,n=t.headerText,o=c(["form-message"]);if(n){var i=c(["form-message-header"]);i.innerText=n,o.appendChild(i)}return t.formColumns>2&&(t.formColumns=2),t.forms.forEach((function(e){var n=u(e.fields,t.formColumns);o.appendChild(n)})),e.prototype.getContent.call(this,o)},t}(r.C2SQLBaseMessageComponent);function u(e,t){var n="form-message",o="".concat(n,"-field"),i=[o,"".concat(o,"-col-").concat(t)],r=c(["".concat(n,"-item")]);return e.forEach((function(e){var t=c(i),o=c(["".concat(n,"-key")]),l=c(["".concat(n,"-value")]);if(o.innerText=e.label,"link"===e.displayType){var u=(0,s.createElement)("a",e.linkLabel?[]:["ellipsis"]);u.href=e.value,u.innerText=e.linkLabel||(0,a.skipHTTPS)(e.value)||"",l.appendChild(u)}else l.innerText=e.value||"";var d=e.alignment;d&&(l.style.textAlign=d),t.appendChild(o),t.appendChild(l),r.appendChild(t)})),r}t.FormMessageComponent=l,t.getFormItem=u},2401:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoadingMessageComponent=void 0;var o=n(1489),i=n(9174),r=n(3145),s=o.createDiv,a=function(){function e(e,t,n){this.text=e,this.side=t,this.settings=n}return e.prototype.render=function(){var e=this.settings.icons;this._element=s(["message",this.side]);var t=s(["message-wrapper"]),n=s(["message-bubble"]),a=s(["message-content","loading-icon"]),c=this.side===r.MESSAGE_SIDE.LEFT?e.avatarBot:e.avatarUser;if(c){var l=s(["icon-wrapper"]),u=(0,o.createImageIcon)({icon:c,iconCss:["message-icon"],title:""});l.appendChild(u),t.appendChild(l)}var d=s(["message-text"]);return d.innerText=this.text,a.appendChild((new i.SpinnerComponent).render()),a.appendChild(d),n.appendChild(a),t.appendChild(n),this._element.appendChild(t),this._element},e.prototype.remove=function(){this._element.remove()},e}();t.LoadingMessageComponent=a},9174:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SpinnerComponent=void 0;var o=n(1489),i=function(){function e(){}return e.prototype.render=function(){var e=(0,o.createDiv)(["spinner"]);return e.innerHTML='<svg viewBox="0 0 64 64"><circle transform="translate(32,32)" r="26"></circle></svg>',e},e}();t.SpinnerComponent=i},8215:function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.LocationMessageComponent=void 0;var r=n(7074),s=n(1349),a=n(3145),c=n(1489),l=function(e){function t(t,n,o,i,a,c,l){var u=e.call(this,t,n,o,i,a,c,l)||this,d=n.location;if(u._title=d.title,u._url=d.url,u._longitude=d.longitude,u._latitude=d.latitude,!u.actions.length){var h={actionId:"locationAction-".concat(Math.floor(1e3*Math.random())),type:r.ACTION_TYPE.URL,url:u._url||"https://www.google.com/maps/@".concat(d.latitude,",").concat(d.longitude,",12z"),label:u.translations.openMap};u.actions.push(new s.UrlActionComponent(h,t.openLinksInNewWindow,t.linkHandler))}return u}return i(t,e),t.prototype.getContent=function(){var t=(0,c.createElement)("span");return t.innerText=this._title?this._title:"".concat(this._latitude.toFixed(4),", ").concat(this._longitude.toFixed(4)),e.prototype.getContent.call(this,t)},t}(a.MessageComponent);t.LocationMessageComponent=l},9176:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageStringComponent=void 0;var o=n(1489),i=n(3145),r=o.createDiv,s=function(){function e(e,t,n){this.text=e,this.side=t,this.settings=n}return e.prototype.render=function(e){var t=this.settings.icons;this._element=r(["message",this.side]);var n=r(["message-wrapper"]),s=r(["content-wrapper"]),a=r(["message-bubble"]),c=r(["message-content"]),l=this.side===i.MESSAGE_SIDE.LEFT?t.avatarBot:t.avatarUser;if(l){var u=r(["icon-wrapper"]),d=(0,o.createImageIcon)({icon:l,iconCss:["message-icon"],title:""});u.appendChild(d),n.appendChild(u)}if(e){(0,o.addCSSClass)(c,(0,o.getPrefixCSSClass)("message-with-icon"));var h=(0,o.createImageIcon)({icon:e,title:""}),p=r(["error-icon"]);p.appendChild(h),c.appendChild(p)}var g=r(["message-text"]);return g.innerText=this.text,c.appendChild(g),a.appendChild(c),s.appendChild(a),n.appendChild(s),this._element.appendChild(n),this._element},e}();t.MessageStringComponent=s},416:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPostActions=void 0;var o=n(7074);t.getPostActions=function(e){return e.filter((function(e){var t=e.getActionType();return t===o.ACTION_TYPE.POSTBACK||t===o.ACTION_TYPE.LOCATION}))}},3145:function(e,t,n){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.MESSAGE_SIDE=t.MessageComponent=void 0;var i,r=n(5949),s=n(416),a=n(2226),c=n(6213),l=n(3884),u=n(1489),d=u.createDiv,h=u.getPrefixCSSClass;!function(e){e.LEFT="left",e.RIGHT="right"}(i||(i={})),t.MESSAGE_SIDE=i;var p=function(){function e(e,t,n,i,r,a,l){this.settings=e,this.side=n,this.markAsRead=r,this.source=a,this.actions=[],this.globalActions=[],this.dateFormat={weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0},this._postActions=[],this.locale=e.locale,this.translations=e.i18n[this.locale],l&&l.locale&&(this.locale=l.locale,this.translations=o(o({},this.translations),this.settings.i18n[l.locale])),this.date=i;var u="";switch(t.type){case c.PAYLOAD_TYPE.CARD:t.cards.forEach((function(e){var t;u+=(e.title?e.title+" - ":"")+(e.description?e.description+" - ":"")+(null!==(t=e.url)&&void 0!==t?t:"")+"\n"}));break;case c.PAYLOAD_TYPE.TEXT:u=t.text;break;case c.PAYLOAD_TYPE.ATTACHMENT:u=t.attachment.url;break;case c.PAYLOAD_TYPE.LOCATION:var d=t.location;u=(d.title?d.title+" - ":"")+d.latitude+", "+d.longitude}if(t.actions&&(this.actions=g(t.actions,e.openLinksInNewWindow,u,e.linkHandler,l,this.handleOnActionClick.bind(this))),this._isActionsExternal=e.displayActionsAsPills,t.globalActions){var h=g(t.globalActions,e.openLinksInNewWindow,u,e.linkHandler,l,this.handleOnActionClick.bind(this));this.globalActions=this.globalActions.concat(h)}this.headerText=t.headerText,this.footerText=t.footerText,this._postActions=(0,s.getPostActions)(this.actions).concat((0,s.getPostActions)(this.globalActions))}return e.prototype.handleOnActionClick=function(e){if(this.onActionClick){var t=e;t.messageComponent=this,this.onActionClick(t)}},e.prototype.updateMarkAsRead=function(){return this._chatDate&&(this._chatDate=this.getTime(!0)),this.markAsRead(this.date)},e.prototype.hasActions=function(){return this.actions.length>0||this.globalActions.length>0},e.prototype.focusFirstAction=function(){var e;null===(e=this.firstActionButton)||void 0===e||e.focus()},e.prototype.disableActions=function(){this.actions.forEach((function(e){return e.disable()})),this.globalActions.forEach((function(e){return e.disable()}))},e.prototype.disablePostbacks=function(){this._postActions.forEach((function(e){return e.disable()}))},e.prototype.enableActions=function(){this.actions.forEach((function(e){return e.enable()})),this.globalActions.forEach((function(e){return e.enable()}))},e.prototype.enablePostbacks=function(){this._postActions.forEach((function(e){return e.enable()}))},e.prototype.render=function(e){var t=this,n=t.settings,o=n.icons,r=t.actions,s=t.globalActions,a=d(["message",t.side]);a.lang=t.locale,a.appendChild(t.getSender());var c=d(["message-wrapper"]);a.appendChild(c);var p=t.source===l.ISkillMessageSource.AGENT&&o.avatarAgent||o.avatarBot,g=t.side===i.LEFT?p:o.avatarUser;g&&c.appendChild(t.getAvatar(g));var f=d(["content-wrapper"]);c.appendChild(f);var m=t.getContent(e);if(t.headerText&&(f.appendChild(t.getHeader()),(0,u.addCSSClass)(m,h("has-header"))),f.appendChild(m),r&&r.length){var v=t.getActions();(t._isActionsExternal?f:m).appendChild(v),t.firstActionButton||(t.firstActionButton=v.firstElementChild)}if(t.footerText&&(f.appendChild(t.getFooter()),(0,u.addCSSClass)(m,h("has-footer"))),s&&s.length&&(v=t.getGlobalActions(),a.appendChild(v),t.firstActionButton||(t.firstActionButton=v.firstElementChild)),n.enableTimestamp&&"default"===n.timestampMode){var b=g?t.side===i.LEFT?1:2:0,_=t.getTime(!1,b);a.appendChild(_),t._chatDate=_}return a},e.prototype.getAvatar=function(e){var t=d(["icon-wrapper"]),n=(0,u.createImageIcon)({icon:e,iconCss:["message-icon"],title:""});return t.appendChild(n),t},e.prototype.getSender=function(){var e=this.side===i.LEFT?this.translations.skillMessage:this.translations.userMessage,t=(0,u.createElement)("span",["screen-reader-only"]);return t.innerText=e,t},e.prototype.getHeader=function(){return f(this.headerText,"message-header")},e.prototype.getContent=function(e){var t=d(["message-bubble"]);if(t.style.padding=this.settings.messagePadding||t.style.padding,e){var n=d(["message-content"]);n.appendChild(e),t.appendChild(n)}return t},e.prototype.getActions=function(){var e=this._isActionsExternal?["message-global-actions"]:["message-actions"];return m(this.actions,e)},e.prototype.getFooter=function(){return f(this.footerText,"message-footer")},e.prototype.getGlobalActions=function(){var e=["message-global-actions"];return this.settings.icons.avatarBot&&e.push("has-message-icon"),m(this.globalActions,e)},e.prototype.getTime=function(e,t){void 0===e&&(e=!1);var n,o=this,i=o._chatDate,s=new Date(o.date),a=(0,r.formatDate)(s,{pattern:o.settings.timestampFormat,fallback:o.dateFormat,locale:o.locale}),c=e?o.settings.readMark:"";if(i)n=i;else{var l=["message-date"];(t=t||0)&&l.push("has-icon-".concat(1===t?"left":"right")),(n=d(l)).setAttribute("aria-live","off"),n.setAttribute("aria-hidden","true")}return n.innerText="".concat(a," ").concat(c),n},e}();function g(e,t,n,o,i,r){var s=[];return e.forEach((function(e){var c=a.ActionComponentFactory.fromActionPayload(e,t,n,o,i);c&&(c.onActionClick=r,s.push(c))})),s}function f(e,t){var n=d(["message-bubble",t]);return n.innerHTML=(0,r.linkify)(e,{emHTML:!0,emVideo:!0}),n}function m(e,t){var n=d(t);return e.forEach((function(e){n.appendChild(e.render())})),n}t.MessageComponent=p},6790:function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.RawMessageComponent=void 0;var r=n(3145),s=n(1489),a=function(e){function t(t,n,o,i,r,s,a){var c=e.call(this,t,n,o,i,r,s,a)||this;return c._payload=JSON.stringify(n.payload),c}return i(t,e),t.prototype.getContent=function(){var t=(0,s.createElement)("span");return t.innerText=this._payload,e.prototype.getContent.call(this,t)},t}(r.MessageComponent);t.RawMessageComponent=a},9622:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RelativeTimestampComponent=void 0;var o=n(4534),i=n(1489),r=n(330),s=window.setTimeout,a=window.setInterval,c=36e5,l=864e5,u="relTimeNow",d="relTimeMoment",h="relTimeMin",p="relTimeHr",g=o.SDK_NAME,f=function(){function e(e){var t=e.icons;this.i18n=e.i18n[e.locale];var n="-has-message-icon";this.cssSkill="".concat(g,"-left ").concat(t.avatarBot?"".concat(g).concat(n):""),this.cssUser="".concat(g,"-right ").concat(t.avatarUser?"".concat(g).concat(n):"")}return e.prototype.render=function(){var e=this.element;return e?(e.setAttribute("aria-live","off"),e.setAttribute("aria-hidden","true")):e=(0,i.createDiv)(),e.className="".concat(g,"-relative-timestamp ").concat(this.css),this.element=e,e},e.prototype.setLocale=function(e){if(this.i18n=e,this.key)switch(this.key){case u:case d:this.setTime(this.i18n[this.key]);break;case h:case p:this.setTime(this.i18n[this.key].replace("{0}","".concat(this.counter)))}},e.prototype.setRelativeTime=function(e){var t=(new Date).getTime()-e.getTime(),n=Math.floor(t/1e3),o=Math.floor(n/60),i=Math.floor(o/60),r=Math.floor(i/24),s=Math.floor(r/30),a=Math.floor(s/12);a>0?this.setYears(a):s>0?this.setMonths(s):r>0?this.setDays(r):i>0?this.setHours(i):o>0?this.setMinutes(o):this.setMoment(n)},e.prototype.refresh=function(e){this.css=e===r.SENDER_TYPE.BOT?this.cssSkill:this.cssUser,this.element.className="".concat(g,"-relative-timestamp ").concat(this.css),this.setNow()},e.prototype.remove=function(){var e;(null===(e=this.element)||void 0===e?void 0:e.parentElement)&&this.element.remove()},e.prototype.setNow=function(){this.runTimeout(u,1e4,this.setMoment.bind(this))},e.prototype.setMoment=function(e){void 0===e&&(e=10),e*=1e3,this.runTimeout(d,6e4-e,this.setMinutes.bind(this))},e.prototype.setMinutes=function(e){void 0===e&&(e=1),this.runTimer(this.i18n,h,6e4,60,this.setHours.bind(this),e)},e.prototype.setHours=function(e){void 0===e&&(e=1),this.runTimer(this.i18n,p,c,24,this.setDays.bind(this),e)},e.prototype.setDays=function(e){void 0===e&&(e=1),this.runTimer(this.i18n,"relTimeDay",l,30,this.setMonths.bind(this),e)},e.prototype.setMonths=function(e){void 0===e&&(e=1),this.runTimer(this.i18n,"relTimeMon",2592e6,12,this.setYears.bind(this),e)},e.prototype.setYears=function(e){void 0===e&&(e=1),this.runTimer(this.i18n,"relTimeYr",31536e6,60,(function(){}),e)},e.prototype.runTimeout=function(e,t,n){this.resetTimer(),this.setTime(this.i18n[e]),this.key=e,this.updateTimer=s((function(){n()}),t)},e.prototype.runTimer=function(e,t,n,o,i,r){var s=this;void 0===r&&(r=1),this.resetTimer(),this.setTime(e[t].replace("{0}","".concat(r))),this.key=t,this.counter=r,this.updateTimer=a((function(){r++,s.counter=r,r>o?(clearInterval(s.updateTimer),i()):s.setTime(e[t].replace("{0}","".concat(r)))}),n)},e.prototype.setTime=function(e){this.element.innerText=e},e.prototype.resetTimer=function(){clearTimeout(this.updateTimer),clearInterval(this.updateTimer)},e}();t.RelativeTimestampComponent=f},134:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StatusComponent=void 0;var o=n(1489),i=function(){function e(e,t){var n="status-message",i=(0,o.createDiv)(["".concat(n,"-container")]);i.setAttribute("role","alert");var r=(0,o.createDiv)(["".concat(n,"-wrapper")]);if(t){var s=(0,o.createImage)(t,["status-image"],"");r.appendChild(s)}var a=(0,o.createDiv)([n]);a.textContent=e,r.appendChild(a),i.appendChild(r),this._element=i}return e.prototype.remove=function(){this._element.remove()},e.prototype.render=function(){return this._element},e}();t.StatusComponent=i},3357:function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.applyHeadingWidth=t.createTableCell=t.TableMessageComponent=void 0;var r=n(9070),s=n(1489),a=n(5949),c=s.createDiv,l=100,u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.getContent=function(){var t=this._payload,n=h(t.headings),o="table-message",i=c(["".concat(o,"-wrapper")]),r=c([o]);r.style.width="".concat(n.length<4?l:45*n.length,"% "),i.appendChild(r);var u=c(["".concat(o,"-headings")]);return n.forEach((function(e){var t=d(["".concat(o,"-heading")],e.width,e.alignment);t.innerText=e.label,u.appendChild(t)})),r.appendChild(u),t.rows.forEach((function(e){var t=c(["".concat(o,"-row")]);e.fields.forEach((function(e,i){var r=d(["".concat(o,"-item")],n[i].width,e.alignment);if("link"===e.displayType){var c=(0,s.createElement)("a",e.linkLabel?[]:["ellipsis"]),l=e.linkLabel||(0,a.skipHTTPS)(e.value)||"";c.href=e.value,c.innerText=l,r.appendChild(c)}else r.innerText=e.value||"";t.appendChild(r)})),r.appendChild(t)})),e.prototype.getContent.call(this,i)},t}(r.C2SQLBaseMessageComponent);function d(e,t,n){var o=c(e);return o.style.textAlign=n,o.style.width="".concat(t,"%"),o}function h(e){var t;if(e.every((function(e){return!e.width||e.width>=0&&e.width<=l}))){var n=0,o=0;if(e.forEach((function(e){e.width?o+=e.width:n++})),n)if(o<l){var i=(l-o)/n;t=e.map((function(e){return e.width||(e.width=i),e}))}else t=p(e);else if(o===l)t=e;else{var r=l/o;t=e.map((function(e){return e.width=e.width*r,e}))}}else t=p(e);return t}function p(e){var t=l/e.length;return e.map((function(e){return e.width=t,e}))}t.TableMessageComponent=u,t.createTableCell=d,t.applyHeadingWidth=h},3538:function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.TableFormMessageComponent=void 0;var r=n(9070),s=n(3357),a=n(3353),c=n(4534),l=n(1489),u=n(1389),d=n(5949),h=l.addCSSClass,p=l.removeCSSClass,g=l.createDiv,f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.getContent=function(){var t=this._payload;t.headings.push({alignment:"center",label:""});var n=(0,s.applyHeadingWidth)(t.headings),o="table-message",i=g(["".concat(o,"-wrapper")]),r=g([o,"tableform-message"]);r.style.width="".concat(n.length<4?100:45*n.length,"% "),i.appendChild(r);var f=g(["".concat(o,"-headings")]);return n.forEach((function(e){var t=(0,s.createTableCell)(["".concat(o,"-heading")],e.width,e.alignment);t.innerText=e.label,f.appendChild(t)})),r.appendChild(f),f.lastElementChild.style.width="32px",t.rows.forEach((function(e,i){var f=g(["".concat(o,"-row")]);e.fields.forEach((function(e,t){var i=(0,s.createTableCell)(["".concat(o,"-item")],n[t].width,e.alignment);if("link"===e.displayType){var r=(0,l.createElement)("a",e.linkLabel?[]:["ellipsis"]);r.href=e.value,r.innerText=e.linkLabel||(0,d.skipHTTPS)(e.value)||"",i.appendChild(r)}else i.innerText=e.value||"";f.appendChild(i)})),t.formColumns>2&&(t.formColumns=2);var m=t.forms[i],v=(0,l.createIconButton)({css:["".concat(o,"-item"),"".concat(o,"-item-form-toggle")],icon:u.iconChevronDown,iconCss:[],title:m.title||""});f.appendChild(v);var b="".concat(c.SDK_NAME,"-none"),_="".concat(c.SDK_NAME,"-rotate-180"),y=(0,a.getFormItem)(m.fields,t.formColumns);h(y,b);var T=!1;f.onclick=function(){T?(h(y,b),p(v,_)):(p(y,b),h(v,_)),T=!T},r.appendChild(f),r.appendChild(y)})),e.prototype.getContent.call(this,i)},t}(r.C2SQLBaseMessageComponent);t.TableFormMessageComponent=f},1597:function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.FeedbackComponent=void 0;var r=n(9297),s=n(523),a=n(1489),c=n(1389),l=a.createDiv,u=function(e){function t(t,n,o,i,r,s,a){var c=e.call(this,t,n,o,i,r,s,a)||this;return c.currentRating=0,c.payloadActions=n.actions,c.ratingId=i.getTime(),c}return i(t,e),t.prototype.focusFirstAction=function(){this.ratingActions[0].focus()},t.prototype.disableActions=function(){this.setDisabled(!0),e.prototype.disableActions.call(this)},t.prototype.disablePostbacks=function(){this.setDisabled(!0),e.prototype.disablePostbacks.call(this)},t.prototype.enableActions=function(){this.setDisabled(!1),e.prototype.enableActions.call(this)},t.prototype.enablePostbacks=function(){this.setDisabled(!1),e.prototype.enablePostbacks.call(this)},t.prototype.highlightRating=function(e){for(var t=0;t<this.actions.length;t++){var n=t+1;"string"==typeof e&&(e=this.getValidRating(e)),e&&n<=e||0===e&&n<=this.currentRating?(0,a.addCSSClass)(this.ratingActions[t],"oda-chat-active"):(0,a.removeCSSClass)(this.ratingActions[t],"oda-chat-active")}},t.prototype.getActions=function(){var e=this,t=this.settings,n=t.i18n[t.locale].ratingStar,o=l(["rating-wrapper"]);this.ratingActions=this.payloadActions.map((function(i){var r=(0,a.createElement)("input",["star-input","rating-hidden"]);r.id="rating-".concat(i.label,"-").concat(e.ratingId),r.type="radio",r.name="rating-".concat(e.ratingId),r.value=i.label;var s=(0,a.createElement)("label",["star-label"]);s.htmlFor="rating-".concat(i.label,"-").concat(e.ratingId),s.setAttribute("data-rating",i.label);var l=(0,a.createElement)("span",["rating-hidden"]),u=n.replace("{0}","".concat(i.label));l.innerText=u;var d=t.icons&&t.icons.rating||c.iconRating,h=(0,a.createImageIcon)({icon:d,title:u,iconCss:["rating-star-icon"]});return s.appendChild(l),s.appendChild(h),r.onfocus=function(){r.disabled||(e.currentRating=e.getRatingStarsAndHighlight(r))},r.onkeydown=function(t){"Enter"===t.key&&e.submitRating(i)},s.onclick=function(){r.disabled||(e.currentRating=e.getRatingStarsAndHighlight(s),e.submitRating(i))},s.onmouseover=function(){r.disabled||e.getRatingStarsAndHighlight(s)},s.onmouseleave=function(){r.disabled||e.getRatingStarsAndHighlight(null)},o.appendChild(r),o.appendChild(s),r})),this.currentRating&&this.getRatingStarsAndHighlight(null);var i=l(["rating-root"]);return i.appendChild(o),i},t.prototype.setDisabled=function(e){this.ratingActions&&this.ratingActions.forEach((function(t){t.disabled=e}))},t.prototype.submitRating=function(e){var t={getPayload:function(){return r.default.resolve(e.postback)},label:e.label,type:e.type};this.handleOnActionClick(t)},t.prototype.getRatingStarsAndHighlight=function(e){var t=0;if(e){var n=e.value?e.value:null==e?void 0:e.getAttribute("data-rating");t=n?parseInt(n,10):0}return this.highlightRating(t),t},t.prototype.getValidRating=function(e){var t=0;if(e.match(/^\d+$/)){var n=parseInt(e,10);n>0&&n<=this.actions.length&&(t=n)}return t},t}(s.TextMessageComponent);t.FeedbackComponent=u},523:function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.TextMessageComponent=void 0;var r=n(5949),s=n(3145),a=n(1489),c=function(e){function t(t,n,o,i,r,s,a){var c=e.call(this,t,n,o,i,r,s,a)||this;return c.options=a,c._text=n.text,c}return i(t,e),t.prototype.getContent=function(){var t=this,n=t.settings,o=(0,a.createDiv)();return o.innerHTML=(0,r.linkify)(t._text,{emHTML:t.side===s.MESSAGE_SIDE.LEFT,emVideo:!0}),n.linkHandler?r.utils.setEmbeddedLinksHandler(o,n.linkHandler):n.openLinksInNewWindow&&r.utils.setLinksOpenInNewWindow(o),(0,r.setEmbeddedWebViewLinksHandler)(o,t.options.webviewLinkHandler),e.prototype.getContent.call(this,o)},t}(s.MessageComponent);t.TextMessageComponent=c},7332:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TypingIndicatorComponent=void 0;var o=n(1389),i=n(1489),r=i.createDiv,s=function(){function e(e,t){var n,i;this.side=e,this.settings=t,this.svgString=o.iconTypingIndicator,(null===(n=this.settings.colors)||void 0===n?void 0:n.conversationBackground)&&(this.svgString=this.svgString.replace(/#fff/gi,this.settings.colors.conversationBackground)),(null===(i=this.settings.colors)||void 0===i?void 0:i.typingIndicator)&&(this.svgString=this.svgString.replace(/#d1d1d1/gi,this.settings.colors.typingIndicator)),this.element=this.render(),this.visible=!1}return e.prototype.append=function(e){var t=this;this.isVisible()||(e.appendChild(this.element),this.visible=!0,this.timeoutID&&clearTimeout(this.timeoutID),this.timeoutID=window.setTimeout((function(){t.remove()}),1e3*this.settings.typingIndicatorTimeout))},e.prototype.remove=function(){this.isVisible()&&(this.element.remove(),this.visible=!1)},e.prototype.isVisible=function(){return this.visible},e.prototype.render=function(){var e=this.settings,t=r(["message",this.side]),n=r(["bubble-wrapper"]);n.setAttribute("aria-live","off"),n.setAttribute("aria-hidden","true");var o=e.icons.typingIndicator||this.svgString,s=e.i18n[e.locale].typingIndicator,a=(0,i.createImageIcon)({icon:o,title:s});return a.style.height=e.chatBubbleIconHeight||a.style.height,a.style.width=e.chatBubbleIconWidth||a.style.width,n.appendChild(a),t.appendChild(n),t},e}();t.TypingIndicatorComponent=s},3915:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.css=void 0;var o=n(9158),i=n(5192),r=n(6097),s=n(2146),a=n(6819),c=n(9238),l=n(8167),u=n(120),d=n(4121),h=""+o+s+i+r+a+c+l+u+n(4243)+d+n(8114)+n(1920)+n(8826)+n(5109);t.css=h},6693:function(e,t,n){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.StyleComponent=void 0;var i=n(1489),r=n(4534),s=n(1001),a=n(3915),c=function(){function e(e){this.settings=e,this.setWidgetTheme()}return e.prototype.addStyle=function(t){e.STYLE=e.STYLE+t},e.prototype.setWidgetCssClasses=function(){var e,t,n,o,i,r,s=":focus:enabled",a=":hover:enabled",c="wrapper",l="widget",u="button",d="notification-badge",h="header-button",p="message-actions .action-postback",g="message-global-actions .action-postback",f="card-actions .action-postback",m="round",v="share-popup-item",b="".concat(v).concat(":hover"," .").concat(v,"-icon"),_="".concat(v).concat(":focus"," .").concat(v,"-icon"),y=[],T=[],C=[],S=[],w=[],E=[],x=[],A=[],O=[],I=[],M=[],k=[],P=[],L=[],N=[],D=[],B=[],R=[],F=[],V=[],H=[],U=[],z=[],Y=[],j=[],W=[],G=[],K=[],q=[],Z=[],J=[],X=[],Q=[],$=[],ee=[],te=[],ne=[],oe=[],ie=[],re=[],se=[],ae=[],ce="background-color: ",le="border-color: ",ue="bottom: ",de="fill: ",he="outline-color: ",pe="left: ",ge="right: ",fe="color: ",me="top: ",ve=function(e,t){var n="";return(null==t?void 0:t.length)>0&&(n="."+e+" {\n",t.forEach((function(e){n+="  "+e+";\n"})),n+="}\n\n"),n},be=function(e){return ve(e,["display: none"])},_e="",ye="@media screen and (min-width: 426px) {\n";if(this.settings.enableHeadless)return _e+=be(c),_e+=be(l),_e+=be(u),_e+=be(d);if(this.settings.colors){var Te=this.settings.colors;if(Te.recognitionViewButtonFill=Te.recognitionViewButtonFill||Te.footerButtonFill,Te.actionsBackground&&P.push(ce+Te.actionsBackground),Te.actionsBackgroundFocus&&D.push(ce+Te.actionsBackgroundFocus),Te.actionsBackgroundHover&&B.push(ce+Te.actionsBackgroundHover),Te.actionsBorder?(P.push(le+Te.actionsBorder),P.push("border-style: solid"),P.push("border-width: 1px")):P.push("border-style: none"),Te.actionsText&&P.push(fe+Te.actionsText),Te.actionsTextFocus&&D.push(fe+Te.actionsTextFocus),Te.actionsTextHover&&B.push(fe+Te.actionsTextHover),Te.botMessageBackground&&(M.push(ce+Te.botMessageBackground),G.push(ce+Te.botMessageBackground)),Te.botText){var Ce=fe+Te.botText;M.push(Ce),H.push(Ce),K.push(Ce),Z.push(de+Te.botText)}if(Te.ratingStar&&(_e+=ve("star-input+label>svg>path",[de+Te.ratingStar])),Te.branding){var Se=[he+Te.branding];_e+=ve("footer-button:focus:enabled",Se),C.push(ce+Te.branding),ne.push(de+Te.branding),X.push(de+Te.branding),$.push("caret-color: "+Te.branding),Te.visualizer||(Te.visualizer=Te.branding),_e+=ve("star-input.active+label>svg>path",[de+(Te.ratingStarFill?Te.ratingStarFill:Te.branding)]),_e+=ve("right .message-bubble a",[fe+Te.branding])}Te.cardBackground&&H.push(ce+Te.cardBackground),Te.cardNavButton&&z.push(ce+Te.cardNavButton),Te.cardNavButtonFocus&&Y.push(ce+Te.cardNavButtonFocus),Te.cardNavButtonHover&&j.push(ce+Te.cardNavButtonHover),Te.conversationBackground&&I.push(ce+Te.conversationBackground),Te.footerBackground&&(Q.push(ce+Te.footerBackground),Te.inputBackground||$.push(ce+Te.footerBackground),Te.footerBackground===Te.conversationBackground&&Q.push("border-top: 1px solid #dadada")),Te.footerButtonFill&&ee.push(de+Te.footerButtonFill),Te.footerInlineButtonFill&&se.push(de+Te.footerInlineButtonFill),Te.globalActionsBackground&&(R.push(ce+Te.globalActionsBackground),R.push("border-style: solid"),R.push("border-width: 1px")),Te.globalActionsBackgroundFocus&&F.push(ce+Te.globalActionsBackgroundFocus),Te.globalActionsBackgroundHover&&V.push(ce+Te.globalActionsBackgroundHover),Te.globalActionsBorder&&R.push(le+Te.globalActionsBorder),Te.globalActionsText&&R.push(fe+Te.globalActionsText),Te.globalActionsTextFocus&&F.push(fe+Te.globalActionsBackgroundFocus),Te.globalActionsTextHover&&V.push(fe+Te.globalActionsTextHover),Te.headerBackground||(Te.headerBackground=Te.branding),Te.headerBackground&&(Ce=ce+Te.headerBackground,w.push(Ce),E.push(Ce),O.push(Ce),Te.recognitionViewBackground||(ie.push(Ce),re.push(Ce)),L.push(le+Te.headerBackground),L.push(fe+Te.headerBackground),N.push(ce+Te.headerBackground)),Te.headerButtonFill&&(x.push(de+Te.headerButtonFill),_e+=ve("header-button:focus:enabled",[he+Te.headerButtonFill]),O.push(he+Te.headerButtonFill)),Te.headerText&&(A.push(fe+Te.headerText),O.push(fe+Te.headerText),N.push(fe+Te.headerText)),Te.inputBackground?$.push(ce+Te.inputBackground):Te.footerBackground&&$.push(ce+Te.footerBackground),Te.inputText&&$.push(fe+Te.inputText),Te.links&&W.push(fe+Te.links),Te.notificationBadgeBackground&&S.push(ce+Te.notificationBadgeBackground),Te.notificationBadgeText&&S.push(fe+Te.notificationBadgeText),Te.recognitionViewBackground&&(ie.push(ce+Te.recognitionViewBackground),re.push(ce+Te.recognitionViewBackground)),Te.recognitionViewButtonFill&&ae.push(de+Te.recognitionViewButtonFill),Te.recognitionViewText&&re.push(fe+Te.recognitionViewText),Te.shareMenuText&&te.push(fe+Te.shareMenuText),Te.text&&(Ce=fe+Te.text,y.push(Ce),Te.botText||M.push(Ce),Te.userText||k.push(Ce),Te.recognitionViewText||re.push(Ce),Te.shareMenuText||te.push(Ce)),Te.textLight&&U.push(fe+Te.textLight),Te.timestamp&&q.push(fe+Te.timestamp),Te.userMessageBackground&&(k.push(ce+Te.userMessageBackground),Te.visualizerContainerBackground||oe.push(ce+Te.userMessageBackground)),Te.userText&&(k.push(fe+Te.userText),J.push(de+Te.userText)),Te.visualizerContainerBackground&&oe.push(ce+Te.visualizerContainerBackground)}if(this.settings.font){var we="font: "+this.settings.font;re.push(we),y.push(we),M.push(we),k.push(we)}if(this.settings.fontFamily){var Ee="font-family: ".concat(this.settings.fontFamily);$.push(Ee),re.push(Ee),y.push(Ee),M.push(Ee),k.push(Ee),P.push(Ee),R.push(Ee)}return this.settings.embedded||((null===(e=this.settings.position)||void 0===e?void 0:e.bottom)&&(y.push(ue+this.settings.position.bottom),T.push("bottom: -"+this.settings.position.bottom)),(null===(t=this.settings.position)||void 0===t?void 0:t.right)&&(y.push(ge+this.settings.position.right),T.push("right: -"+this.settings.position.right)),this.settings.badgePosition.bottom&&S.push(ue+this.settings.badgePosition.bottom),this.settings.badgePosition.left&&S.push(pe+this.settings.badgePosition.left),this.settings.badgePosition.right&&S.push(ge+this.settings.badgePosition.right),this.settings.badgePosition.top&&S.push(me+this.settings.badgePosition.top)),_e+=ve(c,y),_e+=ve(l,T),_e+=ve(u,C),_e+=ve(d,S),_e+=ve("header",w),_e+=ve(h,E),_e+=ve("header-button svg",x),_e+=ve("header, .title, .subtitle",A),_e+=ve("language-selection",O),_e+=ve("conversation",I),_e+=ve("left .message-bubble, .left .message-header, .left .message-footer",M),_e+=ve("right .message-bubble",k),_e+=ve(p,P),_e+=ve(p+s,D),_e+=ve(p+a,B),_e+=ve(g,R),_e+=ve(g+s,F),_e+=ve(g+a,V),_e+=ve("dialog .action-postback",L),_e+=ve("dialog .action-postback.filled",N),_e+=ve("card",H),_e+=ve("card-description",U),_e+=ve(f,P),_e+=ve(f+s,D),_e+=ve(f+a,B),_e+=ve(m,z),_e+=ve("round:focus:enabled",Y),_e+=ve("round:hover:enabled",j),_e+=ve("left .message-bubble a",W),_e+=ve("status-message-wrapper",G),_e+=ve("status-message",K),_e+=ve("relative-timestamp, .timestamp-header, .message-date",q),_e+=ve("left .attachment-control-icon svg, .attachment-icon",Z),_e+=ve("right .attachment-control-icon svg, .attachment-icon",J),_e+=ve("message-content .attachment-control-icon:hover svg",X),_e+=ve("message-content .attachment-control-icon:focus svg",X),_e+=ve("footer",Q),_e+=ve("user-input",$),_e+=ve("footer-button svg",ee),_e+=ve(v,te),_e+=ve("footer-button:hover:enabled .footer-button-svg-icon",ne),_e+=ve(b,ne),_e+=ve(_,ne),_e+=ve("footer-visualizer-wrapper",oe),_e+=ve("footer-recognition-wrapper",ie),_e+=ve("recognition-text-view",re),_e+=ve("footer-button.button-send-inline svg",se),_e+=ve("button-switch-kbd .footer-button-svg-icon",ae),y.splice(0,y.length),T.splice(0,T.length),this.settings.embedded||(T.push("border-radius: 4px"),(null===(n=this.settings.position)||void 0===n?void 0:n.bottom)&&(y.push(ue+this.settings.position.bottom),T.push("bottom: 0"),T.push("max-height: calc(100vh - "+this.settings.position.bottom+" - 60px)")),(null===(o=this.settings.position)||void 0===o?void 0:o.left)&&y.push(pe+this.settings.position.left),(null===(i=this.settings.position)||void 0===i?void 0:i.right)&&(y.push(ge+this.settings.position.right),T.push("right: 0"),T.push("max-width: calc(100vw - "+this.settings.position.right+")")),(null===(r=this.settings.position)||void 0===r?void 0:r.top)&&y.push(me+this.settings.position.top),this.settings.height&&T.push("height: "+this.settings.height),this.settings.width&&T.push("width: "+this.settings.width)),ye+=ve(c,y),ye+=ve(l,T),_e+(ye+="}\n")},e.prototype.render=function(){var t=(0,i.createElement)("style");return t.appendChild(document.createTextNode(e.STYLE.replace(/(\.)([a-zA-Z_-]+)(?=[^}]+{)/gi,"$1".concat(r.Constants.SDK_NAME,"-$2")))),t},e.prototype.setWidgetTheme=function(){switch(this.preInitColors(),this.settings.theme){case s.IWidgetTheme.CLASSIC:this.settings.colors=o(o({},e.THEME_CLASSIC),this.settings.colors);break;case s.IWidgetTheme.DEFAULT:this.settings.colors=o(o({},e.THEME_DEFAULT),this.settings.colors);break;case s.IWidgetTheme.REDWOOD_DARK:this.settings.colors=o(o({},e.THEME_REDWOOD_DARK),this.settings.colors);break;default:this.settings.colors=o(o({},e.THEME_DEFAULT),this.settings.colors)}},e.prototype.preInitColors=function(){var e,t,n,o;this.settings.colors.branding&&(this.settings.colors.headerBackground=null!==(e=this.settings.colors.headerBackground)&&void 0!==e?e:this.settings.colors.branding),this.settings.colors.text&&(this.settings.colors.inputText=null!==(t=this.settings.colors.inputText)&&void 0!==t?t:this.settings.colors.text,this.settings.colors.botText=null!==(n=this.settings.colors.botText)&&void 0!==n?n:this.settings.colors.text,this.settings.colors.userText=null!==(o=this.settings.colors.userText)&&void 0!==o?o:this.settings.colors.text)},e.STYLE=a.css,e.THEME_REDWOOD_DARK={branding:"#c0533f",text:"#161513",textLight:"#fcfbfa",headerBackground:"#201e1c",headerButtonFill:"#fff",headerText:"#fff",conversationBackground:"#3a3631",timestamp:"#fcfbfa",typingIndicator:"#fff",botMessageBackground:"#655f5c",botText:"#fff",userMessageBackground:"#fff",userText:"#161513",cardBackground:"#655f5c",cardNavButton:"#d5b364",cardNavButtonFocus:"#f7e0a1",cardNavButtonHover:"#b39554",actionsBackground:"#655f5c",actionsBackgroundFocus:"rgba(22, 21, 19, 0.5)",actionsBackgroundHover:"rgba(22, 21, 19, 0.3)",actionsBorder:"#fff",actionsText:"#fff",globalActionsBackground:"#3a3631",globalActionsBackgroundFocus:"rgba(22, 21, 19, 0.3)",globalActionsBackgroundHover:"rgba(32, 30, 28, 0.3)",globalActionsBorder:"#fff",globalActionsText:"#fff",links:"#f7e0a1",ratingStar:"#ececec",ratingStarFill:"#f0cc71",footerBackground:"#201e1c",footerButtonFill:"#fff",footerInlineButtonFill:"#1a1816",inputBackground:"#fcfbfa",inputText:"#161513",recognitionViewText:"#fff",visualizer:"#cbe9d6",visualizerContainerBackground:"#312d2a",notificationBadgeBackground:"#312d2a",notificationBadgeText:"#fff"},e.THEME_DEFAULT={branding:"#025e7e",text:"#161513",textLight:"#3a3631",headerBackground:"#025e7e",headerButtonFill:"#fff",headerText:"#fff",conversationBackground:"#fff",timestamp:"#5b5652",typingIndicator:"#227e9e",botMessageBackground:"#e5f1ff",userMessageBackground:"#ececec",cardBackground:"#fcfbfa",cardNavButton:"#4190ac",cardNavButtonFocus:"#5fa2ba",cardNavButtonHover:"#0e7295",actionsBackground:"#025e7e",actionsBackgroundFocus:"#053242",actionsBackgroundHover:"#06485f",actionsBorder:"#025e7e",actionsText:"#fff",globalActionsBackground:"#fff",globalActionsBackgroundFocus:"#053242",globalActionsBackgroundHover:"#025e7e",globalActionsBorder:"#0e7295",globalActionsText:"#0e7295",links:"#0e7295",ratingStar:"#fff",ratingStarFill:"#f0cc71",footerBackground:"#fff",inputBackground:"#fff",inputText:"#161513",recognitionViewButtonFill:"#fff",recognitionViewText:"#fff",notificationBadgeBackground:"#9a0007",notificationBadgeText:"#fff"},e.THEME_CLASSIC={branding:"#1b8fd2",text:"#212121",textLight:"#737373",conversationBackground:"#fff",footerBackground:"#fff",headerButtonFill:"#fff",timestamp:"#5b5652",botMessageBackground:"#e5f1ff",userMessageBackground:"#ececec",actionsBackground:"#0099ff",actionsBackgroundHover:"#005c99",globalActionsBackground:"#fff",globalActionsBackgroundHover:"#0099ff",globalActionsBorder:"#0099ff",globalActionsText:"#0099ff",globalActionsTextHover:"#fff",links:"#0770bf",ratingStar:"#fff",ratingStarFill:"#f0cc71",cardNavButtonHover:"#0099ff",recognitionViewButtonFill:"#fff",recognitionViewText:"#fff"},e}();t.StyleComponent=c},2466:function(e,t,n){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(1489),r=n(1389),s=n(5949),a=i.addCSSClass,c=i.createAnchor,l=i.createDiv,u=i.removeCSSClass,d=["no-referrer","no-referrer-when-downgrade","origin","origin-when-cross-origin","same-origin","strict-origin","strict-origin-when-cross-origin","unsafe-url"],h=["allow-downloads-without-user-activation","allow-downloads","allow-forms","allow-modals","allow-orientation-lock","allow-pointer-lock","allow-popups","allow-popups-to-escape-sandbox","allow-presentation","allow-same-origin","allow-scripts","allow-storage-access-by-user-activation","allow-top-navigation","allow-top-navigation-by-user-activation"],p="oda-chat-none",g=function(){function e(e){this.heightRatio=.8,this.props={closeButtonIcon:r.iconClose,closeButtonType:"icon",errorInfoBar:!0,referrerPolicy:"no-referrer-when-downgrade",sandbox:[],size:"tall"},this.isOpen=!1,this.isErrorViewOpen=!1,this.setProps(e||{})}return e.prototype.setProps=function(e){Array.isArray(e.sandbox)&&e.sandbox.length&&(e.sandbox=e.sandbox.map((function(e){return e.toLowerCase()})).filter((function(e){return-1!==h.indexOf(e)})));var t,n=o(o({},this.props),e);n.closeButtonIcon||(n.closeButtonIcon=this.props.closeButtonIcon),n.closeButtonType||(n.closeButtonType="icon"),n.size||(n.size="tall"),t=n.referrerPolicy,d.indexOf(null==t?void 0:t.toLowerCase())>=0||(n.referrerPolicy="no-referrer-when-downgrade"),this.heightRatio="full"===n.size?1:.8,this.props=n,this.render()},e.prototype.open=function(e){var t=this;this.component&&(this.component.style.height="".concat(100*this.heightRatio,"%"),u(this.component,"oda-chat-webview-container-close",p),a(this.component,"oda-chat-webview-container-open"),this.component.insertBefore(this.progressBar,this.webView),this.webView.onload=function(){t.progressBar.remove(),u(t.webView,p)},this.props.errorInfoBar&&setTimeout((function(){t.isOpen&&!t.isErrorViewOpen&&(t.errorView||(t.errorView=t.createErrorView()),e&&(t.errorAltLink.href=e),u(t.errorView,p),t.component.appendChild(t.errorView),t.isErrorViewOpen=!0)}),1e3),this.isOpen=!0)},e.prototype.close=function(){var e=this;this.isOpen=!1,u(this.component,"oda-chat-webview-container-open"),a(this.component,"oda-chat-webview-container-close"),this.removeErrorView(),this.webView.setAttribute("src",""),setTimeout((function(){a(e.component,p),u(e.webView,p)}),400)},e.prototype.render=function(){var t=this;this.component||(this.component=l(["webview-container"]),this.header=l(["header","webview-header"]),this.title=l(["title","webview-title"]),this.closeButton=(0,i.createButton)(["webview-button-close","title"]),this.progressBar=this.createProgressBar(),this.webView=(0,i.createElement)("iframe",["webview"]),this.webView.name=e.NAME,this.closeButton.onclick=function(){t.close()},this.header.appendChild(this.title),this.header.appendChild(this.closeButton),this.component.appendChild(this.header),this.component.appendChild(this.webView));var n=this.props;this.webView.title=n.accessibilityTitle,n.title&&(this.title.textContent=n.title),this.closeButton.innerHTML="";var o=(0,i.createIconButton)({css:[],icon:n.closeButtonIcon,iconCss:["webview-button-close-icon"],title:n.closeButtonLabel});switch(n.closeButtonType){case"icon":this.closeButton=o;break;case"label":this.closeButton.appendChild(document.createTextNode(n.closeButtonLabel));break;case"iconWithLabel":this.closeButton=o,this.closeButton.appendChild(document.createTextNode(n.closeButtonLabel))}return this.webView.setAttribute("referrerpolicy",n.referrerPolicy),this.props.sandbox.length&&this.props.sandbox.forEach((function(e){return t.webView.sandbox.add(e)})),this.closeButton.title=n.closeButtonLabel,a(this.component,p),this.component},e.prototype.createProgressBar=function(){var e=l(["progress-bar"]),t=l(["progress-bar-overlay"]);return e.appendChild(t),e},e.prototype.createErrorView=function(){var e=l(["webview-error"]);this.errorInfoText=l(["webview-error-text"]),e.appendChild(this.errorInfoText),this.setErrorTextWithLink(this.props.errorInfoText);var t=(0,i.createIconButton)({css:["webview-error-button-close","webview-button-close"],icon:this.props.closeButtonIcon,iconCss:[],title:this.props.errorInfoDismissLabel});return t.onclick=this.removeErrorView.bind(this),e.appendChild(t),e},e.prototype.setErrorTextWithLink=function(e){var t,n;e=(0,s.sanitizeText)(e);var o=/\{0\}(.*)\{\/0\}/g,i=null===(t=o.exec(e))||void 0===t?void 0:t[1];if(i){var r=c("",i,["webview-alt-link"]);n=e.replace((0,s.resetRegex)(o),r.outerHTML)}else n=c("",e,["webview-alt-link"]).outerHTML;this.errorInfoText.innerHTML=n,this.errorAltLink=this.errorInfoText.querySelector("a")},e.prototype.removeErrorView=function(){var e=this;this.isErrorViewOpen&&(a(this.errorView,p),setTimeout((function(){e.component.removeChild(e.errorView),e.isErrorViewOpen=!1}),600))},e.NAME="oda-chat-webview",e}();t.default=g},3884:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.isBotMessage=t.ISkillMessageSource=void 0,function(e){e.AGENT="AGENT",e.BOT="BOT"}(n||(n={})),t.ISkillMessageSource=n,t.isBotMessage=function(e){return!!e.from}},93:function(e,t,n){"use strict";var o=this&&this.__rest||function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]])}return n};Object.defineProperty(t,"__esModule",{value:!0}),t.createUserTextMessage=t.createUserMessage=t.createBotMessage=void 0;var i=n(6213);t.createBotMessage=function(e,t,n,o){return{date:n,from:e,isRead:o,messagePayload:t}},t.createUserMessage=function(e,t,n,i){var r,s;if(e.type?s={date:n,isRead:i,messagePayload:e}:e.messagePayload&&((s=e).date=s.date||n,s.isRead=void 0!==s.isRead?s.isRead:i),s&&(s.userId=t,null===(r=s.messagePayload)||void 0===r?void 0:r.metadata)){var a=s.messagePayload,c=a.metadata,l=o(a,["metadata"]);s.messagePayload=l,s.metadata=c}return s},t.createUserTextMessage=function(e,t){var n={text:e,type:i.PAYLOAD_TYPE.TEXT},o={date:new Date,isRead:!0,messagePayload:n};return t&&(o.sdkMetadata={speechId:t}),o}},7074:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ACTION_TYPE=void 0,function(e){e.CALL="call",e.LOCATION="location",e.POSTBACK="postback",e.SHARE="share",e.URL="url",e.WEBVIEW="webview"}(n||(n={})),t.ACTION_TYPE=n},6737:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ATTACHMENT_TYPE=void 0,function(e){e.IMAGE="image",e.VIDEO="video",e.AUDIO="audio",e.FILE="file"}(n||(n={})),t.ATTACHMENT_TYPE=n},4347:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.LAYOUT=void 0,function(e){e.HORIZONTAL="horizontal",e.VERTICAL="vertical"}(n||(n={})),t.LAYOUT=n},6213:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.isIMessagePayload=t.PAYLOAD_TYPE=void 0,function(e){e.TEXT="text",e.CARD="card",e.ATTACHMENT="attachment",e.LOCATION="location",e.RAW="raw",e.POSTBACK="postback",e.PROFILE="profile",e.ERROR="error",e.SUGGEST="suggest",e.CLOSE_SESSION="closeSession",e.SESSION_CLOSED="sessionClosed",e.Table="table",e.Form="form",e.TableForm="tableForm"}(n||(n={})),t.PAYLOAD_TYPE=n,t.isIMessagePayload=function(e){return"type"in e}},6831:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.TOKEN_TYPE=void 0,function(e){e.JWT="jwt"}(n||(n={})),t.TOKEN_TYPE=n},7525:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PONG_DELIVERY_CONFIRMATION_INTERVAL=t.PING_PONG_INTERVAL=t.isPongMessage=t.buildPingMessage=t.buildAuthTokenMessage=void 0;var o=n(185);t.buildAuthTokenMessage=function(e,t){return{state:{token:t,tokenType:e,type:o.STATE_TYPE.AUTH}}},t.buildPingMessage=function(){return{state:{type:o.STATE_TYPE.PING}}},t.isPongMessage=function(e){return e.state&&e.state.type&&e.state.type===o.STATE_TYPE.PONG},t.PING_PONG_INTERVAL=3e4,t.PONG_DELIVERY_CONFIRMATION_INTERVAL=5e3},185:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.STATE_TYPE=void 0,function(e){e.AUTH="auth",e.PING="ping",e.PONG="pong"}(n||(n={})),t.STATE_TYPE=n},330:function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.SENDER_TYPE=void 0,function(e){e.BOT="bot",e.USER="user"}(n||(n={})),t.SENDER_TYPE=n},2257:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AuthTokenService=void 0;var o=n(9297),i=n(5949),r=n(1639),s=function(e){return new Error("".concat("Invalid Token."," ").concat(e))},a=function(e){var t=Math.floor((Date.now()+2e5)/1e3);return e.getClaim("exp")>t},c=function(e,t,n){if(null==n)throw s("Claim '".concat(e,"' is not passed."));if(typeof n!==t)throw s("Claim '".concat(e,"' must be of type '").concat(t,"'."));if("number"==typeof n){if(n<=0)throw s("Value passed for claim '".concat(e,"' must be positive."))}else if(!n.length)throw s("String passed for claim '".concat(e,"' can not be empty."))},l=function(){function e(){}return e.getInstance=function(){return e.service||(e.service=new e),e.service},e.prototype.getToken=function(){var e=this;return this.currentToken&&a(this.currentToken)?o.default.resolve(this.currentToken):new o.default((function(t,n){o.default.resolve(e.method()).then((function(o){e.currentToken=new r.JWT(o);try{if(function(e){if(!e)throw s("No token passed.");var t=e.getClaim("iat");c("iat","number",t);var n=e.getClaim("exp");if(c("exp","number",n),n<=t)throw s("Value of claim 'exp' must be greater than that of claim 'iat'.");var o=e.getClaim("channelId");c("channelId","string",o);var i=e.getClaim("userId");c("userId","string",i)}(e.currentToken),!a(e.currentToken))throw s("Token is expired.");t(e.currentToken)}catch(e){n(e)}}))}))},e.prototype.resetToken=function(){this.currentToken=void 0},e.prototype.setFetchMethod=function(e){if(!(0,i.isFunction)(e))throw this.getToken=function(){return o.default.reject(new Error("JWT generator is not a function."))},new Error("'generateAuthToken' is not a function. Create a function that returns a Promise that resolves to a new JWT when called.");this.method=e},e}();t.AuthTokenService=l},9757:function(e,t,n){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.ChatServerService=void 0;var i=n(9297),r=n(7632),s=n(4534),a=n(8674),c=n(5949),l=n(3729),u=n(8656),d=n(6137),h=n(9978),p=n(8798),g=n(1001),f=n(3884),m=n(93),v=n(6737),b=n(6213),_=n(330),y=n(2601),T=n(2257),C=n(7234),S=n(466),w=function(){function e(e,t,n){var o=this;if(this._speechService=n,this._uploadRequest=[],this._requestId=0,this._logger=new p.Logger("ChatServerService"),this.onMessage=function(e,t){},this.onStatusChange=function(e){},this.onSuggestions=function(e){},this.onOriginalMessage=function(e){},this.onFinalSentMessage=function(e){},this._config=this._mergeSettings(d.defaultSettings,e),this._configureLinkHandler(),this._configureStorage(),this._configureLocale(),this._config.icons=function(e){var t=e.icons||{};for(var n in E){var o=n,i=E[o];o in t?t[o]=t[o]:i in e&&(t[o]=e[i])}return t}(this._config),this._i18nText=this._config.i18n[this._config.locale],p.Logger.logLevel=this._config.isDebugMode?p.Logger.LOG_LEVEL.DEBUG:p.Logger.LOG_LEVEL.ERROR,p.Logger.appName=s.Constants.SDK_NAME,p.Logger.appVersion=s.SDK_VERSION,window.addEventListener("online",(function(){return o.openConnection()})),window.addEventListener("offline",(function(){return o.closeConnection()})),t){this._authTokenService=T.AuthTokenService.getInstance();try{this._authTokenService.setFetchMethod(t)}catch(e){this._logger.error(e)}}this.eventDispatcher=(0,a.generateEventDispatcher)()}return e.prototype.on=function(e,t){this.eventDispatcher.bind(e,t)},e.prototype.connect=function(){var e=this;if(this._config.clientAuthEnabled)return this._authTokenService.getToken().then((function(t){try{e._configureParams(t)}catch(e){return i.default.reject(e.message)}return e._url=e._setupWebSocketURI(),e._open()})).catch((function(t){throw e._logger.error(t.message),t}));try{this._configureParams()}catch(e){return i.default.reject(e.message)}return this._url=this._setupWebSocketURI(),this._open()},e.prototype.uploadAttachment=function(e,t,n,o){var r=this;return new i.default((function(i,a){if(r._config.enableAttachment){r._logger.debug("upload attachment to chat server",e);var c=new FormData;c.append("attachment",e,encodeURI(e.name));var l=new XMLHttpRequest,u=r._requestId++;r._uploadRequest.push({id:u,request:l}),l.onreadystatechange=function(){if(4===l.readyState)switch(l.status){case s.Constants.ATTACHMENT_STATUS.OK:var c=JSON.parse(l.responseText),d={attachment:{type:r._getAttachmentType(c.type.split("/")[0].toLowerCase()),url:c.url},type:b.PAYLOAD_TYPE.ATTACHMENT},h=(0,m.createUserMessage)(d,r._config.userId,new Date,!0);r.send(h,n,c.fileName),i(c);break;case s.Constants.ATTACHMENT_STATUS.ERROR_FILE_SIZE_LIMIT_EXCEEDED:t&&t(e.name,l.status,n),a(r._i18nText.uploadFileSizeLimitExceeded);break;case s.Constants.ATTACHMENT_STATUS.ERROR_UNSUPPORTED_FILE_TYPE:t&&t(e.name,l.status,n),a(r._i18nText.uploadUnsupportedFileType);break;default:o?r._retryUploadingFile(e,t,n).then((function(e){i(e)})).catch((function(e){a(e)})):(t&&t(e.name,l.status,n),a(r._i18nText.uploadFailed))}r._uploadRequest=r._uploadRequest.filter((function(e){return e.id!==u}))},r.isConnectionOpen()?r._config.clientAuthEnabled?r._authTokenService.getToken().then((function(t){r._configureParams(t),r._pushUpload(l,e,c,t)}),(function(o){t&&t(e.name,l.status,n),r._logger.error("Upload failed. Could not get valid token.",o),a("Upload failed. Could not get valid token.")})):r._pushUpload(l,e,c):(t&&t(e.name,l.status,n),a("Upload failed. Not connected to server."))}else t&&t(e.name,null,n),a("Upload Failed. The enableAttachment feature is disabled.")}))},e.prototype.cancelUploadAttachments=function(){this._uploadRequest.forEach((function(e){e.request.abort()}))},e.prototype.getSuggestions=function(e){if(this._logger.debug("Get suggestions from chat server",e),this._ws.readyState===r.CONNECTION_STATE.OPEN){if(this._ws.send(e),e.profile)return}else this._logger.error("Can't get suggestions for the user query, WebSocket status - "+s.Constants.WEBSOCKET_READY_STATE[this._ws.readyState],e)},e.prototype.getMessages=function(){var e=this._storageService.getItem(this._chatStorageId);return e?JSON.parse(e).map((function(e){var t=new Date(e.date);return o(o({},e),{date:t})})):[]},e.prototype.loadChat=function(){var e=this.getMessages();return e.length&&(e.forEach((function(e){e.isRead=!0})),this._storageService.setItem(this._chatStorageId,JSON.stringify(e))),e},e.prototype.getUnreadMessagesCount=function(){return this.getMessages().filter((function(e){return e.from&&!e.isRead})).length},e.prototype.send=function(e,t,n,o){var i=!1;if(this._wsSend(e,o)){if(i=!0,e.profile)return i;if(e.messagePayload&&e.messagePayload.type===b.PAYLOAD_TYPE.POSTBACK){var r=(0,m.createUserMessage)({text:e.messagePayload.text,type:b.PAYLOAD_TYPE.TEXT},this._config.userId,new Date,!0);r.userId=this._config.userId,(null==o?void 0:o.hidden)||(this._saveMessage(r),this.onMessage(r))}else n&&(e.messagePayload.attachment.fileName=n),(null==o?void 0:o.hidden)||(this._saveMessage(e),this.onMessage(e,t))}else this._logger.error("Can't send message");return i},e.prototype.markAsRead=function(e){for(var t,n=(null===(t=e.getTime)||void 0===t?void 0:t.call(e))||new Date(e).getTime(),o=this.getMessages(),i=0,r=0,s=o;r<s.length;r++){var a=s[r];if(!a.isRead&&n===new Date(a.date).getTime()){a.isRead=!0,o[i]=a;break}i++}this._storageService.setItem(this._chatStorageId,JSON.stringify(o))},e.prototype.markAllAsRead=function(){var e=this.getMessages().map((function(e){return e.isRead=!0,e}));this._storageService.setItem(this._chatStorageId,JSON.stringify(e))},e.prototype.retryMessage=function(e){var t=e.messagePayload;if(this._latestUserMessage)this._latestUserMessage.date=new Date,this.send(this._latestUserMessage);else if(t&&t.postback.text){var n={text:t.postback.text,type:b.PAYLOAD_TYPE.TEXT},o=(0,m.createUserMessage)(n,this._config.userId,new Date,!0);this.send(o)}},e.prototype.getChatConfiguration=function(){return this._config},e.prototype.setSettingsProperty=function(e,t){this._config[e]=t},e.prototype.isConnectionOpen=function(){var e;return(null===(e=this._ws)||void 0===e?void 0:e.readyState)===r.CONNECTION_STATE.OPEN},e.prototype.isConnectionClosed=function(){return!this._ws||this._ws.readyState===r.CONNECTION_STATE.CLOSED},e.prototype.openConnection=function(){return this.isConnectionOpen()&&this.closeConnection(),this.connect()},e.prototype.closeConnection=function(e,t){var n;null===(n=this._ws)||void 0===n||n.close(e,t)},e.prototype.updateUser=function(e,t){this.send(e,null,null,t)},e.prototype.clearMessages=function(e,t){var n="".concat(s.Constants.SDK_NAME,"-").concat(e,"-messages");(t?window[t]:this._storageService).getItem(n)&&this._storageService.removeItem(n)},e.prototype.clearAllMessage=function(){var e=null===window||void 0===window?void 0:window.localStorage,t=(null==e?void 0:e.length)||0;if(t)for(var n=/oda-chat-.*-messages/g,o=0;o<t;o++){var i=e.key(o);(null==i?void 0:i.match(n))&&e.removeItem(i)}},e.prototype._configureParams=function(e){if(this._config.clientAuthEnabled?(this._config.channelId=e.getClaim("channelId"),this._config.userId=e.getClaim("userId")):this._config.userId=this._config.userId||this._generateUserId(),this._searchParams={channelId:this._config.channelId,userId:this._config.userId},!this._config.URI)throw new Error("URI not provided.");if(!this._config.channelId)throw new Error("channelId not provided.");if(!this._config.userId)throw new Error("userId not provided.");this._chatStorageId="".concat(s.Constants.SDK_NAME,"-").concat(this._config.userId,"-messages")},e.prototype._open=function(){var e=this;return new i.default((function(t,n){var o,i=!1;e._ws=new C.ReconnectingWebSocket(e._url,e._config.clientAuthEnabled?e._authTokenService:void 0,e._config.reconnectInterval,e._config.reconnectMaxAttempts,e._config.reconnectTimeout,e._config.enableLongPolling,e._config.upgradeToWebSocketInterval,e._setupLongPollingURI()),e._ws.onopen=function(){if(e._logger.debug("Connection established"),e._config.enableSpeech){var n={channelId:e._config.channelId,host:e._config.URI,locale:e._config.speechLocale,protocol:e._config.enableSecureConnection?"wss://":"ws:/",userId:e._config.userId};e._config.clientAuthEnabled?e._authTokenService.getToken().then((function(t){e._configureParams(t),e._speechService.init(e._config,n,e._authTokenService)})):e._speechService.init(e._config,n)}o=setTimeout((function(){i=!0,e.closeConnection()}),s.Constants.TIME.MIN_FIFTY),t()},e._ws.onmessage=e._wsMessage.bind(e),e._ws.onclose=function(t){e._logger.debug("Connection closed"),clearTimeout(o),i&&(e.openConnection(),i=!1);var r=(null==t?void 0:t.reason)?t.reason:"Connection to chat server could not be established. Closing the connection.";n(r)},e._ws.onstatuschange=function(t){e.eventDispatcher.trigger(S.ChatServerEvent.STATUS,t),e.onStatusChange(t)},e._ws.open()}))},e.prototype._pushUpload=function(e,t,n,o){var i=this._setupAttachmentURI();e.open("POST",i),e.setRequestHeader(s.Constants.ATTACHMENT_HEADER.FILE_SIZE,t.size.toString()),this._config.clientAuthEnabled&&(e.setRequestHeader(s.Constants.ATTACHMENT_HEADER.AUTHORIZATION,"Bearer "+o.token),this._config.enableAttachmentSecurity&&(e.setRequestHeader(s.Constants.ATTACHMENT_HEADER.FILE_IS_PROTECTED,"True"),e.setRequestHeader(s.Constants.ATTACHMENT_HEADER.FILE_AUTH_TYPE,"ChannelClientAuth"))),e.send(n)},e.prototype._retryUploadingFile=function(e,t,n){return this.uploadAttachment(e,t,n)},e.prototype._getAttachmentType=function(e){switch(e){case v.ATTACHMENT_TYPE.IMAGE:case v.ATTACHMENT_TYPE.VIDEO:case v.ATTACHMENT_TYPE.AUDIO:return e;default:return v.ATTACHMENT_TYPE.FILE}},e.prototype._generateUserId=function(){return"user".concat(Math.floor(1e4+9e4*Math.random())).concat(Date.now()%1e5)},e.prototype._setupLongPollingURI=function(){var e=(this._config.enableSecureConnection?"https://":"http://")+this._config.URI+"/chat/v1/chats/message";return c.utils.setSearchParams(e,this._searchParams)},e.prototype._setupWebSocketURI=function(){var e=(this._config.enableSecureConnection?"wss://":"ws://")+this._config.URI+"/chat/v1/chats/sockets/websdk";return c.utils.setSearchParams(e,this._searchParams)},e.prototype._setupAttachmentURI=function(){var e=(this._config.enableSecureConnection?"https://":"http://")+this._config.URI+"/chat/v1/attachments";return c.utils.setSearchParams(e,this._searchParams)},e.prototype._wsSend=function(t,n){this._logger.debug("Message to chat server",t.messagePayload);var o=!1;if(void 0===(n=n||{}).delegate&&(n.delegate=!0),n.delegate&&this._config.delegate&&t.messagePayload)if(e.USER_PAYLOAD_TYPES.indexOf(t.messagePayload.type)>=0&&this._config.delegate.beforeSend&&(0,c.isFunction)(this._config.delegate.beforeSend)){if(!(t=this._executeSendDelegate(t,this._config.delegate.beforeSend)))return o}else if(t.messagePayload.type===b.PAYLOAD_TYPE.POSTBACK&&this._config.delegate.beforePostbackSend&&(0,c.isFunction)(this._config.delegate.beforePostbackSend)&&!(t=this._executeSendDelegate(t,this._config.delegate.beforePostbackSend)))return o;return t.sdkMetadata?t.sdkMetadata.version=s.SDK_VERSION:t.sdkMetadata={version:s.SDK_VERSION},this._latestUserMessage=t,this._ws.readyState===r.CONNECTION_STATE.OPEN?o=this._ws.send(this._sanitizeText(this._latestUserMessage)):this._logger.error("Can't send message, WebSocket status - "+s.Constants.WEBSOCKET_READY_STATE[this._ws.readyState],t),t.messagePayload&&this.onFinalSentMessage(this._latestUserMessage),o},e.prototype._sanitizeText=function(e){var t,n=JSON.parse(JSON.stringify(e));if((null===(t=e.messagePayload)||void 0===t?void 0:t.type)===b.PAYLOAD_TYPE.TEXT){var o=n.messagePayload;o.text=(0,c.sanitizeText)(o.text),n.messagePayload=o}return n},e.prototype._executeSendDelegate=function(e,t){var n,o,i=JSON.parse(JSON.stringify(e)),r=JSON.parse(JSON.stringify(e));e.messagePayload.type===b.PAYLOAD_TYPE.TEXT&&(null===(n=e.sdkMetadata)||void 0===n?void 0:n.speechId)&&(o=(e.messagePayload.text||"").toLowerCase());try{r=t(i)}catch(e){this._logger.error(e)}if(r&&r.messagePayload||(r=null),r&&!(0,l.isValidMessage)(r,_.SENDER_TYPE.USER)&&(this._logger.error("The generated delegate message is invalid. Sending original message instead."),r=e),o&&r)if(r.messagePayload)if(r.messagePayload.type===b.PAYLOAD_TYPE.TEXT){var s=r.messagePayload.text;(null==s?void 0:s.toLowerCase().indexOf(o))<0&&delete r.sdkMetadata}else delete r.sdkMetadata;else delete r.sdkMetadata;return r},e.prototype._wsMessage=function(e){var t,n,o;this._logger.info("Message received: ",e);try{var i=JSON.parse(e);if((o=!!i.suggestions)||this.onOriginalMessage(JSON.parse(e)),!o&&(null===(t=this._config.delegate)||void 0===t?void 0:t.beforeDisplay)&&(0,c.isFunction)(this._config.delegate.beforeDisplay)){var r=JSON.parse(e),s=JSON.parse(e);try{s=this._config.delegate.beforeDisplay(r)}catch(e){this._logger.error(e)}if(!s||!s.messagePayload)return void this.onMessage(void 0);(0,l.isValidMessage)(s)?i=s:this._logger.error("The generated delegate message is invalid. Displaying original message instead.")}n=i}catch(t){n={date:new Date,isRead:!1,messagePayload:{type:b.PAYLOAD_TYPE.TEXT,text:e}}}o?this.onSuggestions(n):(n.from={type:_.SENDER_TYPE.BOT},n.from&&n.to&&delete n.from,n.date=new Date,n.isRead=!1,function(e,t){var n=function(e){for(var t=e.getMessages(),n=[],o=t.length-1;o>=0;o--){var i=t[o];if((0,f.isBotMessage)(i))break;n.push((0,h.getMessageDigest)(i))}return n}(t);return!n.length||n.indexOf((0,h.getMessageDigest)(e))<0}(n,this)&&(n.messagePayload.type!==b.PAYLOAD_TYPE.SESSION_CLOSED&&this._saveMessage(n),this.onMessage(n)))},e.prototype._saveMessage=function(e){var t=this.getMessages();t.length>=this._config.messageCacheSizeLimit&&t.splice(0,t.length-(this._config.messageCacheSizeLimit-1)),t.push(e),this._storageService.setItem(this._chatStorageId,JSON.stringify(t))},e.prototype._mergeSettings=function(e,t){var n=o(o({},e),t);if(t.i18n&&Object.keys(t.i18n).length){e.i18n=this._convertKeysToLowerCase(e.i18n),t.i18n=this._convertKeysToLowerCase(t.i18n);var i=new Set;Object.keys(e.i18n).forEach((function(e){i.add(e)})),Object.keys(t.i18n).forEach((function(e){i.add(e)})),n.i18n={},i.forEach((function(i){n.i18n[i]=o(o(o({},e.i18n.en),e.i18n[i]),t.i18n[i])}))}return n.colors=o(o({},e.colors),t.colors),n},e.prototype._convertKeysToLowerCase=function(e){for(var t={},n=0,o=Object.keys(e);n<o.length;n++){var i=o[n];t[i.toLowerCase()]=e[i]}return t},e.prototype._configureStorage=function(){this._config.userId?this._config.storageType!==g.StorageType.LOCAL&&this._config.storageType!==g.StorageType.SESSION&&(this._config.storageType=g.StorageType.LOCAL):this._config.storageType=g.StorageType.SESSION,this._storageService=new y.StorageService(this._config.storageType)},e.prototype.isLinkHandler=function(e){var t=!1;return e&&(e.target||e.onclick)&&(t=!0),t},e.prototype._configureLinkHandler=function(){var e=this._config.linkHandler,t=!0;this.isLinkHandler(e)&&(e.onclick&&"function"==typeof e.onclick?t=!1:this._config.linkHandler.onclick=void 0,e.target&&"string"==typeof e.target&&e.target.length?t=!1:this._config.linkHandler.target=void 0),t&&(this._config.linkHandler=void 0)},e.prototype._configureLocale=function(){var e=[];this._config.locale&&e.push(this._config.locale.toLowerCase()),(e=e.concat((0,u.getLocales)())).indexOf("en")<0&&e.push("en");for(var t=0,n=e;t<n.length;t++){var o=n[t];if(this._isLocaleTranslationExactMatch(o,this._config.i18n)){this._config.locale=o;break}if(this._isLocaleTranslationCloseMatch(o,this._config.i18n)){this._config.locale=o.split("-")[0];break}}this._config.speechLocale&&(this._config.speechLocale=this._config.speechLocale.toLowerCase())},e.prototype._isLocaleTranslationExactMatch=function(e,t){for(var n in e=e.toLowerCase(),t)if(e===n.toLowerCase())return!0;return!1},e.prototype._isLocaleTranslationCloseMatch=function(e,t){for(var n in e=e.toLowerCase().split("-")[0],t)if(e===n.toLowerCase())return!0;return!1},e.USER_PAYLOAD_TYPES=[b.PAYLOAD_TYPE.TEXT,b.PAYLOAD_TYPE.LOCATION,b.PAYLOAD_TYPE.ATTACHMENT],e}();t.ChatServerService=w;var E={avatarAgent:"agentAvatar",avatarBot:"botIcon",avatarUser:"personIcon",fileAudio:"audioIcon",fileImage:"imageIcon",fileGeneric:"fileIcon",fileVideo:"videoIcon",clearHistory:"clearMessageIcon",close:void 0,collapse:"closeIcon",download:"downloadIcon",error:"errorIcon",expandImage:"expandImageIcon",keyboard:"keyboardIcon",logo:"logoIcon",launch:"botButtonIcon",mic:"micIcon",rating:void 0,send:"sendIcon",shareMenu:"attachmentIcon",shareMenuAudio:void 0,shareMenuFile:void 0,shareMenuLocation:void 0,shareMenuVisual:void 0,ttsOff:"audioResponseOffIcon",ttsOn:"audioResponseOnIcon",typingIndicator:"chatBubbleIcon"}},466:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChatServerEvent=void 0,function(e){e.STATUS="status"}(t.ChatServerEvent||(t.ChatServerEvent={}))},1793:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SpeechRecognitionService=t.IVoiceRecognitionEvent=void 0;var o,i=n(9297),r=n(7927),s=n(7632),a=n(5544),c=n(5949),l=n(8656),u=n(1001);!function(e){e.FINAL_RESULT="finalResult",e.PARTIAL_RESULT="partialResult"}(o||(o={})),t.IVoiceRecognitionEvent=o;var d=function(){function e(){this.speechRoute="/voice/stream/recognize",this.speechDomain="generic",this.started=!1,this.BUFF_SIZE=4096,this.microphoneStreamBuffer=[],this.connectionStatus=s.CONNECTION_STATE.CLOSED,this.isFirstFrame=!0,this.filterBuffer=[],this.LP_48000_TO_16000_FIR=[-25033838264794034e-21,-3645156113737857e-20,-11489993827892933e-21,393243788874656e-19,6998419352067277e-20,37556691270439976e-21,-476966455345305e-19,-.00011379935461751734,-8400957697117619e-20,4208817777607469e-20,.00016391587447478332,.00015508372993570357,-1253765788919669e-20,-.00021258262011091092,-.0002524059896175195,-51874329668708116e-21,.0002479230009768214,.00037351534477673157,.00016157590781788105,-.0002541085239198603,-.000510486865332593,-.0003246104617540939,.00021219136947965464,.0006488877825604561,.0005444416935293036,-.0001016639071691704,-.0007673001147209819,-.0008176720912938691,-972696982411551e-19,.0008376185852528038,.0011319450250252222,.0004008193339799052,-.0008262743020160207,-.0014643282305934196,-.0008183365045047033,.0006964471772153777,.001780467922489105,.0013489288090360295,-.00041122152287042,-.0020347535966250413,-.0019782994815083733,-6247794246099269e-20,.002171643809964705,.0026761621389245617,.00074944268608935,-.00212817775887288,-.003394541347147186,-.0016615884301227524,.001837545335885159,.004067170702246546,.0027936171643976352,-.001233420727213658,-.004610035314537476,-.004119319153202972,.00025459137646049936,.00492286494534436,.005588805700369816,.001150762425755883,-.004891042781491068,-.0071267634777626675,-.003021979039818941,.00438688631315642,.008631467181982988,.005385139236634672,-.003268406079325266,-.009973661255235284,-.008256256502745316,.0013719935383757782,.010993210336541666,.011651337116264694,.0015082475865128093,-.01148872195209017,-.015609515327517686,-.005671504441670989,.011188303272599716,.02024519058502148,.011637590928971467,-.009667754909210324,-.025878090076785515,-.020500381603699786,.006098908137700642,.033428666116203716,.03513487017573178,.001719739622764723,-.046085580848361105,-.06623078150315037,-.023349941728869696,.08292213207159124,.21069217442624302,.2973829711397418,.2973829711397419,.21069217442624305,.08292213207159124,-.023349941728869693,-.06623078150315037,-.046085580848361105,.0017197396227647225,.03513487017573178,.033428666116203716,.006098908137700641,-.020500381603699783,-.025878090076785508,-.009667754909210326,.011637590928971469,.020245190585021472,.011188303272599716,-.00567150444167099,-.015609515327517682,-.01148872195209017,.001508247586512809,.011651337116264699,.010993210336541666,.0013719935383757782,-.008256256502745314,-.009973661255235283,-.0032684060793252657,.00538513923663467,.008631467181982988,.004386886313156419,-.0030219790398189413,-.0071267634777626675,-.0048910427814910715,.0011507624257558842,.005588805700369813,.00492286494534436,.00025459137646049936,-.004119319153202973,-.004610035314537475,-.0012334207272136583,.002793617164397636,.004067170702246546,.0018375453358851592,-.0016615884301227509,-.0033945413471471847,-.0021281777588728797,.0007494426860893505,.0026761621389245612,.0021716438099647056,-6247794246099253e-20,-.001978299481508373,-.0020347535966250404,-.00041122152287042,.0013489288090360292,.0017804679224891048,.0006964471772153777,-.0008183365045047026,-.00146432823059342,-.0008262743020160207,.0004008193339799063,.0011319450250252222,.0008376185852528037,-9726969824115494e-20,-.0008176720912938694,-.0007673001147209783,-.00010166390716916983,.0005444416935293033,.0006488877825604562,.0002121913694796546,-.00032461046175409424,-.000510486865332593,-.00025410852391986036,.0001615759078178811,.0003735153447767315,.00024792300097682137,-5187432966870808e-20,-.0002524059896175194,-.00021258262011091095,-1253765788919669e-20,.0001550837299357036,.0001639158744747833,42088177776074685e-21,-8400957697117623e-20,-.00011379935461751733,-4769664553453051e-20,3755669127044002e-20,699841935206728e-19,393243788874656e-19,-11489993827892933e-21,-3645156113737856e-20,-2503383826479402e-20],this.LP_44100_TO_16000_FIR=[-5044267067893139e-21,5738740247594612e-21,1611195555688156e-20,10560179594562795e-21,-1242816862904201e-20,-3084430704328611e-20,-18160396924882423e-21,2303124169528074e-20,5216612702894834e-20,2806026886746509e-20,-389608521587068e-19,-8174245278012476e-20,-4037543061985353e-20,619375276294956e-19,.00012143092661620545,55083199655424166e-21,-9401891583478883e-20,-.00017326981522755043,-7198069055926206e-20,.0001376274218691789,.00023946132645647525,9064030545698025e-20,-.00019557611633250834,-.0003223511502826996,-.00011036322783022617,.0002710935667931249,.00042440564349633953,.00013013140955365376,-.00036784896615780913,-.0005481886438481025,-.00014855826094166272,.0004899798946967381,.000696340560985472,.00016383778624615643,-.0006421263408051642,-.0008715631880363658,-.00017369118859371453,.000829476349448821,.0010766146787146871,.00017530890385814463,-.0010578310750603923,-.001314320458073489,-.0001652844648711556,.0013337004262191077,.0015876076783199174,.000139534308084411,-.0016644454627712116,-.001899573527380014,-9319422024995832e-20,.002058491185395933,.0022536018141979036,20477911370491685e-21,-.0025256449668619525,-.0026535487754524955,8552498376473957e-20,.0030775744811722015,.0031040297261921,-.00023314744969763122,-.003728529808331677,-.003610856230113392,.000432598472497653,.0044964472481822506,.004181705019767344,-.0006966685466235378,-.005404666489478738,-.00482715710731867,.0010418556659416306,.006484667519607787,.00556235368742558,-.0014902159613265254,-.007780573986407925,-.0064097301786953595,.002072517010858728,.009356870546119134,.0074037416266333166,-.00283386009764953,-.011312323822665827,-.008599512596140524,.003844300507349054,.013806774337071994,.01008985372973804,-.005220460312862638,-.01711716324115331,-.01204196749753927,.007174046245357611,.021768247992024713,.01478690833035584,-.010136389804721707,-.02888735624896028,-.019078400739739057,.015146805312378952,.041410446665863104,.027068163980255515,-.025512027260482153,-.07011218378743589,-.04829678433503421,.06041368701604651,.21199607414538668,.3213532652447261,.3213532652447261,.21199607414538668,.060413687016046526,-.04829678433503422,-.07011218378743589,-.025512027260482153,.027068163980255515,.041410446665863104,.015146805312378952,-.019078400739739057,-.02888735624896028,-.010136389804721703,.01478690833035584,.021768247992024713,.007174046245357611,-.01204196749753927,-.01711716324115331,-.005220460312862639,.010089853729738038,.013806774337071994,.0038443005073490553,-.008599512596140524,-.011312323822665827,-.0028338600976495314,.007403741626633317,.009356870546119134,.002072517010858727,-.006409730178695359,-.007780573986407925,-.001490215961326526,.005562353687425577,.006484667519607787,.0010418556659416256,-.004827157107318673,-.005404666489478739,-.0006966685466235378,.004181705019767345,.004496447248182251,.0004325984724976533,-.003610856230113392,-.003728529808331677,-.0002331474496976315,.0031040297261921003,.003077574481172201,8552498376473897e-20,-.002653548775452496,-.002525644966861952,2047791137049164e-20,.002253601814197904,.002058491185395933,-9319422024995909e-20,-.001899573527380014,-.0016644454627712118,.00013953430808441038,.0015876076783199174,.0013337004262191077,-.0001652844648711556,-.0013143204580734896,-.0010578310750603925,.00017530890385814333,.0010766146787146878,.0008294763494488195,-.00017369118859371463,-.00087156318803637,-.0006421263408051633,.00016383778624615698,.0006963405609854716,.0004899798946967381,-.00014855826094166245,-.0005481886438481027,-.00036784896615780924,.00013013140955365368,.00042440564349633964,.00027109356679312505,-.00011036322783022619,-.0003223511502826996,-.00019557611633250842,9064030545698017e-20,.00023946132645647525,.00013762742186917883,-7198069055926207e-20,-.0001732698152275505,-9401891583478886e-20,5508319965542416e-20,.00012143092661620549,6193752762949557e-20,-4037543061985352e-20,-8174245278012477e-20,-38960852158706805e-21,28060268867465078e-21,52166127028948336e-21,2303124169528077e-20,-18160396924882423e-21,-30844307043286126e-21,-12428168629042018e-21,10560179594562806e-21,1611195555688157e-20,5738740247594605e-21,-5044267067893138e-21],(0,l.setAudioContext)(),(0,l.polyfillUserMedia)()}return e.getInstance=function(){return this._service||(this._service=new e),this._service},e.prototype.init=function(e,t,n){var o=this;return this.settings=e,this.authTokenService=n,this.serverConfig=t,this.isClientAuthEnabled=!!n,new i.default((function(e,t){o.buildSpeechRequestUrl().then((function(t){o.requestUrl=t,e()})).catch((function(e){t(e)}))}))},e.prototype.startRecording=function(e,t,n){var o,d=this.settings.i18n[this.settings.locale];if(this.requestUrl?(0,c.getValues)(u.SPEECH_LOCALE).indexOf(this.serverConfig.locale)<0?o=d.errorSpeechUnsupportedLocale:!this.connection||this.connection.readyState!==s.CONNECTION_STATE.CLOSING&&this.connection.readyState!==s.CONNECTION_STATE.CONNECTING||(o=d.errorSpeechMultipleConnection):o=d.errorSpeechInvalidUrl,o)return i.default.reject(new Error(o));if(this.onSpeechRecognition=this.getCallbackImpl(e),this.onSpeechNetworkChange=this.getCallbackImpl(t),this.onAnalyserReady=this.getCallbackImpl(null==n?void 0:n.onAnalyserReady),this.onAnalyserFrequencies=this.getCallbackImpl(null==n?void 0:n.onAnalyserFrequencies),this.microphoneStreamBuffer=[],this._startPromise=new a.Deferred,this.isRecording())return this._startPromise.resolve();if((0,l.isUserMediaAvailable)())this.startRecordingWeb();else{if(!(0,r.isAudioInputAvailable)())return this._startPromise.reject(Error(d.errorSpeechUnavailable));this.startRecordingCordova()}return this._startPromise.promise},e.prototype.stopRecording=function(){this.connection?(this.stopMicrophone(),this.connection.readyState===s.CONNECTION_STATE.OPEN&&this.connection.close()):this.setConnectionStatus(s.CONNECTION_STATE.CLOSED)},e.prototype.setSpeechLocale=function(e){var t=this;this.serverConfig&&(this.serverConfig.locale=e,this.buildSpeechRequestUrl().then((function(e){t.requestUrl=e})))},e.prototype.isInitialized=function(){return!!this.settings},e.prototype.isRecording=function(){return this.started},e.prototype.getCallbackImpl=function(e){return e&&"function"==typeof e?e:function(){}},e.prototype.startRecordingWeb=function(){var e=this;navigator.mediaDevices.getUserMedia({audio:!0}).then((function(t){e.audioContext=new AudioContext,e.microphoneStream=e.audioContext.createMediaStreamSource(t),e.startMicrophone()})).catch((function(t){"NotAllowedError"===t.name&&(t=new Error(e.settings.i18n[e.settings.locale].errorSpeechUnavailable)),e._startPromise&&e._startPromise.reject(t)}))},e.prototype.startRecordingCordova=function(){var e=this;(0,r.stopAudioInput)().then((function(){return(0,r.getAudioInputUserMedia)({audioSourceType:r.AudioInputSourceType.VOICE_RECOGNITION,bufferSize:4096,streamToWebAudio:!0}).then((function(t){e.audioContext=(0,r.getAudioInput)().getAudioContext(),e.microphoneStream=t,e.startMicrophone()}))})).catch((function(t){e._startPromise&&e._startPromise.reject(t)}))},e.prototype.setRequestUrl=function(){var e=this.serverConfig,t=e.protocol,n=e.host,o=e.channelId,i=e.userId,r=e.locale,s=t+n+this.speechRoute+"/"+r+"/"+this.speechDomain,a={channelId:o,encoding:"audio/raw",userId:i};return this.isClientAuthEnabled&&(a.jwtInBody="true"),encodeURI(c.utils.setSearchParams(s,a))},e.prototype.buildSpeechRequestUrl=function(){var e=this;return new i.default((function(t,n){e.isClientAuthEnabled?e.authTokenService.getToken().then((function(n){e.serverConfig.channelId=n.getClaim("channelId"),e.serverConfig.userId=n.getClaim("userId"),t(e.setRequestUrl())})).catch((function(){n(Error("Unable to fetch JWT token. Can not use speech service."))})):t(e.setRequestUrl())}))},e.prototype.connectToWebSocket=function(e){var t=new WebSocket(e);return t.onopen=this.connectionOnOpen.bind(this),t.onclose=this.connectionOnClose.bind(this),t.onmessage=this.connectionOnMessage.bind(this),t.onerror=this.connectionOnError.bind(this),t},e.prototype.connectionOnOpen=function(){var e=this;this.authTokenService?this.authTokenService.getToken().then((function(t){e.connection.send("Bearer "+t.token),e.setConnectionStatus(s.CONNECTION_STATE.OPEN),e.dumpVoiceBuffer()})):(this.setConnectionStatus(s.CONNECTION_STATE.OPEN),this.dumpVoiceBuffer())},e.prototype.connectionOnClose=function(e){this.setConnectionStatus(s.CONNECTION_STATE.CLOSED),this.isRecording()&&this.stopMicrophone()},e.prototype.connectionOnMessage=function(e){try{var t=JSON.parse(e.data);if(!t.event&&t.code)throw e;this.onSpeechRecognition&&this.onSpeechRecognition(t),(null==t?void 0:t.event)===o.FINAL_RESULT&&this.stopRecording()}catch(e){this.stopRecording()}},e.prototype.connectionOnError=function(e){this.connection.readyState===s.CONNECTION_STATE.OPEN&&this.connection.close()},e.prototype.connectionSendMessage=function(e){this.getConnectionStatus()!==s.CONNECTION_STATE.OPEN||this.connection.readyState!==s.CONNECTION_STATE.OPEN||this.microphoneStreamBuffer.length?this.microphoneStreamBuffer.push(e):this.connection.send(e)},e.prototype.setConnectionStatus=function(e){var t;this.connectionStatus=e,null===(t=this.onSpeechNetworkChange)||void 0===t||t.call(this,e)},e.prototype.getConnectionStatus=function(){return this.connectionStatus},e.prototype.dumpVoiceBuffer=function(){var e;if((null===(e=this.connection)||void 0===e?void 0:e.readyState)===s.CONNECTION_STATE.OPEN)for(;this.microphoneStreamBuffer.length>0;)this.connection.send(this.microphoneStreamBuffer.shift())},e.prototype.lanczosWindow=function(e,t){if(0===t)return 1;if(t>=e||t<=-e)return 0;var n=Math.PI*t;return e*Math.sin(n)*Math.sin(n/e)/(n*n)},e.prototype.downsampleBuffer=function(e,t,n){if(n===t){var o=new Int16Array(e.length);return e.forEach((function(e,t){return o[t]=(e<0?32768:32767)*e})),o.buffer}if(n>t)throw new Error("Input sample rate ("+t+" kHz) is lower than output sample rate("+n+" kHz) : Use case not handled.");var i=[];if(48e3===t)i=this.LP_48000_TO_16000_FIR;else{if(44100!==t)throw new Error(t+" kHz is not an expected input sampling frequency");i=this.LP_44100_TO_16000_FIR}var r,s,a,c=t/n;this.isFirstFrame?(r=Math.floor(e.length%c),s=e.length-r,a=0===r?Array.from(e):e.slice(0,s)):(r=Math.floor((e.length+this.filterBuffer.length-i.length)%c),s=e.length+this.filterBuffer.length-i.length-r,(a=new Float32Array(this.filterBuffer.length+s)).set(this.filterBuffer),a.set(e.slice(0,s),this.filterBuffer.length));var l=Math.floor(s/c),u=new Int16Array(l);if(48e3===t)for(var d=i.length;d<a.length;d+=c){for(var h=0,p=0;p<i.length;p++)h+=a[d-p]*i[p];var g=32767*Math.max(Math.min(h,1),-1);u[(d-i.length)/c]=g}else{var f=[];for(d=i.length;d<a.length;d++){for(h=0,p=0;p<i.length;p++)h+=a[d-p]*i[p];f[d-i.length]=h}for(var m=0;m<l;m++){var v=m*c,b=Math.floor(v)-3+1,_=Math.floor(v)+3;for(h=0,d=b;d<=_;d++)h+=(d<0?f[0]:d>=f.length?f[f.length-1]:f[d])*this.lanczosWindow(3,v-d);u[m]=32767*Math.max(Math.min(h,1),-1)}}return this.isFirstFrame?this.filterBuffer=e.slice(s-i.length-this.filterBuffer.length):this.filterBuffer=e.slice(s-i.length-(this.filterBuffer.length-i.length)),this.isFirstFrame=!1,u.buffer},e.prototype.processAudioBuffer=function(e){this._startPromise&&(this._startPromise.resolve(),this._startPromise=void 0);var t=e.inputBuffer.getChannelData(0),n=e.inputBuffer.sampleRate,o=this.downsampleBuffer(t,n,16e3);this.processAnalyser(),this.connectionSendMessage(o)},e.prototype.processAnalyser=function(){if(this.analyser){var e=new Uint8Array(this.analyser.frequencyBinCount);this.analyser.getByteFrequencyData(e),this.onAnalyserFrequencies(e)}},e.prototype.startMicrophone=function(){this.connection=this.connectToWebSocket(this.requestUrl),this.analyser=this.audioContext.createAnalyser(),this.analyser.smoothingTimeConstant=.8,this.analyser.fftSize=256,this.onAnalyserReady(this.analyser),this.processor=this.audioContext.createScriptProcessor(this.BUFF_SIZE,1,1),this.processor.onaudioprocess=this.processAudioBuffer.bind(this),this.microphoneStream.connect(this.analyser),this.analyser.connect(this.processor),this.processor.connect(this.audioContext.destination),this.started=!0},e.prototype.stopMicrophone=function(){this.started=!1,this.connection&&(this.connection.readyState===s.CONNECTION_STATE.OPEN&&this.connectionSendMessage("Done"),this.processor&&this.processor.disconnect(),this.analyser&&this.analyser.disconnect(),(0,r.getAudioInput)()?(0,r.stopAudioInput)():this.cleanupWeb(),this.processor=null,this.analyser=null,this.audioContext=null,this.microphoneStreamBuffer=[],this.filterBuffer=[],this.isFirstFrame=!0)},e.prototype.cleanupWeb=function(){this.microphoneStream&&(this.microphoneStream&&this.microphoneStream.mediaStream&&this.microphoneStream.mediaStream.getAudioTracks().forEach((function(e){return e.stop()})),this.microphoneStream.disconnect(),this.microphoneStream=null),this.audioContext&&this.audioContext.close()},e.ERROR_MESSAGE={NO_SPEECH_TIMEOUT:"no_speech_timeout",TOO_MUCH_SPEECH_TIMEOUT:"too_much_speech_timeout"},e}();t.SpeechRecognitionService=d},4827:function(e,t,n){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.CoreSpeechSynthesisService=void 0;var i=n(9297),r=n(5949),s=1,a=1,c=1,l=window,u=l.addEventListener,d=l.navigator,h=clearTimeout,p=function(){function e(){var e=this;if(!l||!("speechSynthesis"in window))throw Error();this._setDefaultVoice(),u("beforeunload",(function(t){g().cancel(),h(e.pauser),delete t.returnValue})),u("click",(function(){var e=g();if(e){var t=new SpeechSynthesisUtterance;t.text="",e.cancel(),e.resume(),e.speak(t)}}),{once:!0})}return e.getInstance=function(){return this.service||(this.service=new e),this.service},e.prototype.speak=function(e){var t=this,n=this.voice,o=new SpeechSynthesisUtterance;o.voice=n,o.text=e,o.pitch=s,o.rate=a,o.volume=c;var i=g();i.paused&&i.resume(),i.speak(o),n&&!n.localService&&(h(this.pauser),v((function(e){return t.pauser=e})))},e.prototype.cancel=function(){g().cancel(),h(this.pauser)},e.prototype.getVoices=function(){return f()},e.prototype.setVoice=function(e){var t=this;return this._setDefaultVoice().then((function(){var n,i,l;(n=e,i=t.voice,l=n.map((function(e){return o({lang:"",name:""},e)})),f().then((function(e){for(var t=0,n=l;t<n.length;t++)for(var o=n[t],s=0,a=e;s<a.length;s++){var c=a[s];if((0,r.matchStringIgnoreCase)(o.lang,c.lang)&&(0,r.matchStringIgnoreCase)(o.name,c.name))return c}for(var u=0,d=l;u<d.length;u++){o=d[u];for(var h=0,p=e;h<p.length;h++){var g=p[h];if((0,r.matchStringIgnoreCase)(o.lang,g.lang))return g}}for(var f=0,m=l;f<m.length;f++){o=m[f];for(var v=0,b=e;v<b.length;v++){var _=b[v];if(_.lang.indexOf(o.lang)>=0)return _}}return i}))).then((function(e){t.voice=e,s=e.pitch||1,a=e.rate||1,c=e.volume||1}))}))},e.prototype.getVoice=function(){return this.voice},e.prototype._setDefaultVoice=function(){var e=this;return this.voice?i.default.resolve():f().then((function(e){if(d&&d.language){var t=e.filter((function(e){return e.lang===d.language}))[0];if(t)return t}var n=e.filter((function(e){return e.default}))[0];return n||e[0]})).then((function(t){e.voice=t}))},e}();function g(){return speechSynthesis}function f(){return new i.default((function(e){m(e);var t=g().addEventListener;t&&t("voiceschanged",(function(){m(e)}))}))}function m(e){var t=g().getVoices();t.length&&e(function(e){return Array.isArray(e)?e:e._list}(t))}function v(e){var t=l.setTimeout((function(){var t=g();t.speaking&&(t.pause(),t.resume(),v(e))}),1e4);e(t)}t.CoreSpeechSynthesisService=p},3792:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isTTS=void 0;var o=n(5949);t.isTTS=function(e){return e&&(0,o.isFunction)(e.speak)&&(0,o.isFunction)(e.cancel)&&(0,o.isFunction)(e.getVoice)&&(0,o.isFunction)(e.getVoices)&&(0,o.isFunction)(e.setVoice)}},7234:function(e,t,n){"use strict";var o=this&&this.__rest||function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]])}return n};Object.defineProperty(t,"__esModule",{value:!0}),t.ReconnectingWebSocket=void 0;var i=n(9297),r=n(7632),s=n(4534),a=n(4428),c=n(5949),l=n(8798),u=n(6831),d=n(7525),h=function(){function e(e,t,n,o,i,s,a,u,d){this._url=e,this._authTokenService=t,this._reconnectInterval=n,this._reconnectMaxAttempts=o,this._reconnectTimeout=i,this._configLongPolling=s,this._upgradeToWebSocketInterval=a,this._pollingUrl=u,this._protocols=d,this._readyState=r.CONNECTION_STATE.CLOSED,this._forcedClose=!1,this._onlyTokenSent=!1,this._reconnectAttempt=0,this._isLongPollingEnabled=!1,this._webSocketUpgradeInterval=300,this._logger=new l.Logger("ReconnectingWebSocket"),this.onclose=function(e){},this.onerror=function(e){},this.onmessage=function(e){},this.onopen=function(e){},this.onconnecting=function(){},this.onstatuschange=function(e){},this._logger.debug("WebSocket creation",this._url,"reconnectInterval: "+this._reconnectInterval,"reconnectMaxAttempts: "+this._reconnectMaxAttempts,"reconnectTimeout: "+this._reconnectTimeout),this._configLongPolling&&(this._reconnectInterval=2,this._reconnectMaxAttempts=3),this._reconnectInterval=c.utils.secToMillisec(n),this._reconnectTimeout=c.utils.secToMillisec(i),this._webSocketUpgradeInterval=c.utils.secToMillisec(this._upgradeToWebSocketInterval)}return Object.defineProperty(e.prototype,"url",{get:function(){return this._url},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"protocol",{get:function(){return this._ws.protocol},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bufferedAmount",{get:function(){return this._ws.bufferedAmount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"extensions",{get:function(){return this._ws.extensions},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"readyState",{get:function(){return this._readyState},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"CLOSED",{get:function(){return r.CONNECTION_STATE.CLOSED},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"CLOSING",{get:function(){return r.CONNECTION_STATE.CLOSING},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"CONNECTING",{get:function(){return r.CONNECTION_STATE.CONNECTING},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"OPEN",{get:function(){return r.CONNECTION_STATE.OPEN},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"binaryType",{get:function(){return this._ws.binaryType},set:function(e){this._ws.binaryType=e},enumerable:!1,configurable:!0}),e.prototype.open=function(){navigator.onLine?this._connect():this._setReadyState(r.CONNECTION_STATE.CLOSED)},e.prototype.close=function(e,t){var n;void 0===e&&(e=1e3),void 0===t&&(t=""),this._forcedClose=!0,(null===(n=this._ws)||void 0===n?void 0:n.readyState)!==r.CONNECTION_STATE.CLOSED?(this._setReadyState(r.CONNECTION_STATE.CLOSING),this._ws.close(e,t)):this._isLongPollingEnabled&&(this._setReadyState(r.CONNECTION_STATE.CLOSING),this._isLongPollingEnabled=!1,clearInterval(this._upgradeWebSocketTimer),this._setReadyState(r.CONNECTION_STATE.CLOSED))},e.prototype.send=function(e){e.isRead,e.date;var t,n=o(e,["isRead","date"]),i=!1;if((null===(t=this._ws)||void 0===t?void 0:t.readyState)===r.CONNECTION_STATE.OPEN){this._onlyTokenSent=!1;try{this._ws.send(JSON.stringify(n)),i=!0}catch(e){i=!1}}else this._isLongPollingEnabled?i=this._longPollSendMessage(n):this._logger.error("Connection closed, can not send message.");return i},e.prototype.addEventListener=function(e,t,n){this._ws&&this._ws.addEventListener(e,t,n)},e.prototype.dispatchEvent=function(e){return!!this._ws&&this._ws.dispatchEvent(e)},e.prototype.removeEventListener=function(e,t,n){this._ws&&this._ws.removeEventListener(e,t,n)},e.prototype._connect=function(){var e,t,n=this;if(window.WebSocket){if(this._logger.debug("Initiating connection to server",this._url),this._isLongPollingEnabled||this._setReadyState(r.CONNECTION_STATE.CONNECTING),!this._ws||this._ws.readyState===r.CONNECTION_STATE.CLOSED){this._ws=new WebSocket(this._url,this._protocols),this._ws.onmessage=function(e){n._logger.debug("WebSocket onmessage",n._url,e.data);try{var t=JSON.parse(e.data);if((0,d.isPongMessage)(t))return void(n.lastPongReceived=!0);n.onmessage(e.data)}catch(t){console.error("Error in parsing message ",e.data)}},this._ws.onerror=function(e){n._logger.debug("WebSocket onerror",n._url,e),n.onerror(e)};var o=function(o){t=n._startPingPong(),clearTimeout(e),clearInterval(n._upgradeWebSocketTimer),e=null,n._reconnectAttempt=0,n._isLongPollingEnabled=!1,n._forcedClose=!1,n._setReadyState(r.CONNECTION_STATE.OPEN),n.onopen(o)};this._ws.onopen=function(e){n._logger.debug("WebSocket opened",n._url),n._authTokenService?(n._onlyTokenSent=!0,n._authTokenService.getToken().then((function(t){n._ws.send(JSON.stringify((0,d.buildAuthTokenMessage)(u.TOKEN_TYPE.JWT,t.token))),setTimeout((function(){return n._onlyTokenSent=!1}),2e4),o(e)}))):o(e)},this._ws.onclose=function(o){clearInterval(t),n._forcedClose?(clearTimeout(e),n._setReadyState(r.CONNECTION_STATE.CLOSED),n.onclose(o)):n._authTokenService&&n._onlyTokenSent&&o.code!==s.Constants.WEBSOCKET_CLOSE_EVENT.CODE.ABNORMAL_CLOSURE?(n._logger.error("Token authentication failed, connection closed."),n._setReadyState(r.CONNECTION_STATE.CLOSED),n.onclose(o)):e=setTimeout((function(){n._reconnectAttempt>=n._reconnectMaxAttempts?n._configLongPolling?n._longPollInit():(n._logger.debug("Reconnection attempts limit reached"),n._setReadyState(r.CONNECTION_STATE.CLOSED),n.onclose(o)):n._ws&&n._ws.readyState===r.CONNECTION_STATE.CLOSED&&(n._reconnectAttempt++,n._logger.debug("Reconnection attempt",n._reconnectAttempt),n._connect())}),n._reconnectInterval)}}}else this._configLongPolling?this._longPollInit():(this._setReadyState(r.CONNECTION_STATE.CLOSED),this.onclose(new CloseEvent("WebSocket unavailable",{code:3e3,reason:"WebSocket is disabled or unavailable on this client. Can not connect to chat server."})))},e.prototype._longPollInit=function(){var e=this;this._isLongPollingEnabled||(this._setReadyState(r.CONNECTION_STATE.CONNECTING),this._longPollConnect().then((function(){e._setReadyState(r.CONNECTION_STATE.OPEN),e.onopen(null),e._isLongPollingEnabled=!0,e._upgradeWebSocketTimer=e._startUpgradeToWebSocketTimer(),e._longPollServerPolling()})).catch((function(){e._isLongPollingEnabled=!1,e._setReadyState(r.CONNECTION_STATE.CLOSED),e.onclose(null)})))},e.prototype._longPollConnect=function(){var e=this;return new i.default((function(t,n){var o=new XMLHttpRequest;o.open("POST",e._pollingUrl),o.setRequestHeader("Content-Type","application/json"),o.onload=function(){(null==o?void 0:o.status)>=200&&(null==o?void 0:o.status)<300?t():n()},e._authTokenService?e._authTokenService.getToken().then((function(e){o.setRequestHeader("Authorization","Bearer "+e.token),o.send(JSON.stringify((0,d.buildPingMessage)()))})).catch((function(){e._logger.error("Can not connect to server, token invalid."),n()})):o.send(JSON.stringify((0,d.buildPingMessage)()))}))},e.prototype._longPollServerPolling=function(){var e=this;if(this._isLongPollingEnabled){var t=new XMLHttpRequest;t.open("GET",this._pollingUrl),t.onload=function(){t.status&&t.status===a.Response.STATUS.OK&&e._longPollOnMessage(t.responseText),e._longPollServerPolling()},this._authTokenService?this._authTokenService.getToken().then((function(e){t.setRequestHeader("Authorization","Bearer "+e.token),t.send()})).catch((function(t){e._logger.error("Can not connect to server, token invalid.")})):t.send()}else this._ws||(this._setReadyState(r.CONNECTION_STATE.CLOSED),this.onclose(null))},e.prototype._longPollSendMessage=function(e){var t=this,n=new XMLHttpRequest;return n.open("POST",this._pollingUrl),n.setRequestHeader("Content-Type","application/json"),this._authTokenService?this._authTokenService.getToken().then((function(t){n.setRequestHeader("Authorization","Bearer "+t.token),n.send(JSON.stringify(e))})).catch((function(e){t._logger.error("Can not send message, token invalid.")})):n.send(JSON.stringify(e)),!0},e.prototype._longPollOnMessage=function(e){var t=this;try{JSON.parse(e).forEach((function(e){t.onmessage(e)}))}catch(t){this._logger.error("Unable to parse response",e)}},e.prototype._setReadyState=function(e){this._readyState=e,this.triggerNewConnection&&e===r.CONNECTION_STATE.CLOSED?(this.triggerNewConnection=!1,this.open()):this.onstatuschange(e)},e.prototype._startPingPong=function(){var e=this;return this.triggerNewConnection=!1,window.setInterval((function(){var t;(null===(t=e._ws)||void 0===t?void 0:t.readyState)===r.CONNECTION_STATE.OPEN&&(e.lastPongReceived=!1,e._ws.send(JSON.stringify((0,d.buildPingMessage)())),setTimeout((function(){e.readyState!==r.CONNECTION_STATE.OPEN||e.lastPongReceived||(e.close(),e.triggerNewConnection=!0)}),d.PONG_DELIVERY_CONFIRMATION_INTERVAL))}),d.PING_PONG_INTERVAL)},e.prototype._startUpgradeToWebSocketTimer=function(){var e=this;return window.setInterval((function(){e._reconnectAttempt=0,e._connect()}),this._webSocketUpgradeInterval)},e}();t.ReconnectingWebSocket=h},9158:function(e,t,n){var o=n(6432);o&&o.__esModule&&(o=o.default),e.exports="string"==typeof o?o:o.toString()},5192:function(e,t,n){var o=n(909);o&&o.__esModule&&(o=o.default),e.exports="string"==typeof o?o:o.toString()},6097:function(e,t,n){var o=n(5464);o&&o.__esModule&&(o=o.default),e.exports="string"==typeof o?o:o.toString()},2146:function(e,t,n){var o=n(9192);o&&o.__esModule&&(o=o.default),e.exports="string"==typeof o?o:o.toString()},6819:function(e,t,n){var o=n(4068);o&&o.__esModule&&(o=o.default),e.exports="string"==typeof o?o:o.toString()},9238:function(e,t,n){var o=n(5311);o&&o.__esModule&&(o=o.default),e.exports="string"==typeof o?o:o.toString()},8167:function(e,t,n){var o=n(773);o&&o.__esModule&&(o=o.default),e.exports="string"==typeof o?o:o.toString()},120:function(e,t,n){var o=n(8371);o&&o.__esModule&&(o=o.default),e.exports="string"==typeof o?o:o.toString()},4121:function(e,t,n){var o=n(8566);o&&o.__esModule&&(o=o.default),e.exports="string"==typeof o?o:o.toString()},4243:function(e,t,n){var o=n(8274);o&&o.__esModule&&(o=o.default),e.exports="string"==typeof o?o:o.toString()},8114:function(e,t,n){var o=n(9244);o&&o.__esModule&&(o=o.default),e.exports="string"==typeof o?o:o.toString()},1920:function(e,t,n){var o=n(7519);o&&o.__esModule&&(o=o.default),e.exports="string"==typeof o?o:o.toString()},8826:function(e,t,n){var o=n(5380);o&&o.__esModule&&(o=o.default),e.exports="string"==typeof o?o:o.toString()},5109:function(e,t,n){var o=n(6069);o&&o.__esModule&&(o=o.default),e.exports="string"==typeof o?o:o.toString()}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var r=t[o]={id:o,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.exports}n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};return function(){"use strict";var e=o;n(9594),n(6400),n(8952);var t=n(9297),i=n(7927),r=n(7496),s=n(7632),a=n(8674),c=n(5949),l=n(8656),u=n(7214),d=n(8798),h=n(1001),p=n(6693),g=n(330),f=n(2257),m=n(9757),v=n(1793),b=n(4827),_=n(3792),y=n(4534),T=n(3729),C=n(1489).getPrefixCSSClass;function S(e,n){var o,S,A,O,I,M,k,P=this,L=!1,N=new d.Logger("main"),D=(0,c.getValues)(h.SPEECH_LOCALE),B=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];1===t.length?N.error("Parameter "+t+" was not passed for "+e+" call. No action processed."):N.error("Parameters "+t.join(", ")+" were not passed for "+e+" call. No action processed.")},R=function(e){M.trigger(r.ChatEvent.MESSAGE_SENT,e),M.trigger(r.ChatEvent.MESSAGE,e)},F=function(e){M.trigger(r.ChatEvent.MESSAGE_RECEIVED,e),M.trigger(r.ChatEvent.MESSAGE,e)},V=function(e){M.trigger(r.ChatEvent.NETWORK,e)},H=function(e){if(o=new u.WidgetComponent(S,P.openChat.bind(P),P.closeChat.bind(P),Y.bind(P),F.bind(P),R.bind(P),P.getUnreadMessagesCount.bind(P),V.bind(P),A,O,k,M),e)try{o.embedInElement(S.targetElement)}catch(e){N.error("Target Element not specified",e)}else o.appendToElement(document.body)},U=function(){M.trigger(r.ChatEvent.READY),U=function(){}},z=function(e,t,n){"string"==typeof e&&e.length&&A.setSettingsProperty("URI",e),"string"==typeof t&&t.length&&A.setSettingsProperty("channelId",t),"string"==typeof n&&n.length&&A.setSettingsProperty("userId",n)};this.connect=function(e){var n=void 0===e?{}:e,o=n.URI,i=n.channelId,a=n.userId;if(S.clientAuthEnabled&&k.resetToken(),P.isConnected()){if(function(e,t,n){var o=!1;return(e&&e!==S.URI||t&&t!==S.channelId||n&&n!==S.userId)&&(o=!0),o}(o,i,a)){var c=S.URI!==o;return z(o,i,a),!S.clientAuthEnabled||c?new t.default((function(e,t){var n=!0,o=function(i){i===s.CONNECTION_STATE.CLOSED&&n&&(P.off(r.ChatEvent.NETWORK,o),A.openConnection().then(e,t),n=!1)};A.closeConnection(),P.on(r.ChatEvent.NETWORK,o)})):t.default.resolve()}return t.default.resolve()}z(o,i,a);var l=A.openConnection();return l.then((function(){U()})).catch((function(){U()})),l},this.disconnect=function(e,n){return new t.default((function(t){var i=!0,a=function(e){e===s.CONNECTION_STATE.CLOSED&&i&&(P.off(r.ChatEvent.NETWORK,a),i=!1,t())};P.on(r.ChatEvent.NETWORK,a),A.closeConnection(e,n),o.cancelSpeechSynthesis(),S.enableSpeech&&P.stopVoiceRecording(),S.enableAttachment&&A.cancelUploadAttachments(),A.isConnectionClosed()&&i&&(i=!1,t())}))},this.isConnected=function(){return A.isConnectionOpen()},this.openChat=function(){o.isOpen||(o.showChat(),L&&(P.connect(),L=!1)),M.trigger(r.ChatEvent.WIDGET_OPENED)},this.closeChat=function(){o.isOpen&&o.onClose(),M.trigger(r.ChatEvent.WIDGET_CLOSED)},this.endChat=function(){P.isConnected()&&o.sendExitEvent()};var Y=function(){o.isOpen&&P.closeChat(),P.disconnect(),P.clearConversationHistory(),L=!0,M.trigger(r.ChatEvent.CHAT_END)};this.isChatOpened=function(){return o.isOpen},this.destroy=function(){if(P.disconnect(),P.closeChat(),o.remove(),document){var e=document.querySelector("#".concat(y.STYLE_SHEET_ID));e&&e.remove()}for(var t in M.trigger(r.ChatEvent.DESTROY),P.off(),P)P[t]&&delete P[t]},this.on=function(e,t){M.bind(e,t)},this.off=function(e,t){M.unbind(e,t)},this.sendAttachment=function(e){if(e)return o.uploadFile(e);B("sendAttachment","file")},this.sendMessage=function(e,t){return e?o.sendMessage(e,t):(B("sendMessage","message"),!1)},this.updateUser=function(e,t){e?T.isProfileMessage&&((0,T.isMessage)(e)&&!(0,T.isValidMessage)(e,g.SENDER_TYPE.USER)&&delete e.messagePayload,A.updateUser(e,t)):B("updateUser","userDetails")},this.setTTSService=function(e){var t=S.ttsService;t&&t.cancel();var n=(0,_.isTTS)(e)?e:null;S.ttsService=n,n&&(S.enableBotAudioResponse=!0,(0,c.isAnyVoiceAvailable)(n,S.skillVoices).then((function(e){e||(S.skillVoices=[]);var t=c.utils.syncTTSLocaleIfUnavailable({hasRecognition:S.enableSpeech,hasSynthesis:S.enableBotAudioResponse,recognitionLocale:S.speechLocale,synthesisLocales:S.skillVoices});n.setVoice(t),S.skillVoices=t}))),o&&o.refreshTTS()},this.getTTSVoices=function(){return S.ttsService?S.ttsService.getVoices():x()},this.setTTSVoice=function(e){var t=S.ttsService;return t?(0,c.isAnyVoiceAvailable)(t,S.skillVoices).then((function(n){return S.skillVoices=c.utils.syncTTSLocaleIfUnavailable({hasRecognition:S.enableSpeech,hasSynthesis:S.enableBotAudioResponse,isReset:n,recognitionLocale:S.speechLocale,synthesisLocales:e}),t.setVoice(e)})):x()},this.getTTSVoice=function(){if(S.ttsService)return S.ttsService.getVoice();throw Error(E)},this.speakTTS=function(e){S.ttsService&&o.speakTTS(e)},this.cancelTTS=function(){S.ttsService&&S.ttsService.cancel()},this.setSkillVoices=function(e){if(!S.ttsService)return x();var t=[];return e&&!Array.isArray(e)&&"string"==typeof(null==e?void 0:e.lang)?t=[e]:Array.isArray(e)&&(t=e),P.setTTSVoice(t).then((function(){return P.getVoice()}))},this.startVoiceRecording=function(e,n,o){return S.enableSpeech?e?n?O.startRecording(e,n,o):t.default.reject(new Error("Second callback parameter, onSpeechNetworkChange not provided. Can not start recording")):t.default.reject(new Error("First callback parameter, onSpeechRecognition not provided. Can not start recording.")):t.default.reject(new Error("Speech-to-text feature is not enabled. Initialize the widget with enableSpeech: true to use the service."))},this.stopVoiceRecording=function(){if(!S.enableSpeech)throw new Error("Speech-to-text feature is not enabled. Speech recognition service is not running.");return O.stopRecording()},this.setSpeechLocale=function(e){if(!S.enableSpeech)return!1;e=e.toLowerCase();var t=D.indexOf(e)>=0;if(S.speechLocale=e,(null==O?void 0:O.isInitialized())&&O.setSpeechLocale(e),o.setVoiceRecognitionService(t),t&&S.enableBotAudioResponse){var n=c.utils.syncTTSLocaleIfUnavailable({hasRecognition:S.enableSpeech,hasSynthesis:S.enableBotAudioResponse,recognitionLocale:S.speechLocale,synthesisLocales:S.skillVoices});n!==S.skillVoices&&(S.skillVoices=n,o.setSkillResponseVoices(S.skillVoices))}return t},this.setPrimaryChatLanguage=function(e){if(null!==e&&"string"!=typeof e)throw Error("Please pass a language string or null as argument");P.isConnected()?o.setPrimaryChatLanguage(e):N.error("Not connected. Can not call setPrimaryChatLanguage.")},this.setDelegate=function(e){S.delegate=e},this.getConversationHistory=function(){var e=A.getMessages();return{messages:e,messagesCount:e.length,unreadCount:A.getUnreadMessagesCount(),userId:S.userId}},this.clearConversationHistory=function(e,t){void 0===t&&(t=!0),e&&"string"!=typeof e?N.error("Argument passed in clearConversationHistory() is not of type string. Returning without execution."):(e&&0!==e.length||(e=S.userId),t&&e===S.userId?o.clearConversationHistory():A.clearMessages(e,h.StorageType.LOCAL))},this.clearAllConversationsHistory=function(e){void 0===e&&(e=!0),A.clearAllMessage(),e&&o.clearConversationHistory()},this.getSuggestions=function(e){return S.enableAutocomplete?e?"string"!=typeof e&&"number"!=typeof e?t.default.reject("Invalid query parameter type passed for the getSuggestions call."):o.getSuggestions(e):t.default.reject("No query parameter passed for the getSuggestions call."):t.default.reject("Autocomplete suggestions not enabled.")},this.getUnreadMessagesCount=function(){if(S.enableHeadless)return 0;var e=A.getUnreadMessagesCount();return e!==I&&(I=e,M.trigger(r.ChatEvent.UNREAD,e)),e},this.setAllMessagesAsRead=function(){S.enableHeadless||(A.markAllAsRead(),P.getUnreadMessagesCount(),o.updateNotificationBadge(0))},this.showTypingIndicator=function(){if(!S.showTypingIndicator)throw new Error("Typing indicator is configured not to be shown.");if(S.enableHeadless)throw new Error("Typing indicator cannot be shown in headless mode.");P.isConnected()&&o.showTypingIndicator()},this.setWebViewConfig=function(e){if(S.enableHeadless)throw new Error("WebView cannot be configured in headless mode.");o.getWebViewComponent().setProps(e)},this.setUserInputMessage=function(e){if(S.enableHeadless)throw new Error("User input cannot be set in headless mode.");o.setUserInputMessage(e)},this.setUserInputPlaceholder=function(e){if(S.enableHeadless)throw new Error("Placeholder cannot be set in headless mode.");e?o.setUserInputPlaceholder(e):B("setUserInputPlaceholder","placeholder text")},this.setHeight=function(e){if(e){var t=document.getElementsByClassName(C("widget"))[0];t&&(t.style.height=e,S.height=e)}else B("setHeight","height")},this.setWidth=function(e){if(e){var t=document.getElementsByClassName(C("widget"))[0];t&&(t.style.width=e,S.width=e)}else B("setWidth","width")},this.setSize=function(e,t){if(e||t){var n=document.getElementsByClassName(C("widget"))[0];n&&(n.style.width=e,n.style.height=t,S.width=e,S.height=t)}else B("setSize","width","height")},this.setMessagePadding=function(e){if(e)for(var t=0,n=document.getElementsByClassName(C("message-bubble"));t<n.length;t++)n[t].style.padding=e,S.messagePadding=e;else B("setMessagePadding","padding")},this.setChatBubbleIconHeight=function(e){if(e)for(var t=0,n=document.getElementsByClassName(C("chat-bubble"));t<n.length;t++)n[t].style.height=e,S.height=e;else B("setChatBubbleIconHeight","height")},this.setChatBubbleIconWidth=function(e){if(e)for(var t=0,n=document.getElementsByClassName(C("chat-bubble"));t<n.length;t++)n[t].style.width=e,S.width=e;else B("setChatBubbleIconWidth","width")},this.setChatBubbleIconSize=function(e,t){if(e||!t)for(var n=0,o=document.getElementsByClassName(C("chat-bubble"));n<o.length;n++){var i=o[n];i.style.width=e,i.style.height=t,S.width=e,S.height=t}else B("setChatBubbleIconSize","width","height")};var j=".left",W=".message-",G="".concat(W,"bubble"),K=".wrapper,".concat(j," ").concat(G,",").concat(j," ").concat(W,"header,")+"".concat(j," ").concat(W,"footer, ").concat(j," .card,.right ").concat(G);if(this.setFont=function(e){e?(w("".concat(K,"{font:").concat(e,"}")),S.font=e):B("setFont","font")},this.setFontFamily=function(e){if(e){var t=".action-postback",n="".concat(K,",").concat(W,"actions ").concat(t,",")+".card-actions ".concat(t,",").concat(W,"global-actions ").concat(t);w("".concat(n,"{font-family:").concat(e,"}")),S.fontFamily=e}else B("setFontFamily","fontFamily")},this.setFontSize=function(e){e?w("".concat(K,"{font-size:").concat(e,"}")):B("setFontSize","fontSize")},this.setTextColor=function(e){e?w("".concat(K,"{color:").concat(e,"}")):B("setTextColor","color")},this.setTextColorLight=function(e){e?(w(".card-description{color:".concat(e,"}")),S.colors.textLight=e):B("setTextColor","color")},e.enableSpeech&&(window.WebSocket&&((0,i.isAudioInputAvailable)()||(0,l.isUserMediaAvailable)())?O=v.SpeechRecognitionService.getInstance():e.enableSpeech=!1),A=new m.ChatServerService(e,n,O),(S=A.getChatConfiguration()).clientAuthEnabled&&(k=f.AuthTokenService.getInstance()),M=(0,a.generateEventDispatcher)(),S.ttsService)this.setTTSService(S.ttsService);else if(S.enableBotAudioResponse)try{this.setTTSService(b.CoreSpeechSynthesisService.getInstance())}catch(e){S.enableBotAudioResponse=!1}!function(){N.debug("onLoad","load chat widget");var e=new p.StyleComponent(S);if(e.addStyle(e.setWidgetCssClasses()),"undefined"!=typeof window){var t=!1,n=document.head.children,o=e.render();o.id=y.STYLE_SHEET_ID;for(var i=0;i<n.length;i++){var r=n.item(i);if("style"===r.nodeName.toLowerCase()){document.head.insertBefore(o,r),t=!0;break}}t||document.head.appendChild(o)}H(S.embedded)}(),c.utils.setObjectReadOnly(this)}function w(e){var t=document.querySelector("#".concat(y.STYLE_SHEET_ID));if(t){var n=e.replace(/(\.)([a-zA-Z_-]+)(?=[^}]+{)/gi,"$1".concat(y.SDK_NAME,"-$2"));t.innerText=t.innerText+n}}e.default=S,S.EVENT=r.ChatEvent,S.SPEECH_LOCALE=h.SPEECH_LOCALE,S.THEME=h.IWidgetTheme,S.Version=y.SDK_VERSION,c.utils.deepFreeze(S);var E="Text-to-speech is not available.";function x(){return e=E,t.default.reject(Error(e));var e}}(),o=o.default}()},"object"==typeof exports&&"object"==typeof module?module.exports=factory():"function"==typeof define&&define.amd?define("WebSDK",[],factory):"object"==typeof exports?exports.WebSDK=factory():e.WebSDK=factory();self.WebSDK=factory();
/** CUSTOM SDK CHANGES  */

let mousedownFired=false;
var serveruri_fa="";
var channelid_fa="";
let webSDKHostName="";
let imageServerURI_fa="";
let uniqueUser="";
let bot={};
let theme_fa="";
let apiStartMsg = "";
// let logo_fa, chatTitle_fa, chatSubTitle_fa, greetings_fa, botIcon_fa, widgetIcon_fa, language_fa;
if(document.getElementById("settings")){
  serveruri_fa = document.getElementById("settings").getAttribute("serveruri");
  channelid_fa = document.getElementById("settings").getAttribute("channelid");
  theme_fa = document.getElementById("settings").getAttribute("theme");
  webSDKHostName= document.getElementById("settings").getAttribute("src");
  imageServerURI_fa=  document.getElementById("settings").getAttribute("images_uri");

  logo_fa=  document.getElementById("settings").getAttribute("logo_url");
  chatTitle_fa=  document.getElementById("settings").getAttribute("chat_title");
  chatSubTitle_fa=  document.getElementById("settings").getAttribute("chat_subtitle");
  greetings_fa=  document.getElementById("settings").getAttribute("start_message");
  botIcon_fa=  document.getElementById("settings").getAttribute("bot_icon");
  widgetIcon_fa=  document.getElementById("settings").getAttribute("widget_icon");
  language_fa=  document.getElementById("settings").getAttribute("primary_lang");

  if(webSDKHostName != null){
    webSDKHostName="https://oci-fa22bd02sdk2202-246631.cna.iad.demoservices001.oraclepdemos.com"
    console.info("Fetching JSON file from webSDKHostName==> "+ webSDKHostName);
  }
  else{
    console.error("settings attribute missing from the fusion script");
  }
}
console.info("serveruri_fa : " + serveruri_fa);
console.info("channelid_fa : " + channelid_fa);
let count = 0;
var chatWidgetWebSettings = {
  enableClearMessage: true,
  enableSpeech: true,
  enableBotAudioResponse: true,
  enableTimestamp: false,
  displayActionsAsPills:false,
  enableLocalConversationHistory: true,
  messagePadding: '11px',
  enableAutocomplete: true,
  font: "14px Arial,Verdana,Sans-Serif",
  locale: "en",
  speechLocale: "en",
  showPrevConvStatus: false,
  typingIndicatorTimeout: 60,
  displayActionsAsPills:false,
  enableSpeechAutoSend: false,
  position: {bottom: '0px', right: '20px'},
  enableDraggableButton: true,
  linkHandler: { target: '_blank'},
  multiLangChat: {
    primary: "en"
  },
  icons: {
    launch: '',
    avatarBot: '',
    avatarUser: ''
}
};
var access_token = null;
// var instanceName = null;
var user_id = null;

var instanceName = window.location.host;
instanceName = instanceName.replace('fa-' , '');
var endHostIndex = instanceName.indexOf('-saasfademo1');
if(endHostIndex < 0){
  endHostIndex = instanceName.indexOf('-demoservices010');
}
instanceName = instanceName.substring(0, endHostIndex)
// instanceName = instanceName.match(/(?<=fa-)(.*)(?=-demoservices010|-saasfademo1)/gm);
// instanceName = instanceName[0]
var Servlet_uri = "https://" + window.location.host + "/fscmRestApi/tokenrelay";

function loadImage(user_id) {
  console.log("user_id = " + user_id);
  let messagebody = {
    user_id: user_id,
    instanceName: window.location.host
  };
  var xmlhttp = new XMLHttpRequest(); // new HttpRequest instance
  xmlhttp.open(
    "POST",
    webSDKHostName+"/getImageUrl"
  );
  xmlhttp.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
  xmlhttp.onreadystatechange = function() {
    //Call a function when the state changes.
    if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {

      let apiResponse = JSON.parse(xmlhttp.responseText);
      let channelId = channelid_fa != null ? channelid_fa : apiResponse.channelId;
      let serverURI = serveruri_fa != null ? serveruri_fa : apiResponse.serverURI;
      console.log("serverURI = " + serverURI);

      instanceName = apiResponse.faenv;
      let imageServerURI= imageServerURI_fa != null ? imageServerURI_fa:apiResponse.images_serveruri;
      console.log("serverURI = " + imageServerURI);
      chatWidgetWebSettings.icons.avatarUser = apiResponse.URL;
      chatWidgetWebSettings.URI = serverURI;
      chatWidgetWebSettings.channelId = channelId;
      let theme = theme_fa !=null?theme_fa:"redwood-dark"
      chatWidgetWebSettings.theme= theme;
      chatWidgetWebSettings.icons.avatarBot = (apiResponse.bot_icon != "" && apiResponse.bot_icon !== undefined) ? apiResponse.bot_icon : imageServerURI + "image/directory/WebWidget/chat.svg";
      apiStartMsg = (apiResponse.start_message !== undefined) ? apiResponse.start_message : undefined;

      if(widgetIcon_fa != null) {
        chatWidgetWebSettings.icons.launch = widgetIcon_fa
      } else if(apiResponse.widget_icon != "" && apiResponse.widget_icon !== null && apiResponse.widget_icon !== undefined) {
        chatWidgetWebSettings.icons.launch = apiResponse.widget_icon
      }

      if(botIcon_fa != null) {
        chatWidgetWebSettings.icons.avatarBot  = botIcon_fa
      } 
      else if(apiResponse.bot_icon != "" && apiResponse.bot_icon !== null && apiResponse.bot_icon !== undefined) { 
        chatWidgetWebSettings.icons.avatarBot  = apiResponse.bot_icon
      }
      let isLanguageSet = (apiResponse.primary_lang != "" && apiResponse.primary_lang !== null && apiResponse.primary_lang !== undefined)
      let isChatTitleSet = (apiResponse.chat_title != "" && apiResponse.chat_title !== null && apiResponse.chat_title !== undefined)
      let isSubTitleSet = (apiResponse.chat_subtitle != "" && apiResponse.chat_subtitle !== null && apiResponse.chat_subtitle !== undefined)
      let isPlaceHolderSet = (apiResponse.inputPlaceholder != "" && apiResponse.inputPlaceholder !== null && apiResponse.inputPlaceholder !== undefined)
      let language = '';

      if(language_fa != null && language_fa.toLowerCase() === 'fr') {
        chatWidgetWebSettings.multiLangChat.primary = language_fa
        chatWidgetWebSettings.locale = language_fa
        chatWidgetWebSettings.speechLocale = language_fa
      } else if(isLanguageSet){
        language = apiResponse.primary_lang;
        chatWidgetWebSettings.multiLangChat.primary = apiResponse.primary_lang
        chatWidgetWebSettings.locale = apiResponse.primary_lang
        chatWidgetWebSettings.speechLocale = apiResponse.primary_lang
      }

      if(isChatTitleSet || isSubTitleSet || isPlaceHolderSet){
        chatWidgetWebSettings["i18n"] = {}
        let langTemp = chatWidgetWebSettings.multiLangChat.primary
          chatWidgetWebSettings["i18n"][langTemp] = {}
          if(isChatTitleSet){
            chatWidgetWebSettings["i18n"][langTemp]["chatTitle"] = apiResponse.chat_title
            }
            if(isSubTitleSet){
              chatWidgetWebSettings["i18n"][langTemp]["chatSubtitle"] = apiResponse.chat_subtitle
            }
            if(isPlaceHolderSet){
              chatWidgetWebSettings["i18n"][langTemp]["inputPlaceholder"] = apiResponse.inputPlaceholder
            }
      }



      if(logo_fa != null){
        chatWidgetWebSettings.logoIcon = logo_fa
      } else if(apiResponse.logo_url && apiResponse.logo_url !== null && apiResponse.logo_url !== undefined){
        chatWidgetWebSettings.logoIcon = apiResponse.logo_url
      }

      if(apiResponse.enableAutocomplete && apiResponse.enableAutocomplete !== null && apiResponse.enableAutocomplete !== undefined){
        chatWidgetWebSettings.enableAutocomplete = (apiResponse.enableAutocomplete.toLowerCase() === "true")
      }

      setTimeout(timeout);
    } else if (xmlhttp.readyState == 4 && xmlhttp.status != 200) {
      let channelId =
        channelid_fa != null
          ? channelid_fa
          : "";
      let serverURI =
        serveruri_fa != null
          ? serveruri_fa
          : "";
      chatWidgetWebSettings.icons.avatarBot =
        imageServerURI+"image/directory/HCM/Users/nouser.jpg";
      chatWidgetWebSettings.URI = serverURI;
      chatWidgetWebSettings.channelId = channelId;
      setTimeout(timeout);
    }
  };
  xmlhttp.send(JSON.stringify(messagebody));
}
/**
 * Returns if the given user is new
 * If a new userID is passed, it is stored in localStorage, and function returns true
 * For userID which already exists, the function returns false
 * The function can be modified according to the requirements
 */
const isNewUser = userId => {
  const key = "users";
  let currentUsers = window.localStorage.getItem(key); // users for current session are stored under 'users' key
  if (currentUsers) {
    currentUsers = currentUsers.split(","); // convert string to array
  } else {
    currentUsers = [];
  }
  if (currentUsers.indexOf(userId) >= 0) {
    return false;
  } else {
    currentUsers.push(userId);
    window.localStorage.setItem("users", currentUsers.toString());
    return true;
  }
};
let timeout = () => {
  let Bots;
  let isConnected = false;
  var showTypingIndicatorPendingTimeouts = [];
  var delegate = {
    beforeDisplay: function(message) {
      //Customisation for showing a typing indicator - usefull if further processing will might take a while
      //clear pending typing indicator timeouts:
      showTypingIndicatorPendingTimeouts.forEach(x => clearTimeout(x));
      showTypingIndicatorPendingTimeouts = [];
      //upon receiving showTypingIndicator: true add new typing indicator
      if (message.messagePayload && message.messagePayload.channelExtensions && message.messagePayload.channelExtensions.showTypingIndicator && message.messagePayload.channelExtensions.showTypingIndicator != 'False'){
        //Add Bots.showTypingIndicator to event queue and add reference to the timeout to showTypingIndicatorPendingTimeouts so it can be cancelled if needed
        showTypingIndicatorPendingTimeouts.push(setTimeout(Bots.showTypingIndicator, 0));
      }

      //Customisations to show uiComponents
      if (message.messagePayload && message.messagePayload.channelExtensions && message.messagePayload.channelExtensions.uiComponent){
        const uiComponent = message.messagePayload.channelExtensions.uiComponent;
        //upon receiving uiComponent: calendar add a calendar
        if (uiComponent.type == 'calendar'){
          var min = '';
          var max = '';
          var date = ` value=${new Date().toISOString().split('T')[0]}`;
          var variable = '';
          if (uiComponent.properties){
            const properties = uiComponent.properties;
            min = properties.minDate ? ` min="${properties.minDate}"` : '';
            max = properties.maxDate ? ` max="${properties.maxDate}"` : '';
            //date = ` value=${Math.max.apply([min, date])}`;
            variable = properties.variable;
          }
          message.messagePayload.text = `${message.messagePayload.text||''}<div id=\"dateDiv\">
            <input id=\"selectedDate\" name=\"selectedDate\" type=\"date\"${date}${min}${max} style=\"height: 27px;margin-top: 10px;\"><br>
            <div dir="auto" class="oda-chat-message-actions"><button dir="auto" type="button" title="Submit" class="oda-chat-action-postback" onclick=\"this.disabled = true; var selectedDate = document.querySelectorAll('[id=\\'selectedDate\\']'); Bots.sendMessage({ 'messagePayload' :{ 'postback': { 'variables': { ${variable}: selectedDate[selectedDate.length-1].value }, 'action': 'submitDate' }, 'text': 'Submit My Date', 'type': 'postback' }}, {hidden: true });var selectedDate = document.getElementById('selectedDate'); selectedDate.disabled = true;\"><div dir="auto">Submit</div></button></div>
          </div>`;
        }
      }

      //Customisation for allowing postbacks on url type actions:
      //Note: We've contiously chosen to process the actions and variables as channelExtensions rather than the action-equivalents which are used
      //      by default. This because we want the default behavior (in case this customisation isn't there) to remain the same.
      //Part 1: This delegate changes url actions to postbacks, url will temporarily be stored in _url variable
      if (message.messagePayload && message.messagePayload.actions){
          message.messagePayload.actions = message.messagePayload.actions.map(action => {
              if (action.type == "url" && action.channelExtensions && action.channelExtensions.payload){
                  action.type="postback";
                  action.postback=action.channelExtensions.payload;
                  action.postback.variables=action.postback.variables||{};
                  action.postback.variables._url=action.url;
                  delete action.url;
              }
              return action;
          });
      }

      //Return the message (in it's new form)
      return message;
  },
  beforePostbackSend: function(message){
    //Customisation for allowing postbacks on url type actions:
    //Note: The opening of the link may be different than the settings you have for other links. You should customise this to your liking.
    //Part 2: delegate to open url and remove it from _url postback variable
    if (message.messagePayload && message.messagePayload.postback && message.messagePayload.postback.variables && message.messagePayload.postback.variables._url){
        setTimeout((url)=>{window.open(url)}, 2000, message.messagePayload.postback.variables._url); //2 second delay for better user-experience
        delete message.messagePayload.postback.variables._url;
    }
    return message;
  }
  }
  chatWidgetWebSettings["delegate"] = delegate;
  console.info(
    "chatWidgetWebSettings==>" + JSON.stringify(chatWidgetWebSettings)
  );

  Bots = new WebSDK(chatWidgetWebSettings); // Initiate library with configuration
  Bots.connect().then(() => {
      console.info("After Connection, Bots.updateUser");
      // greetings_fa is conventional js settings
      // apiStartMsg comes from profile options
      document
        .getElementsByClassName("oda-chat-button-clear")[0]
        .addEventListener(
          "click",
          e => {
            // Bots.sendMessage("exit", { hidden: true });
            if(greetings_fa != '' && greetings_fa !== null && greetings_fa !== undefined){ 
              // console.log('1st',greetings_fa);
              Bots.sendMessage("exit", { hidden: true });
              Bots.sendMessage(greetings_fa, { hidden: true });
            }
            else if(apiStartMsg != '' && apiStartMsg !== undefined){ 
              // console.log('2st',apiStartMsg);
              Bots.sendMessage("exit", { hidden: true });
              Bots.sendMessage(apiStartMsg, { hidden: true });
            } else if((greetings_fa === null || greetings_fa === undefined) && apiStartMsg === undefined) {
              Bots.sendMessage("exit", { hidden: true });
              Bots.sendMessage("ask Greeting Hi", { hidden: true });
            }
          },
          true
        );
       
      // Only need to send 'Hi' if a new user
      if (isNewUser(user_id)) {
        if (Bots.isChatOpened()) {
          // If the widget is already opened by the time connection is made
          // send Hi immediately
          if(greetings_fa != '' && greetings_fa !== null && greetings_fa !== undefined)
              Bots.sendMessage(greetings_fa, { hidden: true });
          else if(apiStartMsg != '' && apiStartMsg !== undefined)
              Bots.sendMessage(apiStartMsg, { hidden: true });
          else if((greetings_fa === null || greetings_fa === undefined) && apiStartMsg === undefined)
              Bots.sendMessage("ask Greeting Hi", {hidden: true});
            

        } else {
          // If widget is closed, add a listener for when the widget is opened
          
          Bots.on("widget:opened", () => {
            console.info("Widget is opened!");
            Bots.off();
            if(greetings_fa != '' && greetings_fa !== null && greetings_fa !== undefined)
              Bots.sendMessage(greetings_fa, { hidden: true });
            else if(apiStartMsg != '' && apiStartMsg !== undefined)
                Bots.sendMessage(apiStartMsg, { hidden: true });
            else if((greetings_fa === null || greetings_fa === undefined) && apiStartMsg === undefined)
               Bots.sendMessage("ask Greeting Hi", {hidden: true});

            
              
          });
        }
      }
    })
    .catch(reason => {
      console.error("Connection failed");
      console.error(reason);
    });
  // Create global object to refer Bots
  window["Bots"] = Bots;
};

function initSdk(name) {
  var head = document.getElementsByTagName('HEAD')[0];  
  var link = document.createElement('link'); 
  // set the attributes for link element  (adding css)
  link.rel = 'stylesheet';  
  link.type = 'text/css'; 
  link.href = webSDKHostName+'/css/redwood.css';
  head.appendChild(link);  
  // Default name is Bots
   if (
    !window.location.href.includes("hcmUI/CandidateExperience")
  ) {
    var xhttp_cookie = new XMLHttpRequest();
    let cookieServlet_uri = "https://" + window.location.host + "/fscmRestApi/anticsrf";
    xhttp_cookie.open("GET", cookieServlet_uri, true);
    xhttp_cookie.setRequestHeader("Content-type", "application/json");
    xhttp_cookie.onreadystatechange = function () {
      if (xhttp_cookie.readyState === 4 && xhttp_cookie.status === 200) {
        let xsrfVal=JSON.parse(xhttp_cookie.responseText).xsrftoken;
        var xhttp = new XMLHttpRequest();
        xhttp.open("GET", Servlet_uri, true);
        xhttp.setRequestHeader("Content-type", "application/json");
        xhttp.setRequestHeader("X-XSRF-TOKEN", xsrfVal);
        xhttp.onreadystatechange = function () {
          if (xhttp.readyState === 4 && xhttp.status === 200) {
            access_token = JSON.parse(xhttp.responseText).access_token;
            // console.log('Res:', JSON.parse(xhttp.responseText))
            user_id = JSON.parse(xhttp.responseText).principal;
            chatWidgetWebSettings.userId = getUniqueUserID(user_id);

            chatWidgetWebSettings.initUserProfile = {
              profile: {
                firstName: user_id,
                lastName: user_id,
                properties: {
                  accessToken: access_token,
                  principal: user_id,
                  faenv: instanceName
                },
              },
            };
            loadImage(user_id,access_token);
            //set_localstorage();
          }
        };
        xhttp.send();
    
      }
    }
    xhttp_cookie.send();
  } else {
    console.info("NOT FA EMBEDDED");
    // loadImage("ROBERT.JACKMAN")
    chatWidgetWebSettings.URI = serveruri_fa;
    chatWidgetWebSettings.channelId = channelid_fa;
    setTimeout(timeout);
  }

// setTimeout(() => {
//   var name = 'Bots'

  
// },0)
}
function getUniqueUserID(user_id){
  var retrievedObject = localStorage.getItem('bot');
        if (retrievedObject === null) {
          var startDate = new Date();
          uniqueUser =
            user_id +
            Math.random()
              .toString(36)
              .substr(2, 9);
          bot["botuser"] = uniqueUser;
          bot["time"] = startDate;
          //Put the object into storage
          localStorage.setItem("bot", JSON.stringify(bot));
          return uniqueUser;
        } else {
          var retreivedbotvalues = JSON.parse(retrievedObject);
          //console.log('retrievedObject: ', JSON.parse(retrievedObject));
          botuser = retreivedbotvalues["botuser"];
          var lastDate = new Date(retreivedbotvalues["time"]);
          var startDate = new Date();
          diff = (startDate.getTime() - lastDate.getTime()) / 1000;
          diff /= 60;
          //clear the local storage if the logged-in user is different or time exceeds 2 hrs
          console.log(diff);
          if (diff > 120 || botuser.indexOf(user_id)==-1) {
            var keys = Object.keys(localStorage);
            for (var i = 0; i < keys.length; i++) {
              localStorage.removeItem(keys[i]);
            }
            uniqueUser =
            user_id +
            Math.random()
              .toString(36)
              .substr(2, 9);
            var startDate = new Date();
            bot["botuser"] = uniqueUser;
            bot["time"] = startDate;
            bot["hiflag"] = false;
            //Put the object into storage
            localStorage.setItem("bot", JSON.stringify(bot));
            return uniqueUser;
          }
          return botuser;
        }
}
initSdk("Bots");
